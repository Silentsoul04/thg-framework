<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="darkcode0x00 luizcorrea">
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>How to write a check() method - thg-framework</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/darcula.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">thg-framework</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../cli/install/">Installation</a>
</li>
                                    
<li >
    <a href="../../..">Introduction</a>
</li>
                                    
<li >
    <a href="../../../community/">Community</a>
</li>
                                    
<li >
    <a href="../../../conceptual/">Conceptual</a>
</li>
                                    
<li >
    <a href="../../../cli/build/">build</a>
</li>
                                    
<li >
    <a href="../../../cli/tags/">tags</a>
</li>
                                    
<li >
    <a href="../../../LICENSE/">LICENSE</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">thg_dev <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">gettin_started</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../_Sidebar/">thg_Development_Environment</a>
</li>
            
<li >
    <a href="../Using-thg/">using_thg</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">git</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../git/Using-Git/">Using-Git</a>
</li>
            
<li >
    <a href="../../git/Git-cheatsheet/">Git_cheatsheet</a>
</li>
            
<li >
    <a href="../../git/Git-Reference-Sites/">Git-Reference-Sites</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../Reporting-a-Bug/">reporting_a_bug</a>
</li>
            
<li >
    <a href="../../contributing/Contributing-to-thg/">Get Started</a>
</li>
            
<li >
    <a href="../../../cli/templates/">templates</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Roadmaps</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">2019</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../roadmaps/2019/2019-Roadmap/">Roadmap</a>
</li>
            
<li >
    <a href="../../roadmaps/2019/2019-Roadmap-Review/">Roadmap_Review</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">contributing</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../Contributing-to-thg/">contributing_to_thg</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">thg_development</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">thg_how_to</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../How-to-get-started-with-writing-an-exploit/">How to get started with writing an exploit</a>
</li>
            
<li >
    <a href="../How-to-get-started-with-writing-an-auxiliary-module/">How to get started with writing an auxiliary module</a>
</li>
            
<li >
    <a href="../How-to-get-started-with-writing-a-post-module/">How to get started with writing a postmodule</a>
</li>
            
<li >
    <a href="../How-to-get-started-with-writing-a-Meterpreter-script/">How to get started with writing a script</a>
</li>
            
<li >
    <a href="../How-to-check-Microsoft-patch-levels-for-your-exploit/">How to check Microsoft patch levels for your exploit</a>
</li>
            
<li >
    <a href="../How-to-clean-up-files-using-XCybrerFileDropper/">How to clean up files using FileDropper</a>
</li>
            
<li >
    <a href="../How-to-deprecate-a-Metasploit-module/">How to deprecate a Metasploit module</a>
</li>
            
<li >
    <a href="../How-to-do-reporting-or-store-data-in-module-development/">How to do reporting or store data in module development</a>
</li>
            
<li >
    <a href="../How-to-log-in-Metasploit/">How to log in THG</a>
</li>
            
<li >
    <a href="../How-to-obfuscate-JavaScript-in-Metasploit/">How to obfuscate JavaScript in Metasploit</a>
</li>
            
<li >
    <a href="../How-to-parse-an-HTTP-response/">How to parse an HTTP response</a>
</li>
            
<li >
    <a href="../How-to-Send-an-HTTP-Request-Using-HTTPClient/">How to Send an HTTP Request Using HTTPClient</a>
</li>
            
<li >
    <a href="../How-to-send-an-HTTP-request-using-Rex-Proto-Http-Client/">How to send an HTTP request using Rex Proto Http Client</a>
</li>
            
<li >
    <a href="../How-to-use-command-stagers/">How to use command stagers</a>
</li>
            
<li >
    <a href="../How-to-use-datastore-options/">How to use datastore options</a>
</li>
            
<li >
    <a href="../How-to-use-Msf-Auxiliary-AuthBrute-to-write-a-bruteforcer/">How to use Msf Auxiliary AuthBrute to write a bruteforcer</a>
</li>
            
<li >
    <a href="../How-to-use-PhpEXE-to-exploit-an-arbitrary-file-upload-bug/">How to use PhpEXE to exploit an arbitrary file upload bug</a>
</li>
            
<li >
    <a href="../How-to-use-Powershell-in-an-exploit/">How to use Powershell in an exploit</a>
</li>
            
<li >
    <a href="../How-to-use-Railgun-for-Windows-post-exploitation/">How to use Railgun for Windows post exploitation</a>
</li>
            
<li >
    <a href="../How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit/">How to Use the FILEFORMAT mixin to create a file format exploit</a>
</li>
            
<li >
    <a href="../How-to-use-the-Msf-Exploit-Remote-Tcp-mixin/">How to use the Msf Exploit Remote Tcp mixin</a>
</li>
            
<li >
    <a href="../How-to-use-the-Seh-mixin-to-exploit-an-exception-handler/">How to use the Seh mixin to exploit an exception handler</a>
</li>
            
<li >
    <a href="../How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows/">How to use WbemExec for a write privilege attack on Windows</a>
</li>
            
<li >
    <a href="../How-to-write-a-browser-exploit-using-BrowserExploitServer/">How to write a browser exploit using BrowserExploitServer</a>
</li>
            
<li >
    <a href="../How-to-write-a-browser-exploit-using-HttpServer/">How to write a browser exploit using HttpServer</a>
</li>
            
<li class="active">
    <a href="./">How to write a check() method</a>
</li>
            
<li >
    <a href="../How-to-write-a-HTTP-LoginScanner-Module/">How to write a HTTP LoginScanner Module</a>
</li>
            
<li >
    <a href="../How-to-write-a-module-using-HttpServer-and-HttpClient/">How to write a module using HttpServer and HttpClient</a>
</li>
            
<li >
    <a href="../How-to-zip-files-with-Rex-Zip-Archive.md">How to zip files with Rex Zip Archive</a>
</li>
            
<li >
    <a href="../How-to-use-Metasploit-Framework-Obfuscation-CRandomizer/">How to use Metasploit Framework Compiler Windows to compile C code</a>
</li>
            
<li >
    <a href="../How to use Metasploit Framework Obfuscation CRandomizer">How to use Metasploit Framework Obfuscation CRandomizer</a>
</li>
            
<li >
    <a href="../How-to-decrypt-RC4-with-Metasploit-Framework-Compiler/">How to decrypt RC4 with Metasploit Framework Compiler</a>
</li>
            
<li >
    <a href="../How-to-decode-Base64-with-thg-Framework-Compiler.md">How to decode Base64 with tgh Framework Compiler</a>
</li>
            
<li >
    <a href="../How-to-XOR-with-thg-Framework-Compiler.md">How to XOR with thg Framework Compiler</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../Style_Tips/">Style_Tips</a>
</li>
            
<li >
    <a href="../Running-Private-Modules/">Running Private Modules</a>
</li>
            
<li >
    <a href="../Exploit-Ranking/">Exploit Ranking</a>
</li>
            
<li >
    <a href="../THG-module-reference-identifiers/">THG module reference identifiers</a>
</li>
            
<li >
    <a href="../Using-ReflectiveDll-Injection.md">Using ReflectiveDll Injection</a>
</li>
            
<li >
    <a href="../Oracle-Usage.md">Oracle Usage</a>
</li>
            
<li >
    <a href="../Rex-Layout.md">Rex Layout</a>
</li>
            
<li >
    <a href="../">Definition of Module Reliability, Side Effects, and Stability</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">documentation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">capture the flag</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/analysis/linux/">linux</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/analysis/windows/">windows</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/analysis/malware/">malware</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">recovery</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/recover/backuo/">backup</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/recover/patching/">patching</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">tips_end_tricks</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/tools/">tools</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/decoding/">decoding</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/dos/">dos</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/os_cheats/">os_cheats</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/snort/">snort</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/identify/basic/">basic</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/nmap/">nmap</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/nessus/">nessus</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/openvas/">openvas</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/windows/">windows</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">defend</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/prootect_defend/windows/">windows</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/prootect_defend/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/detect/tcpdump/">tcpdump</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/editcap/">edicap</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/mergecap/">mergecap</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/snort/">snort</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/tshark/">tshark</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/analysis/">analysis</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">os</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/detect/linux/">linux</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/windows/">windows</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
<li >
    <a href="../../../deployment/">Deployment</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">hash_crack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/hash_crack/">index</a>
</li>
            
<li >
    <a href="../../../capturetheflag/hash_crack/CORE_HASH_CRACKING_KNOWLEDGE/">CORE_HASH_CRACKING_KNOWLEDGE</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">pentest_standard</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../pentest_standard/preengagemente/">Pre engagement Interactions</a>
</li>
            
<li >
    <a href="../../../pentest_standard/ig/">Intelligence Gathering</a>
</li>
            
<li >
    <a href="../../../pentest_standard/threatmodeling/">Threat Modeling</a>
</li>
            
<li >
    <a href="../../../pentest_standard/vulnterability/">Vulnerability Analysis</a>
</li>
            
<li >
    <a href="../../../pentest_standard/exploration/">Exploitation</a>
</li>
            
<li >
    <a href="../../../pentest_standard/postexploration/">Post Exploitation</a>
</li>
            
<li >
    <a href="../../../pentest_standard/report/">Reporting</a>
</li>
            
<li >
    <a href="../../../pentest_standard/tecguidelines/">Technical Guidelines</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">CLI <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-1</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../tutorials/thg/">THG</a>
</li>
            
<li >
    <a href="../../../tutorials/server/server/">thg_server</a>
</li>
            
<li >
    <a href="../../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../../tutorials/shells/shells/">thg_shells</a>
</li>
            
<li >
    <a href="../../../tutorials/thg_docs/thg_docs/">thg_docs</a>
</li>
            
<li >
    <a href="../../../tutorials/auxiliares/auxiliares/">thg_auxiliares</a>
</li>
            
<li >
    <a href="../../../tutorials/anti_forensic/anti_forensic/">thg_anti_forensic</a>
</li>
            
<li >
    <a href="../../../tutorials/crypto/crypto/">thg_crypto</a>
</li>
            
<li >
    <a href="../../../tutorials/drone/drone/">thg_drone</a>
</li>
            
<li >
    <a href="../../../tutorials/keylogger/keylogger/">thg_keylogger</a>
</li>
            
<li >
    <a href="../../../tutorials/recon/recon/">thg_recon</a>
</li>
            
<li >
    <a href="../../../tutorials/voip/voip/">thg_voip</a>
</li>
            
<li >
    <a href="../../../tutorials/automation/automation/">thg_automation</a>
</li>
            
<li >
    <a href="../../../tutorials/cryptography/cryptography/">thg_cryptography</a>
</li>
            
<li >
    <a href="../../../tutorials/exploitation/exploitation/">thg_exploitation</a>
</li>
            
<li >
    <a href="../../../tutorials/malware/malware/">thg_malware</a>
</li>
            
<li >
    <a href="../../../tutorials/reversing/reversing/">thg_reversing</a>
</li>
            
<li >
    <a href="../../../tutorials/thg_windows/thg_windows/">thg_windows</a>
</li>
            
<li >
    <a href="../../../tutorials/automobile/automobile/">thg_automobile</a>
</li>
            
<li >
    <a href="../../../tutorials/database/database/">thg_database</a>
</li>
            
<li >
    <a href="../../../tutorials/fingerprint/fingerprint/">thg_fingerprint</a>
</li>
            
<li >
    <a href="../../../tutorials/misc/misc/">thg_misc</a>
</li>
            
<li >
    <a href="../../../tutorials/sniffer/sniffer/">thg_sniffer</a>
</li>
            
<li >
    <a href="../../../tutorials/wireless/wireless/">thg_wireless</a>
</li>
            
<li >
    <a href="../../../tutorials/debugger/debugger/">thg_debugger</a>
</li>
            
<li >
    <a href="../../../tutorials/firmware/firmware/">thg_firmware</a>
</li>
            
<li >
    <a href="../../../tutorials/mobile/mobile/">thg_mobile</a>
</li>
            
<li >
    <a href="../../../tutorials/social/social/">thg_social</a>
</li>
            
<li >
    <a href="../../../tutorials/backdoor/backdoor/">thg_backdoor</a>
</li>
            
<li >
    <a href="../../../tutorials/decompiler/decompiler/">thg_decompiler</a>
</li>
            
<li >
    <a href="../../../tutorials/forensic/forensic/">thg_forensic</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-2</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../tutorials/networking/networking/">thg_networking</a>
</li>
            
<li >
    <a href="../../../tutorials/spoff/spoff/">thg_spoff</a>
</li>
            
<li >
    <a href="../../../tutorials/binary/binary/">thg_binary</a>
</li>
            
<li >
    <a href="../../../tutorials/defensensive/defensensive/">thg_defensensive</a>
</li>
            
<li >
    <a href="../../../tutorials/gpu/gpu/">thg_gpu</a>
</li>
            
<li >
    <a href="../../../tutorials/os/os/">thg_os</a>
</li>
            
<li >
    <a href="../../../tutorials/nfc/nfc/">thg_nfc</a>
</li>
            
<li >
    <a href="../../../tutorials/spoof/spoof/">thg_spoof</a>
</li>
            
<li >
    <a href="../../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../../tutorials/bluetooth/bluetooth/">thg_bluetooth</a>
</li>
            
<li >
    <a href="../../../tutorials/defensive/defensive/">thg_defensive</a>
</li>
            
<li >
    <a href="../../../tutorials/hardware/hardware/">thg_hardware</a>
</li>
            
<li >
    <a href="../../../tutorials/packer/packer/">thg_packer</a>
</li>
            
<li >
    <a href="../../../tutorials/stego/stego/">thg_stego</a>
</li>
            
<li >
    <a href="../../../tutorials/code_audit/code_audit/">thg_code_audit</a>
</li>
            
<li >
    <a href="../../../tutorials/disassembler/disassembler/">thg_disassembler</a>
</li>
            
<li >
    <a href="../../../tutorials/honeypot/honeypot/">thg_honeypot</a>
</li>
            
<li >
    <a href="../../../tutorials/proxy/proxy/">thg_proxy</a>
</li>
            
<li >
    <a href="../../../tutorials/tunnel/tunnel/">thg_tunnel</a>
</li>
            
<li >
    <a href="../../../tutorials/cracker/cracker/">thg_cracker</a>
</li>
            
<li >
    <a href="../../../tutorials/dos/dos/">thg_dos</a>
</li>
            
<li >
    <a href="../../../tutorials/ids/ids/">thg_ids</a>
</li>
            
<li >
    <a href="../../../tutorials/radio/radio/">thg_radio</a>
</li>
            
<li >
    <a href="../../../tutorials/unpacker/unpacker/">thg_unpacker</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../How-to-write-a-browser-exploit-using-HttpServer/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../How-to-write-a-HTTP-LoginScanner-Module/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/darkcode357/thg-framework/edit/master/docs/dev/thg_dev/How-to-write-a-check()-method.md">Edit on darkcode357/thg-framework</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#check-method-output">Check Method Output</a></li>
        <li class="main "><a href="#check-codes">Check Codes</a></li>
        <li class="main "><a href="#remote-check-example">Remote Check Example</a></li>
            <li><a href="#local-exploit-check-example">Local Exploit Check Example</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>In Metasploit, exploits and auxiliary modules support the check command that allows the user to be able to determine the vulnerable state before using the module. This feature is handy for those who need to verify the vulnerability without actually popping a shell, and used to quickly identify all vulnerable, or possibly exploitable machines on the network.</p>
<p>Although vulnerability checks aren't the focus of Metasploit, because it isn't a vulnerability scanner like Nexpose, we do actually encourage people to implement the check() method anyway to add more value to the module. If you do write one, make sure to keep these guidelines in mind:</p>
<h2 id="check-method-output">Check Method Output</h2>
<p>Modules messages are important to the user, because they keep him/her informed about what the module is doing, and usually make the module more debuggable. However, you do also want to keep your messages in verbose mode because it becomes really noisy if the check is used against multiple targets. Ideally, you only should be using these print methods:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>vprint_line()</strong></td>
<td>verbose version of print_line</td>
</tr>
<tr>
<td><strong>vprint_status()</strong></td>
<td>verbose version of print_status that begins with "[*]"</td>
</tr>
<tr>
<td><strong>vprint_error()</strong></td>
<td>verbose version of print_error that begins with "[x]"</td>
</tr>
<tr>
<td><strong>vprint_warning()</strong></td>
<td>verbose version of print_warning that begins with "[!]", in yellow</td>
</tr>
<tr>
<td><strong>vprint_debug()</strong></td>
<td>verbose versino of print_debug that begins with "[!]", in blue</td>
</tr>
</tbody>
</table>
<p>Note: You shouldn't be printing if a target is vulnerable or not, as this is automatically handled by the framework when your method returns a check code.</p>
<h2 id="check-codes">Check Codes</h2>
<p>Once you have determined the vulnerable state, you should return a check code. Check codes are constants defined in Msf::Exploit::CheckCode, and these are the ones you can use:</p>
<table>
<thead>
<tr>
<th>Checkcode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Exploit::CheckCode::Unknown</strong></td>
<td>Used if the module fails to retrieve enough information from the target machine, such as due to a timeout.</td>
</tr>
<tr>
<td><strong>Exploit::CheckCode::Safe</strong></td>
<td>Used if the check fails to trigger the vulnerability, or even detect the service.</td>
</tr>
<tr>
<td><strong>Exploit::CheckCode::Detected</strong></td>
<td>The target is running the service in question, but the check fails to determine whether the target is vulnerable or not.</td>
</tr>
<tr>
<td><strong>Exploit::CheckCode::Appears</strong></td>
<td>This is used if the vulnerability is determined based on passive reconnaissance. For example: version, banner grabbing, or simply having the resource that's known to be vulnearble.</td>
</tr>
<tr>
<td><strong>Exploit::CheckCode::Vulnerable</strong></td>
<td>Only used if the check is able to actually take advantage of the bug, and obtain some sort of hard evidence. For example: for a command execution type bug, get a command output from the target system. For a directory traversal, read a file from the target, etc. Since this level of check is pretty aggressive in nature, you should not try to DoS the host as a way to prove the vulnerability.</td>
</tr>
<tr>
<td><strong>Exploit::CheckCode::Unsupported</strong></td>
<td>The exploit does not support the check method. If this is the case, then you don't really have to add the check method.</td>
</tr>
</tbody>
</table>
<h2 id="remote-check-example">Remote Check Example</h2>
<p>Here's an abstract example of how a Metasploit check might be written:</p>
<div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Returns a check code that indicates the vulnerable state on an app running on OS X</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">check</span>
  <span class="k">if</span> <span class="n">exec_cmd_via_http</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span> <span class="o">=~</span> <span class="sr">/uid=\d+\(.+\)/</span>
    <span class="c1"># Found the correct ID output, good indicating our command executed</span>
    <span class="k">return</span> <span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Vulnerable</span>
  <span class="k">end</span>

  <span class="n">http_body</span> <span class="o">=</span> <span class="n">get_http_body</span>
  <span class="k">if</span> <span class="n">http_body</span>
    <span class="k">if</span> <span class="n">http_body</span> <span class="o">=~</span> <span class="sr">/Something CMS v1\.0/</span>
      <span class="c1"># We are able to find the version thefore more precise about the vuln state</span>
      <span class="k">return</span> <span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Appears</span>
    <span class="k">elsif</span> <span class="n">http_body</span> <span class="o">=~</span> <span class="sr">/Something CMS/</span>
      <span class="c1"># All we can tell the vulnerable app is running, but no more info to</span>
      <span class="c1"># determine the vuln</span>
      <span class="k">return</span> <span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Detected</span>
    <span class="k">end</span>
  <span class="k">else</span>
    <span class="n">vprint_error</span><span class="p">(</span><span class="s2">&quot;Unable to determine due to a HTTP connection timeout&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Unknown</span>
  <span class="k">end</span>

  <span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Safe</span>
<span class="k">end</span>
</pre></div>

<p>Note: If you are writing an auxiliary module with the <code>Msf::Auxiliary::Scanner</code> mixin, you should declare your check method like this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_host</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
  <span class="c1"># Do your thing</span>
<span class="k">end</span>
</pre></div>

<h3 id="local-exploit-check-example">Local Exploit Check Example</h3>
<p>Most local exploit checks are done by checking the version of the vulnerable file, which is considered passive, therefore they should be flagging Exploit::CheckCode::Appears. Passive local exploit checks don't necessarily mean they are less reliable, in fact, they are not bad. But to qualify for Exploit::CheckCode::Vulnerable, your check should do the extra mile, which means either you somehow make the program return a vulnerable response, or you inspect the vulnerable code.</p>
<p>An example of making the program return a vulnerable response is ShellShock (the following is specific for VMWare):</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check</span>
  <span class="n">check_str</span> <span class="o">=</span> <span class="no">Rex</span><span class="o">::</span><span class="no">Text</span><span class="o">.</span><span class="n">rand_text_alphanumeric</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="c1"># ensure they are vulnerable to bash env variable bug</span>
  <span class="k">if</span> <span class="n">cmd_exec</span><span class="p">(</span><span class="s2">&quot;env x=&#39;() { :;}; echo </span><span class="si">#{</span><span class="n">check_str</span><span class="si">}</span><span class="s2">&#39; bash -c echo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">check_str</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
     <span class="n">cmd_exec</span><span class="p">(</span><span class="s2">&quot;file &#39;</span><span class="si">#{</span><span class="n">datastore</span><span class="o">[</span><span class="s1">&#39;VMWARE_PATH&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span> <span class="o">!~</span> <span class="sr">/cannot open/</span>

     <span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Vulnerable</span>
  <span class="k">else</span>
    <span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Safe</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>One way to inspect the vulnerable code is to come up with a signature, and see if it exists in the vulnerable process. Here's an example with adobe_sandbox_adobecollabsync.rb:</p>
<div class="highlight"><pre><span></span><span class="c1"># &#39;AdobeCollabSyncTriggerSignature&#39; =&gt; &quot;\x56\x68\xBC\x00\x00\x00\xE8\xF5\xFD\xFF\xFF&quot;</span>
<span class="c1"># &#39;AdobeCollabSyncTrigger&#39; =&gt; 0x18fa0</span>

<span class="k">def</span> <span class="nf">check_trigger</span>
  <span class="n">signature</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">railgun</span><span class="o">.</span><span class="n">memread</span><span class="p">(</span><span class="vi">@addresses</span><span class="o">[</span><span class="s1">&#39;AcroRd32.exe&#39;</span><span class="o">]</span> <span class="o">+</span> <span class="n">target</span><span class="o">[</span><span class="s1">&#39;AdobeCollabSyncTrigger&#39;</span><span class="o">]</span><span class="p">,</span> <span class="n">target</span><span class="o">[</span><span class="s1">&#39;AdobeCollabSyncTriggerSignature&#39;</span><span class="o">].</span><span class="n">length</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">signature</span> <span class="o">==</span> <span class="n">target</span><span class="o">[</span><span class="s1">&#39;AdobeCollabSyncTriggerSignature&#39;</span><span class="o">]</span>
    <span class="k">return</span> <span class="kp">true</span>
  <span class="k">end</span>

  <span class="k">return</span> <span class="kp">false</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">check</span>
  <span class="vi">@addresses</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">acrord32</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">railgun</span><span class="o">.</span><span class="n">kernel32</span><span class="o">.</span><span class="n">GetModuleHandleA</span><span class="p">(</span><span class="s2">&quot;AcroRd32.exe&quot;</span><span class="p">)</span>
  <span class="vi">@addresses</span><span class="o">[</span><span class="s1">&#39;AcroRd32.exe&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="n">acrord32</span><span class="o">[</span><span class="s2">&quot;return&quot;</span><span class="o">]</span>
  <span class="k">if</span> <span class="vi">@addresses</span><span class="o">[</span><span class="s1">&#39;AcroRd32.exe&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Unknown</span>
  <span class="k">elsif</span> <span class="n">check_trigger</span>
    <span class="k">return</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Vulnerable</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">CheckCode</span><span class="o">::</span><span class="no">Detected</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>Another possible way to inspect is grab the vulnerable file, and use Metasm. But of course, this is a lot slower and generates more network traffic.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2019 - 2020 darkcode0x00</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
