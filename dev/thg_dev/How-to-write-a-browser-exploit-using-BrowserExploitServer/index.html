<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="darkcode0x00 luizcorrea">
        <link rel="canonical" href="https://darkcode357.github.io/thg-framework/dev/thg_dev/How-to-write-a-browser-exploit-using-BrowserExploitServer/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>How to write a browser exploit using BrowserExploitServer - thg-framework</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/darcula.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">thg-framework</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../cli/install/">Installation</a>
</li>
                                    
<li >
    <a href="../../..">Introduction</a>
</li>
                                    
<li >
    <a href="../../../community/">Community</a>
</li>
                                    
<li >
    <a href="../../../conceptual/">Conceptual</a>
</li>
                                    
<li >
    <a href="../../../cli/build/">build</a>
</li>
                                    
<li >
    <a href="../../../cli/tags/">tags</a>
</li>
                                    
<li >
    <a href="../../../LICENSE/">LICENSE</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">thg_dev <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">gettin_started</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../_Sidebar/">thg_Development_Environment</a>
</li>
            
<li >
    <a href="../Using-thg/">using_thg</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">git</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../git/Using-Git/">Using-Git</a>
</li>
            
<li >
    <a href="../../git/Git-cheatsheet/">Git_cheatsheet</a>
</li>
            
<li >
    <a href="../../git/Git-Reference-Sites/">Git-Reference-Sites</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../Reporting-a-Bug/">reporting_a_bug</a>
</li>
            
<li >
    <a href="../../contributing/Contributing-to-thg/">Get Started</a>
</li>
            
<li >
    <a href="../../../cli/templates/">templates</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Roadmaps</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">2019</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../roadmaps/2019/2019-Roadmap/">Roadmap</a>
</li>
            
<li >
    <a href="../../roadmaps/2019/2019-Roadmap-Review/">Roadmap_Review</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">contributing</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../Contributing-to-thg/">contributing_to_thg</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">thg_development</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">thg_how_to</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../How-to-get-started-with-writing-an-exploit/">How to get started with writing an exploit</a>
</li>
            
<li >
    <a href="../How-to-get-started-with-writing-an-auxiliary-module/">How to get started with writing an auxiliary module</a>
</li>
            
<li >
    <a href="../How-to-get-started-with-writing-a-post-module/">How to get started with writing a postmodule</a>
</li>
            
<li >
    <a href="../How-to-get-started-with-writing-a-Meterpreter-script/">How to get started with writing a script</a>
</li>
            
<li >
    <a href="../How-to-check-Microsoft-patch-levels-for-your-exploit/">How to check Microsoft patch levels for your exploit</a>
</li>
            
<li >
    <a href="../How-to-clean-up-files-using-XCybrerFileDropper/">How to clean up files using FileDropper</a>
</li>
            
<li >
    <a href="../How-to-deprecate-a-Metasploit-module/">How to deprecate a Metasploit module</a>
</li>
            
<li >
    <a href="../How-to-do-reporting-or-store-data-in-module-development/">How to do reporting or store data in module development</a>
</li>
            
<li >
    <a href="../How-to-log-in-Metasploit/">How to log in THG</a>
</li>
            
<li >
    <a href="../How-to-obfuscate-JavaScript-in-Metasploit/">How to obfuscate JavaScript in Metasploit</a>
</li>
            
<li >
    <a href="../How-to-parse-an-HTTP-response/">How to parse an HTTP response</a>
</li>
            
<li >
    <a href="../How-to-Send-an-HTTP-Request-Using-HTTPClient/">How to Send an HTTP Request Using HTTPClient</a>
</li>
            
<li >
    <a href="../How-to-send-an-HTTP-request-using-Rex-Proto-Http-Client/">How to send an HTTP request using Rex Proto Http Client</a>
</li>
            
<li >
    <a href="../How-to-use-command-stagers/">How to use command stagers</a>
</li>
            
<li >
    <a href="../How-to-use-datastore-options/">How to use datastore options</a>
</li>
            
<li >
    <a href="../How-to-use-Msf-Auxiliary-AuthBrute-to-write-a-bruteforcer/">How to use Msf Auxiliary AuthBrute to write a bruteforcer</a>
</li>
            
<li >
    <a href="../How-to-use-PhpEXE-to-exploit-an-arbitrary-file-upload-bug/">How to use PhpEXE to exploit an arbitrary file upload bug</a>
</li>
            
<li >
    <a href="../How-to-use-Powershell-in-an-exploit/">How to use Powershell in an exploit</a>
</li>
            
<li >
    <a href="../How-to-use-Railgun-for-Windows-post-exploitation/">How to use Railgun for Windows post exploitation</a>
</li>
            
<li >
    <a href="../How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit/">How to Use the FILEFORMAT mixin to create a file format exploit</a>
</li>
            
<li >
    <a href="../How-to-use-the-Msf-Exploit-Remote-Tcp-mixin/">How to use the Msf Exploit Remote Tcp mixin</a>
</li>
            
<li >
    <a href="../How-to-use-the-Seh-mixin-to-exploit-an-exception-handler/">How to use the Seh mixin to exploit an exception handler</a>
</li>
            
<li >
    <a href="../How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows/">How to use WbemExec for a write privilege attack on Windows</a>
</li>
            
<li class="active">
    <a href="./">How to write a browser exploit using BrowserExploitServer</a>
</li>
            
<li >
    <a href="../How-to-write-a-browser-exploit-using-HttpServer/">How to write a browser exploit using HttpServer</a>
</li>
            
<li >
    <a href="../How-to-write-a-check()-method/">How to write a check() method</a>
</li>
            
<li >
    <a href="../How-to-write-a-HTTP-LoginScanner-Module/">How to write a HTTP LoginScanner Module</a>
</li>
            
<li >
    <a href="../How-to-write-a-module-using-HttpServer-and-HttpClient/">How to write a module using HttpServer and HttpClient</a>
</li>
            
<li >
    <a href="../How-to-zip-files-with-Rex-Zip-Archive.md">How to zip files with Rex Zip Archive</a>
</li>
            
<li >
    <a href="../How-to-use-Metasploit-Framework-Obfuscation-CRandomizer/">How to use Metasploit Framework Compiler Windows to compile C code</a>
</li>
            
<li >
    <a href="../How to use Metasploit Framework Obfuscation CRandomizer">How to use Metasploit Framework Obfuscation CRandomizer</a>
</li>
            
<li >
    <a href="../How-to-decrypt-RC4-with-Metasploit-Framework-Compiler/">How to decrypt RC4 with Metasploit Framework Compiler</a>
</li>
            
<li >
    <a href="../How-to-decode-Base64-with-thg-Framework-Compiler.md">How to decode Base64 with tgh Framework Compiler</a>
</li>
            
<li >
    <a href="../How-to-XOR-with-thg-Framework-Compiler.md">How to XOR with thg Framework Compiler</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../Style_Tips/">Style_Tips</a>
</li>
            
<li >
    <a href="../Running-Private-Modules/">Running Private Modules</a>
</li>
            
<li >
    <a href="../Exploit-Ranking/">Exploit Ranking</a>
</li>
            
<li >
    <a href="../THG-module-reference-identifiers/">THG module reference identifiers</a>
</li>
            
<li >
    <a href="../Using-ReflectiveDll-Injection.md">Using ReflectiveDll Injection</a>
</li>
            
<li >
    <a href="../Oracle-Usage.md">Oracle Usage</a>
</li>
            
<li >
    <a href="../Rex-Layout.md">Rex Layout</a>
</li>
            
<li >
    <a href="../">Definition of Module Reliability, Side Effects, and Stability</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">documentation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">capture the flag</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/analysis/linux/">linux</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/analysis/windows/">windows</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/analysis/malware/">malware</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">recovery</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/recover/backuo/">backup</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/recover/patching/">patching</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">tips_end_tricks</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/tools/">tools</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/decoding/">decoding</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/dos/">dos</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/os_cheats/">os_cheats</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/tips_end_tricks/snort/">snort</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/identify/basic/">basic</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/nmap/">nmap</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/nessus/">nessus</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/openvas/">openvas</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/windows/">windows</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/identify/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">defend</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/prootect_defend/windows/">windows</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/prootect_defend/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/detect/tcpdump/">tcpdump</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/editcap/">edicap</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/mergecap/">mergecap</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/snort/">snort</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/tshark/">tshark</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/analysis/">analysis</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">os</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/basic/detect/linux/">linux</a>
</li>
            
<li >
    <a href="../../../capturetheflag/basic/detect/windows/">windows</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
<li >
    <a href="../../../deployment/">Deployment</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">hash_crack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../capturetheflag/hash_crack/">index</a>
</li>
            
<li >
    <a href="../../../capturetheflag/hash_crack/CORE_HASH_CRACKING_KNOWLEDGE/">CORE_HASH_CRACKING_KNOWLEDGE</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">pentest_standard</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../pentest_standard/preengagemente/">Pre engagement Interactions</a>
</li>
            
<li >
    <a href="../../../pentest_standard/ig/">Intelligence Gathering</a>
</li>
            
<li >
    <a href="../../../pentest_standard/threatmodeling/">Threat Modeling</a>
</li>
            
<li >
    <a href="../../../pentest_standard/vulnterability/">Vulnerability Analysis</a>
</li>
            
<li >
    <a href="../../../pentest_standard/exploration/">Exploitation</a>
</li>
            
<li >
    <a href="../../../pentest_standard/postexploration/">Post Exploitation</a>
</li>
            
<li >
    <a href="../../../pentest_standard/report/">Reporting</a>
</li>
            
<li >
    <a href="../../../pentest_standard/tecguidelines/">Technical Guidelines</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">CLI <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-1</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../tutorials/thg/">THG</a>
</li>
            
<li >
    <a href="../../../tutorials/server/server/">thg_server</a>
</li>
            
<li >
    <a href="../../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../../tutorials/shells/shells/">thg_shells</a>
</li>
            
<li >
    <a href="../../../tutorials/thg_docs/thg_docs/">thg_docs</a>
</li>
            
<li >
    <a href="../../../tutorials/auxiliares/auxiliares/">thg_auxiliares</a>
</li>
            
<li >
    <a href="../../../tutorials/anti_forensic/anti_forensic/">thg_anti_forensic</a>
</li>
            
<li >
    <a href="../../../tutorials/crypto/crypto/">thg_crypto</a>
</li>
            
<li >
    <a href="../../../tutorials/drone/drone/">thg_drone</a>
</li>
            
<li >
    <a href="../../../tutorials/keylogger/keylogger/">thg_keylogger</a>
</li>
            
<li >
    <a href="../../../tutorials/recon/recon/">thg_recon</a>
</li>
            
<li >
    <a href="../../../tutorials/voip/voip/">thg_voip</a>
</li>
            
<li >
    <a href="../../../tutorials/automation/automation/">thg_automation</a>
</li>
            
<li >
    <a href="../../../tutorials/cryptography/cryptography/">thg_cryptography</a>
</li>
            
<li >
    <a href="../../../tutorials/exploitation/exploitation/">thg_exploitation</a>
</li>
            
<li >
    <a href="../../../tutorials/malware/malware/">thg_malware</a>
</li>
            
<li >
    <a href="../../../tutorials/reversing/reversing/">thg_reversing</a>
</li>
            
<li >
    <a href="../../../tutorials/thg_windows/thg_windows/">thg_windows</a>
</li>
            
<li >
    <a href="../../../tutorials/automobile/automobile/">thg_automobile</a>
</li>
            
<li >
    <a href="../../../tutorials/database/database/">thg_database</a>
</li>
            
<li >
    <a href="../../../tutorials/fingerprint/fingerprint/">thg_fingerprint</a>
</li>
            
<li >
    <a href="../../../tutorials/misc/misc/">thg_misc</a>
</li>
            
<li >
    <a href="../../../tutorials/sniffer/sniffer/">thg_sniffer</a>
</li>
            
<li >
    <a href="../../../tutorials/wireless/wireless/">thg_wireless</a>
</li>
            
<li >
    <a href="../../../tutorials/debugger/debugger/">thg_debugger</a>
</li>
            
<li >
    <a href="../../../tutorials/firmware/firmware/">thg_firmware</a>
</li>
            
<li >
    <a href="../../../tutorials/mobile/mobile/">thg_mobile</a>
</li>
            
<li >
    <a href="../../../tutorials/social/social/">thg_social</a>
</li>
            
<li >
    <a href="../../../tutorials/backdoor/backdoor/">thg_backdoor</a>
</li>
            
<li >
    <a href="../../../tutorials/decompiler/decompiler/">thg_decompiler</a>
</li>
            
<li >
    <a href="../../../tutorials/forensic/forensic/">thg_forensic</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-2</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../tutorials/networking/networking/">thg_networking</a>
</li>
            
<li >
    <a href="../../../tutorials/spoff/spoff/">thg_spoff</a>
</li>
            
<li >
    <a href="../../../tutorials/binary/binary/">thg_binary</a>
</li>
            
<li >
    <a href="../../../tutorials/defensensive/defensensive/">thg_defensensive</a>
</li>
            
<li >
    <a href="../../../tutorials/gpu/gpu/">thg_gpu</a>
</li>
            
<li >
    <a href="../../../tutorials/os/os/">thg_os</a>
</li>
            
<li >
    <a href="../../../tutorials/nfc/nfc/">thg_nfc</a>
</li>
            
<li >
    <a href="../../../tutorials/spoof/spoof/">thg_spoof</a>
</li>
            
<li >
    <a href="../../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../../tutorials/bluetooth/bluetooth/">thg_bluetooth</a>
</li>
            
<li >
    <a href="../../../tutorials/defensive/defensive/">thg_defensive</a>
</li>
            
<li >
    <a href="../../../tutorials/hardware/hardware/">thg_hardware</a>
</li>
            
<li >
    <a href="../../../tutorials/packer/packer/">thg_packer</a>
</li>
            
<li >
    <a href="../../../tutorials/stego/stego/">thg_stego</a>
</li>
            
<li >
    <a href="../../../tutorials/code_audit/code_audit/">thg_code_audit</a>
</li>
            
<li >
    <a href="../../../tutorials/disassembler/disassembler/">thg_disassembler</a>
</li>
            
<li >
    <a href="../../../tutorials/honeypot/honeypot/">thg_honeypot</a>
</li>
            
<li >
    <a href="../../../tutorials/proxy/proxy/">thg_proxy</a>
</li>
            
<li >
    <a href="../../../tutorials/tunnel/tunnel/">thg_tunnel</a>
</li>
            
<li >
    <a href="../../../tutorials/cracker/cracker/">thg_cracker</a>
</li>
            
<li >
    <a href="../../../tutorials/dos/dos/">thg_dos</a>
</li>
            
<li >
    <a href="../../../tutorials/ids/ids/">thg_ids</a>
</li>
            
<li >
    <a href="../../../tutorials/radio/radio/">thg_radio</a>
</li>
            
<li >
    <a href="../../../tutorials/unpacker/unpacker/">thg_unpacker</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../How-to-write-a-browser-exploit-using-HttpServer/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/darkcode357/thg-framework/edit/master/docs/dev/thg_dev/How-to-write-a-browser-exploit-using-BrowserExploitServer.md">Edit on darkcode357/thg-framework</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#the-automatic-exploitation-procedure">The Automatic Exploitation Procedure</a></li>
        <li class="main "><a href="#setting-exploitable-requirements">Setting Exploitable Requirements</a></li>
        <li class="main "><a href="#set-up-a-listener">Set up a listener</a></li>
        <li class="main "><a href="#crafting-html-with-browserexploitserver">Crafting HTML with BrowserExploitServer</a></li>
        <li class="main "><a href="#javascript-obfuscation">JavaScript Obfuscation</a></li>
        <li class="main "><a href="#related-articles">Related Articles:</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>The Metasploit Framework provides different mixins you can use to develop a browser exploit, mainly they are:</p>
<ul>
<li><strong><a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-browser-exploit-using-HttpServer">Msf::Exploit::Remote::HttpServer</a></strong> - The most basic form of a HTTP server.</li>
<li><strong>Msf::Exploit::Remote::HttpServer::HTML</strong> - which provides Javascript functions that the module can use when crafting HTML contents.</li>
<li><strong><a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-browser-exploit-using-BrowserExploitServer">Msf::Exploit::Remote::BrowserExploitServer</a></strong> - which includes features from both HttpServer and HttpServer::HTML, but with even more goodies. This writeup covers the <a href="https://rapid7.github.io/metasploit-framework/Msf/Exploit/Remote/BrowserExploitServer.html">BrowserExploitServer</a> mixin.</li>
</ul>
<h3 id="the-automatic-exploitation-procedure">The Automatic Exploitation Procedure</h3>
<p>The BrowserExploitServer mixin is the only mixin specially designed for browser exploitation. Before you use this mixin, you should understand what it does behind the scenes for you:</p>
<ol>
<li>It automatically collects the browser information, including things like: OS name, version, browser name, browser version, whether a proxy is used, Java plugin version, Microsoft Office version, etc, etc. If the browser doesn't have Javascript enabled, then it knows less about the target. All the info gathered will be stored in a profile managed by the mixin.</li>
<li>The mixin will then tag the browser to track the session. It will also use the same tag to retrieve the profile when needed.</li>
<li>Before the mixin decides if it should serve the exploit to the browser, it will check with the module for any exploitable requirements. If the requirements aren't met, it will send a 404 to the browser, and the operation bails.</li>
<li>If the requirements are met, the mixin will pass the profile (information about the browser gathered during the detection stage) to the module, and let it take over the rest.</li>
</ol>
<p>Hint: In the module, you can check the :source key in the profile to determine whether Javascript is enabled or not: If the :source is "script", it means Javascript is enabled. If it's "headers" (as in HTTP headers), then the browser has Javascript disabled.</p>
<h3 id="setting-exploitable-requirements">Setting Exploitable Requirements</h3>
<p>Being able to set browser requirements is an important feature of the mixin. It allows your attack to be smarter, more targeted, and prevents accidents. Here's a scenario: Say you have a vulnerability against Internet Explorer that only affects a specific range of MSHTML builds, you can set the :os_name, :ua_name, :ua_ver, and :mshtml_build to make sure it doesn't blindly exploit against anything else. The :mshtml_build requirement can be found in "Product version" under MSHTML's file properties.</p>
<p>Exploitable browser requirements are defined under "BrowserRequirements" in the module's metadata. Here's an example of defining a vulnerable target running some ActiveX control:</p>
<div class="highlight"><pre><span></span><span class="s1">&#39;BrowserRequirements&#39;</span> <span class="o">=&gt;</span>
<span class="p">{</span>
    <span class="ss">source</span><span class="p">:</span> <span class="sr">/script/i</span><span class="p">,</span>
        <span class="ss">activex</span><span class="p">:</span> <span class="o">[</span>
          <span class="p">{</span>
            <span class="ss">clsid</span><span class="p">:</span> <span class="s1">&#39;{D27CDB6E-AE6D-11cf-96B8-444553540000}&#39;</span><span class="p">,</span>
            <span class="nb">method</span><span class="p">:</span> <span class="s1">&#39;LoadMovie&#39;</span>
          <span class="p">}</span>
        <span class="o">]</span><span class="p">,</span>
    <span class="ss">os_name</span><span class="p">:</span> <span class="sr">/win/i</span>
<span class="p">}</span>
</pre></div>

<p>You can also define target-specific requirements. This is also how the mixin is able to automatically select a target, and you can get it with the "get_target" method. Here's an example of how to define target-specific requirements for IE8 on Win XP and IE 9 on Win 7:</p>
<div class="highlight"><pre><span></span><span class="s1">&#39;BrowserRequirements&#39;</span> <span class="o">=&gt;</span>
  <span class="p">{</span>
    <span class="ss">:source</span>   <span class="o">=&gt;</span> <span class="sr">/script|headers/i</span><span class="p">,</span>
    <span class="s1">&#39;ua_name&#39;</span> <span class="o">=&gt;</span> <span class="no">HttpClients</span><span class="o">::</span><span class="no">IE</span><span class="p">,</span>
  <span class="p">},</span>
<span class="s1">&#39;Targets&#39;</span>             <span class="o">=&gt;</span>
  <span class="o">[</span>
    <span class="o">[</span> <span class="s1">&#39;Automatic&#39;</span><span class="p">,</span> <span class="p">{}</span> <span class="o">]</span><span class="p">,</span>
    <span class="o">[</span>
      <span class="s1">&#39;Windows XP with IE 8&#39;</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="ss">:os_name</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Windows XP&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ua_ver&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;8.0&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Rop&#39;</span>       <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
        <span class="s1">&#39;Offset&#39;</span>    <span class="o">=&gt;</span> <span class="mh">0x100</span>
      <span class="p">}</span>
    <span class="o">]</span><span class="p">,</span>
    <span class="o">[</span>
      <span class="s1">&#39;Windows 7 with IE 9&#39;</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="s1">&#39;os_name&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Windows 7&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ua_ver&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;9.0&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Rop&#39;</span>       <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
        <span class="s1">&#39;Offset&#39;</span>    <span class="o">=&gt;</span> <span class="mh">0x200</span>
      <span class="p">}</span>
    <span class="o">]</span>
  <span class="o">]</span>
</pre></div>

<p>You can use these for <strong>:os_name</strong>:</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>OperatingSystems::Match::WINDOWS</td>
<td>Match all versions of Windows</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_95</td>
<td>Match Windows 95</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_98</td>
<td>Match Windows 98</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_ME</td>
<td>Match Windows ME</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_NT3</td>
<td>Match Windows NT 3</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_NT4</td>
<td>Match Windows NT 4</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_2000</td>
<td>Match Windows 2000</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_XP</td>
<td>Match Windows XP</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_2003</td>
<td>Match Windows Server 2003</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_VISTA</td>
<td>Match Windows Vista</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_2008</td>
<td>Match Windows Server 2008</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_7</td>
<td>Match Windows 7</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_2012</td>
<td>Match Windows 2012</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_8</td>
<td>Match Windows 8</td>
</tr>
<tr>
<td>OperatingSystems::Match::WINDOWS_81</td>
<td>Match Windows 8.1</td>
</tr>
<tr>
<td>OperatingSystems::Match::LINUX</td>
<td>Match a Linux distro</td>
</tr>
<tr>
<td>OperatingSystems::Match::MAC_OSX</td>
<td>Match Mac OSX</td>
</tr>
<tr>
<td>OperatingSystems::Match::FREEBSD</td>
<td>Match FreeBSD</td>
</tr>
<tr>
<td>OperatingSystems::Match::NETBSD</td>
<td>Match NetBSD</td>
</tr>
<tr>
<td>OperatingSystems::Match::OPENBSD</td>
<td>Match OpenBSD</td>
</tr>
<tr>
<td>OperatingSystems::Match::VMWARE</td>
<td>Match VMWare</td>
</tr>
<tr>
<td>OperatingSystems::Match::ANDROID</td>
<td>Match Android</td>
</tr>
<tr>
<td>OperatingSystems::Match::APPLE_IOS</td>
<td>Match Apple IOS</td>
</tr>
</tbody>
</table>
<p>You can use these for <strong>:ua_name</strong>:</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>HttpClients::IE</td>
<td>"MSIE"</td>
</tr>
<tr>
<td>HttpClients::FF</td>
<td>"Firefox"</td>
</tr>
<tr>
<td>HttpClients::SAFARI</td>
<td>"Safari"</td>
</tr>
<tr>
<td>HttpClients::OPERA</td>
<td>"Opera"</td>
</tr>
<tr>
<td>HttpClients::CHROME</td>
<td>"Chrome"</td>
</tr>
</tbody>
</table>
<p>More of these constants can be found here:
<a href="https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/constants.rb">https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/constants.rb</a></p>
<p>All currently supported requirements by the mixin can be found here (see REQUIREMENT_KEY_SET):
<a href="https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/exploit/remote/browser_exploit_server.rb#L46">https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/exploit/remote/browser_exploit_server.rb#L46</a></p>
<h3 id="set-up-a-listener">Set up a listener</h3>
<p>After the detection stage and the requirement check, the mixin will trigger the "on_request_exploit" callback method, that's where you handle the HTTP request, craft the HTML, and send back the exploit response. Here's an example of how to set up "on_request_exploit":</p>
<div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Listens for the HTTP request</span>
<span class="c1"># cli is the socket</span>
<span class="c1"># request is the Rex::Proto::Http::Request object</span>
<span class="c1"># target_info is a hash that contains all the browser info (aka the profile)</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">on_request_exploit</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">target_info</span><span class="p">)</span>
    <span class="n">print_status</span><span class="p">(</span><span class="s2">&quot;Here&#39;s what I know about the target: </span><span class="si">#{</span><span class="n">target_info</span><span class="o">.</span><span class="n">inspect</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>

<h3 id="crafting-html-with-browserexploitserver">Crafting HTML with BrowserExploitServer</h3>
<p>There are two coding styles the BrowserExploitServer mixin supports: The good old HTML, or <a href="http://ruby-doc.org/stdlib-2.1.3/libdoc/erb/rdoc/ERB.html">ERB</a> template. The first is pretty self-explanatory:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_request_exploit</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">target_info</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="sx">%Q|</span>
<span class="sx">    &lt;html&gt;</span>
<span class="sx">    Hello, world!</span>
<span class="sx">    &lt;/html&gt;</span>
<span class="sx">    |</span>
    <span class="n">send_exploit_html</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">html</span><span class="p">)</span>
<span class="k">end</span> 
</pre></div>

<p><a href="http://ruby-doc.org/stdlib-2.1.3/libdoc/erb/rdoc/ERB.html">ERB</a> is a new way to write Metasploit browser exploits. If you've written one or two web applications, this is no stranger to you. When you're using the BrowserExploitServer mixin to write an exploit, what really happens is you're writing a rails template. Here's an example of using of this feature:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_request_exploit</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">target_info</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="sx">%Q|</span>
<span class="sx">    &lt;html&gt;</span>
<span class="sx">    Do you feel lucky, punk?&lt;br&gt;</span>
<span class="sx">    &lt;% if [true, false].sample %&gt;</span>
<span class="sx">    Lucky!&lt;br&gt;</span>
<span class="sx">    &lt;% else %&gt;</span>
<span class="sx">    Bad luck, bro!&lt;Br&gt;</span>
<span class="sx">    &lt;% end %&gt;</span>
<span class="sx">    &lt;/html&gt;</span>
<span class="sx">    |</span>
    <span class="n">send_exploit_html</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">html</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>

<p>If you want to access local variables or arguments, make sure to pass the binding object to send_exploit_html:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">exploit_template1</span><span class="p">(</span><span class="n">target_info</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
    <span class="n">txt2</span> <span class="o">=</span> <span class="s2">&quot;I can use local vars!&quot;</span>

    <span class="n">template</span> <span class="o">=</span> <span class="sx">%Q|</span>
<span class="sx">    &lt;% msg = &quot;This page is generated by an exploit&quot; %&gt;</span>
<span class="sx">    &lt;%=msg%&gt;&lt;br&gt;</span>
<span class="sx">    &lt;%=txt%&gt;&lt;br&gt;</span>
<span class="sx">    &lt;%=txt2%&gt;&lt;br&gt;</span>
<span class="sx">    &lt;p&gt;&lt;/p&gt;</span>
<span class="sx">    Data gathered from source: </span><span class="si">#{</span><span class="n">target_info</span><span class="o">[</span><span class="ss">:source</span><span class="o">]</span><span class="si">}</span><span class="sx">&lt;br&gt;</span>
<span class="sx">    OS name: </span><span class="si">#{</span><span class="n">target_info</span><span class="o">[</span><span class="ss">:os_name</span><span class="o">]</span><span class="si">}</span><span class="sx">&lt;br&gt;</span>
<span class="sx">    UA name: </span><span class="si">#{</span><span class="n">target_info</span><span class="o">[</span><span class="ss">:ua_name</span><span class="o">]</span><span class="si">}</span><span class="sx">&lt;br&gt;</span>
<span class="sx">    UA version: </span><span class="si">#{</span><span class="n">target_info</span><span class="o">[</span><span class="ss">:ua_ver</span><span class="o">]</span><span class="si">}</span><span class="sx">&lt;br&gt;</span>
<span class="sx">    Java version: </span><span class="si">#{</span><span class="n">target_info</span><span class="o">[</span><span class="ss">:java</span><span class="o">]</span><span class="si">}</span><span class="sx">&lt;br&gt;</span>
<span class="sx">    Office version: </span><span class="si">#{</span><span class="n">target_info</span><span class="o">[</span><span class="ss">:office</span><span class="o">]</span><span class="si">}</span><span class="sx"></span>
<span class="sx">    |</span>

    <span class="k">return</span> <span class="n">template</span><span class="p">,</span> <span class="nb">binding</span><span class="p">()</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">on_request_exploit</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">target_info</span><span class="p">)</span>
    <span class="n">send_exploit_html</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">exploit_template</span><span class="p">(</span><span class="n">target_info</span><span class="p">,</span> <span class="n">txt</span><span class="p">))</span>
<span class="k">end</span>
</pre></div>

<p>The BrowserExploitServer mixin also offers plenty of other things useful while crafting the exploit. For example: it can generate a target-specific payload when you call the "get_payload" method. It also gives you access to the RopDb mixin, which contains a collection of ROPs to bypass DEP (Data Execution Prevention). Make sure to check out the API documentation for more information.</p>
<p>To get thing started, here's a code example you can use start developing your browser exploit:</p>
<div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1"># This module requires Metasploit: http://metasploit.com/download</span>
<span class="c1"># Current source: https://github.com/rapid7/metasploit-framework</span>
<span class="c1">##</span>

<span class="nb">require</span> <span class="s1">&#39;msf/core&#39;</span>

<span class="k">class</span> <span class="nc">MetasploitModule</span> <span class="o">&lt;</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">Remote</span>
  <span class="no">Rank</span> <span class="o">=</span> <span class="no">NormalRanking</span>

  <span class="kp">include</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">Remote</span><span class="o">::</span><span class="no">BrowserExploitServer</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="p">{})</span>
    <span class="k">super</span><span class="p">(</span><span class="n">update_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
      <span class="s1">&#39;Name&#39;</span>           <span class="o">=&gt;</span> <span class="s2">&quot;BrowserExploitServer Example&quot;</span><span class="p">,</span>
      <span class="s1">&#39;Description&#39;</span>    <span class="o">=&gt;</span> <span class="sx">%q{</span>
<span class="sx">        This is an example of building a browser exploit using the BrowserExploitServer mixin</span>
<span class="sx">      }</span><span class="p">,</span>
      <span class="s1">&#39;License&#39;</span>        <span class="o">=&gt;</span> <span class="no">MSF_LICENSE</span><span class="p">,</span>
      <span class="s1">&#39;Author&#39;</span>         <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;sinn3r&#39;</span> <span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;References&#39;</span>     <span class="o">=&gt;</span>
        <span class="o">[</span>
          <span class="o">[</span> <span class="s1">&#39;URL&#39;</span><span class="p">,</span> <span class="s1">&#39;http://metasploit.com&#39;</span> <span class="o">]</span>
        <span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;Platform&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;win&#39;</span><span class="p">,</span>
      <span class="s1">&#39;BrowserRequirements&#39;</span> <span class="o">=&gt;</span>
        <span class="p">{</span>
          <span class="ss">:source</span> <span class="o">=&gt;</span> <span class="sr">/script|headers/i</span><span class="p">,</span>
        <span class="p">},</span>
      <span class="s1">&#39;Targets&#39;</span>        <span class="o">=&gt;</span>
        <span class="o">[</span>
          <span class="o">[</span> <span class="s1">&#39;Automatic&#39;</span><span class="p">,</span> <span class="p">{}</span> <span class="o">]</span><span class="p">,</span>
          <span class="o">[</span>
            <span class="s1">&#39;Windows XP with IE 8&#39;</span><span class="p">,</span>
            <span class="p">{</span>
              <span class="s1">&#39;os_name&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Windows XP&#39;</span><span class="p">,</span>
              <span class="s1">&#39;ua_name&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;MSIE&#39;</span><span class="p">,</span>
              <span class="s1">&#39;ua_ver&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;8.0&#39;</span>
            <span class="p">}</span>
          <span class="o">]</span><span class="p">,</span>
          <span class="o">[</span>
            <span class="s1">&#39;Windows 7 with IE 9&#39;</span><span class="p">,</span>
            <span class="p">{</span>
              <span class="s1">&#39;os_name&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Windows 7&#39;</span><span class="p">,</span>
              <span class="s1">&#39;ua_name&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;MSIE&#39;</span><span class="p">,</span>
              <span class="s1">&#39;ua_ver&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;9.0&#39;</span>
            <span class="p">}</span>
          <span class="o">]</span>
        <span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;Payload&#39;</span>        <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;BadChars&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="p">},</span>
      <span class="s1">&#39;DisclosureDate&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Apr 1 2013&quot;</span><span class="p">,</span>
      <span class="s1">&#39;DefaultTarget&#39;</span>  <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">))</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">exploit_template</span><span class="p">(</span><span class="n">target_info</span><span class="p">)</span>
    <span class="n">template</span> <span class="o">=</span> <span class="sx">%Q|</span>
<span class="sx">    Data source: &lt;%=target_info[:source]%&gt;&lt;br&gt;</span>
<span class="sx">    OS name: &lt;%=target_info[:os_name]%&gt;&lt;br&gt;</span>
<span class="sx">    UA name: &lt;%=target_info[:ua_name]%&gt;&lt;br&gt;</span>
<span class="sx">    UA version: &lt;%=target_info[:ua_ver]%&gt;&lt;br&gt;</span>
<span class="sx">    Java version: &lt;%=target_info[:java]%&gt;&lt;br&gt;</span>
<span class="sx">    Office version: &lt;%=target_info[:office]%&gt;</span>
<span class="sx">    |</span>

    <span class="k">return</span> <span class="n">template</span><span class="p">,</span> <span class="nb">binding</span><span class="p">()</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">on_request_exploit</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">target_info</span><span class="p">)</span>
    <span class="n">send_exploit_html</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">exploit_template</span><span class="p">(</span><span class="n">target_info</span><span class="p">))</span>
  <span class="k">end</span>

<span class="k">end</span>
</pre></div>

<h3 id="javascript-obfuscation">JavaScript Obfuscation</h3>
<p>BrowserExploitServer relies on the <a href="https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/exploit/jsobfu.rb">JSObfu mixin</a> to support JavaScript obfuscation. When you're writing JavaScript, you should always write it like this:</p>
<div class="highlight"><pre><span></span><span class="n">js</span> <span class="o">=</span> <span class="n">js_obfuscate</span><span class="p">(</span><span class="n">your_code</span><span class="p">)</span>
</pre></div>

<p>The <code>#js_obfuscate</code> will return a <code>Rex::Exploitation::JSObfu</code> object. To get the obfuscated JavaScript, call the <code>#to_s</code> method:</p>
<div class="highlight"><pre><span></span><span class="n">js</span><span class="o">.</span><span class="n">to_s</span>
</pre></div>

<p>If you need to access an obfuscated symbol name, you can use then <code>#sym</code> method:</p>
<div class="highlight"><pre><span></span><span class="c1"># Get the obfuscated version of function name test()</span>
<span class="n">var_name</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>

<p>Note that by default, even though your module is calling the <code>#js_obfuscate</code> method, obfuscation will not kick in unless the user sets the JsObfuscate datastore option. This option is an OptInt, which allows you to set the number of times to obfuscate (default is 0).</p>
<p>If your BES-based exploit does not want obfuscation at all, always make sure you call the <code>#deregister_options</code> and remove the JsObfuscate option. Like this:</p>
<div class="highlight"><pre><span></span><span class="n">deregister_options</span><span class="p">(</span><span class="s1">&#39;JsObfuscate&#39;</span><span class="p">)</span>
</pre></div>

<p>To learn more about Metasploit's JavaScript obfuscation capabilities, please read <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-obfuscate-JavaScript-in-Metasploit">How to obfuscate JavaScript in Metasploit</a>.</p>
<h3 id="related-articles">Related Articles:</h3>
<ul>
<li><a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-browser-exploit-using-HttpServer">https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-browser-exploit-using-HttpServer</a></li>
<li><a href="https://github.com/rapid7/metasploit-framework/wiki/Information-About-Unmet-Browser-Exploit-Requirements">https://github.com/rapid7/metasploit-framework/wiki/Information-About-Unmet-Browser-Exploit-Requirements</a></li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2019 - 2020 darkcode0x00</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
