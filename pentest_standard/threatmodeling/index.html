<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="darkcode0x00 luizcorrea">
        <link rel="canonical" href="https://darkcode357.github.io/thg-framework/pentest_standard/threatmodeling/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Threat Modeling - thg-framework</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/darcula.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">thg-framework</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../cli/install/">Installation</a>
</li>
                                    
<li >
    <a href="../..">Introduction</a>
</li>
                                    
<li >
    <a href="../../community/">Community</a>
</li>
                                    
<li >
    <a href="../../conceptual/">Conceptual</a>
</li>
                                    
<li >
    <a href="../../cli/build/">build</a>
</li>
                                    
<li >
    <a href="../../cli/tags/">tags</a>
</li>
                                    
<li >
    <a href="../../LICENSE/">LICENSE</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">thg_dev <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">gettin_started</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/thg_dev/_Sidebar/">thg_Development_Environment</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Using-thg/">using_thg</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">git</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/git/Using-Git/">Using-Git</a>
</li>
            
<li >
    <a href="../../dev/git/Git-cheatsheet/">Git_cheatsheet</a>
</li>
            
<li >
    <a href="../../dev/git/Git-Reference-Sites/">Git-Reference-Sites</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../dev/thg_dev/Reporting-a-Bug/">reporting_a_bug</a>
</li>
            
<li >
    <a href="../../dev/contributing/Contributing-to-thg/">Get Started</a>
</li>
            
<li >
    <a href="../../cli/templates/">templates</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Roadmaps</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">2019</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/roadmaps/2019/2019-Roadmap/">Roadmap</a>
</li>
            
<li >
    <a href="../../dev/roadmaps/2019/2019-Roadmap-Review/">Roadmap_Review</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">contributing</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/thg_dev/Contributing-to-thg/">contributing_to_thg</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">thg_development</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">thg_how_to</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-an-exploit/">How to get started with writing an exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-an-auxiliary-module/">How to get started with writing an auxiliary module</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-a-post-module/">How to get started with writing a postmodule</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-a-Meterpreter-script/">How to get started with writing a script</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-check-Microsoft-patch-levels-for-your-exploit/">How to check Microsoft patch levels for your exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-clean-up-files-using-XCybrerFileDropper/">How to clean up files using FileDropper</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-deprecate-a-Metasploit-module/">How to deprecate a Metasploit module</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-do-reporting-or-store-data-in-module-development/">How to do reporting or store data in module development</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-log-in-Metasploit/">How to log in THG</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-obfuscate-JavaScript-in-Metasploit/">How to obfuscate JavaScript in Metasploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-parse-an-HTTP-response/">How to parse an HTTP response</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-Send-an-HTTP-Request-Using-HTTPClient/">How to Send an HTTP Request Using HTTPClient</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-send-an-HTTP-request-using-Rex-Proto-Http-Client/">How to send an HTTP request using Rex Proto Http Client</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-command-stagers/">How to use command stagers</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-datastore-options/">How to use datastore options</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Msf-Auxiliary-AuthBrute-to-write-a-bruteforcer/">How to use Msf Auxiliary AuthBrute to write a bruteforcer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-PhpEXE-to-exploit-an-arbitrary-file-upload-bug/">How to use PhpEXE to exploit an arbitrary file upload bug</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Powershell-in-an-exploit/">How to use Powershell in an exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Railgun-for-Windows-post-exploitation/">How to use Railgun for Windows post exploitation</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit/">How to Use the FILEFORMAT mixin to create a file format exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-the-Msf-Exploit-Remote-Tcp-mixin/">How to use the Msf Exploit Remote Tcp mixin</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-the-Seh-mixin-to-exploit-an-exception-handler/">How to use the Seh mixin to exploit an exception handler</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows/">How to use WbemExec for a write privilege attack on Windows</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-browser-exploit-using-BrowserExploitServer/">How to write a browser exploit using BrowserExploitServer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-browser-exploit-using-HttpServer/">How to write a browser exploit using HttpServer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-check()-method/">How to write a check() method</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-HTTP-LoginScanner-Module/">How to write a HTTP LoginScanner Module</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-module-using-HttpServer-and-HttpClient/">How to write a module using HttpServer and HttpClient</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-zip-files-with-Rex-Zip-Archive.md">How to zip files with Rex Zip Archive</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Metasploit-Framework-Obfuscation-CRandomizer/">How to use Metasploit Framework Compiler Windows to compile C code</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How to use Metasploit Framework Obfuscation CRandomizer">How to use Metasploit Framework Obfuscation CRandomizer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-decrypt-RC4-with-Metasploit-Framework-Compiler/">How to decrypt RC4 with Metasploit Framework Compiler</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-decode-Base64-with-thg-Framework-Compiler.md">How to decode Base64 with tgh Framework Compiler</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-XOR-with-thg-Framework-Compiler.md">How to XOR with thg Framework Compiler</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../dev/thg_dev/Style_Tips/">Style_Tips</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Running-Private-Modules/">Running Private Modules</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Exploit-Ranking/">Exploit Ranking</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/THG-module-reference-identifiers/">THG module reference identifiers</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Using-ReflectiveDll-Injection.md">Using ReflectiveDll Injection</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Oracle-Usage.md">Oracle Usage</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Rex-Layout.md">Rex Layout</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/">Definition of Module Reliability, Side Effects, and Stability</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">documentation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">capture the flag</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/analysis/linux/">linux</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/analysis/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/analysis/malware/">malware</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">recovery</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/recover/backuo/">backup</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/recover/patching/">patching</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">tips_end_tricks</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/tools/">tools</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/decoding/">decoding</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/dos/">dos</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/os_cheats/">os_cheats</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/snort/">snort</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/identify/basic/">basic</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/nmap/">nmap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/nessus/">nessus</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/openvas/">openvas</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">defend</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/prootect_defend/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/prootect_defend/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/detect/tcpdump/">tcpdump</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/editcap/">edicap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/mergecap/">mergecap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/snort/">snort</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/tshark/">tshark</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/analysis/">analysis</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">os</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/detect/linux/">linux</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/windows/">windows</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
<li >
    <a href="../../deployment/">Deployment</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">hash_crack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/hash_crack/">index</a>
</li>
            
<li >
    <a href="../../capturetheflag/hash_crack/CORE_HASH_CRACKING_KNOWLEDGE/">CORE_HASH_CRACKING_KNOWLEDGE</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">pentest_standard</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../preengagemente/">Pre engagement Interactions</a>
</li>
            
<li >
    <a href="../ig/">Intelligence Gathering</a>
</li>
            
<li class="active">
    <a href="./">Threat Modeling</a>
</li>
            
<li >
    <a href="../vulnterability/">Vulnerability Analysis</a>
</li>
            
<li >
    <a href="../exploration/">Exploitation</a>
</li>
            
<li >
    <a href="../postexploration/">Post Exploitation</a>
</li>
            
<li >
    <a href="../report/">Reporting</a>
</li>
            
<li >
    <a href="../tecguidelines/">Technical Guidelines</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">CLI <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-1</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/thg/">THG</a>
</li>
            
<li >
    <a href="../../tutorials/server/server/">thg_server</a>
</li>
            
<li >
    <a href="../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../tutorials/shells/shells/">thg_shells</a>
</li>
            
<li >
    <a href="../../tutorials/thg_docs/thg_docs/">thg_docs</a>
</li>
            
<li >
    <a href="../../tutorials/auxiliares/auxiliares/">thg_auxiliares</a>
</li>
            
<li >
    <a href="../../tutorials/anti_forensic/anti_forensic/">thg_anti_forensic</a>
</li>
            
<li >
    <a href="../../tutorials/crypto/crypto/">thg_crypto</a>
</li>
            
<li >
    <a href="../../tutorials/drone/drone/">thg_drone</a>
</li>
            
<li >
    <a href="../../tutorials/keylogger/keylogger/">thg_keylogger</a>
</li>
            
<li >
    <a href="../../tutorials/recon/recon/">thg_recon</a>
</li>
            
<li >
    <a href="../../tutorials/voip/voip/">thg_voip</a>
</li>
            
<li >
    <a href="../../tutorials/automation/automation/">thg_automation</a>
</li>
            
<li >
    <a href="../../tutorials/cryptography/cryptography/">thg_cryptography</a>
</li>
            
<li >
    <a href="../../tutorials/exploitation/exploitation/">thg_exploitation</a>
</li>
            
<li >
    <a href="../../tutorials/malware/malware/">thg_malware</a>
</li>
            
<li >
    <a href="../../tutorials/reversing/reversing/">thg_reversing</a>
</li>
            
<li >
    <a href="../../tutorials/thg_windows/thg_windows/">thg_windows</a>
</li>
            
<li >
    <a href="../../tutorials/automobile/automobile/">thg_automobile</a>
</li>
            
<li >
    <a href="../../tutorials/database/database/">thg_database</a>
</li>
            
<li >
    <a href="../../tutorials/fingerprint/fingerprint/">thg_fingerprint</a>
</li>
            
<li >
    <a href="../../tutorials/misc/misc/">thg_misc</a>
</li>
            
<li >
    <a href="../../tutorials/sniffer/sniffer/">thg_sniffer</a>
</li>
            
<li >
    <a href="../../tutorials/wireless/wireless/">thg_wireless</a>
</li>
            
<li >
    <a href="../../tutorials/debugger/debugger/">thg_debugger</a>
</li>
            
<li >
    <a href="../../tutorials/firmware/firmware/">thg_firmware</a>
</li>
            
<li >
    <a href="../../tutorials/mobile/mobile/">thg_mobile</a>
</li>
            
<li >
    <a href="../../tutorials/social/social/">thg_social</a>
</li>
            
<li >
    <a href="../../tutorials/backdoor/backdoor/">thg_backdoor</a>
</li>
            
<li >
    <a href="../../tutorials/decompiler/decompiler/">thg_decompiler</a>
</li>
            
<li >
    <a href="../../tutorials/forensic/forensic/">thg_forensic</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-2</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/networking/networking/">thg_networking</a>
</li>
            
<li >
    <a href="../../tutorials/spoff/spoff/">thg_spoff</a>
</li>
            
<li >
    <a href="../../tutorials/binary/binary/">thg_binary</a>
</li>
            
<li >
    <a href="../../tutorials/defensensive/defensensive/">thg_defensensive</a>
</li>
            
<li >
    <a href="../../tutorials/gpu/gpu/">thg_gpu</a>
</li>
            
<li >
    <a href="../../tutorials/os/os/">thg_os</a>
</li>
            
<li >
    <a href="../../tutorials/nfc/nfc/">thg_nfc</a>
</li>
            
<li >
    <a href="../../tutorials/spoof/spoof/">thg_spoof</a>
</li>
            
<li >
    <a href="../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../tutorials/bluetooth/bluetooth/">thg_bluetooth</a>
</li>
            
<li >
    <a href="../../tutorials/defensive/defensive/">thg_defensive</a>
</li>
            
<li >
    <a href="../../tutorials/hardware/hardware/">thg_hardware</a>
</li>
            
<li >
    <a href="../../tutorials/packer/packer/">thg_packer</a>
</li>
            
<li >
    <a href="../../tutorials/stego/stego/">thg_stego</a>
</li>
            
<li >
    <a href="../../tutorials/code_audit/code_audit/">thg_code_audit</a>
</li>
            
<li >
    <a href="../../tutorials/disassembler/disassembler/">thg_disassembler</a>
</li>
            
<li >
    <a href="../../tutorials/honeypot/honeypot/">thg_honeypot</a>
</li>
            
<li >
    <a href="../../tutorials/proxy/proxy/">thg_proxy</a>
</li>
            
<li >
    <a href="../../tutorials/tunnel/tunnel/">thg_tunnel</a>
</li>
            
<li >
    <a href="../../tutorials/cracker/cracker/">thg_cracker</a>
</li>
            
<li >
    <a href="../../tutorials/dos/dos/">thg_dos</a>
</li>
            
<li >
    <a href="../../tutorials/ids/ids/">thg_ids</a>
</li>
            
<li >
    <a href="../../tutorials/radio/radio/">thg_radio</a>
</li>
            
<li >
    <a href="../../tutorials/unpacker/unpacker/">thg_unpacker</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../ig/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../vulnterability/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/darkcode357/thg-framework/edit/master/docs/pentest_standard/threatmodeling.md">Edit on darkcode357/thg-framework</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#general">General</a></li>
            <li><a href="#high-level-threat-modeling-process">High level threat modeling process</a></li>
        <li class="main "><a href="#gather-relevant-documentation">Gather relevant documentation</a></li>
        <li class="main "><a href="#identify-and-categorize-primary-and-secondary-assets">Identify and categorize primary and secondary assets</a></li>
        <li class="main "><a href="#identify-and-categorize-threats-and-threat-communities">Identify and categorize threats and threat communities</a></li>
        <li class="main "><a href="#map-threat-communities-against-primary-and-secondary-assets">Map threat communities against primary and secondary assets</a></li>
            <li><a href="#example">Example</a></li>
            <li><a href="#high-level-modeling-tools">High level modeling tools</a></li>
            <li><a href="#business-asset-analysis">Business Asset Analysis</a></li>
            <li><a href="#business-process-analysis">Business Process Analysis</a></li>
            <li><a href="#threat-agentscommunity-analysis">Threat Agents/Community Analysis</a></li>
            <li><a href="#threat-capability-analysis">Threat Capability Analysis</a></li>
            <li><a href="#motivation-modeling">Motivation Modeling</a></li>
            <li><a href="#finding-relevant-news-of-comparable-organizations-being-compromised">Finding relevant news of comparable Organizations being compromised</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="general">General</h2>
<p>This section defines a threat modeling approach as required for a correct execution of a penetration testing. The standard does not use a specific model, but instead requires that the model used be consistent in terms of its representation of threats, their capabilities, their qualifications as per the organization being tested, and the ability to repeatedly be applied to future tests with the same results.</p>
<p>The standard focuses on two key elements of traditional threat modeling - assets and attacker (threat community/agent). Each one is respectively broken down into business assets and business processes and the threat communities and their capabilities.</p>
<p>As a minimum, all four elements should be clearly identified and documented in every penetration test.</p>
<p>When modeling the attacker side, on top of the threat community (which is mostly semantic and can be tied back to the organization’s business SWOT analysis), and the capabilities (which is mostly technical), additional aspects of motivation modeling should also be provided. These additional points essentially take into account the value of the different assets available at the target and are combined with the cost of acquiring it.
As a complementary model, impact modeling should also be performed for the organization in order to provide a more accurate view of the “what-if?” scenario surrounding the loss event of each of the identified assets. This should take into account the assets “net” value, its intrinsic value, and other indirectly incurred costs associated with a loss event.</p>
<p>The threat modeling phase of any penetration testing engagement is critical for both the testers, as well as the organization. It provides clarity as far as the organization’s risk appetite and prioritization (which assets are more important than others? what threat communities are more relevant than others?). Additionally, it enables the tester to focus on delivering an engagement that closely emulates the tools, techniques, capabilities, accessibility and general profile of the attacker, while keeping in mind what are the actual targets inside the organization such that the more relevant controls, processes, and infrastructure are put to the test rather than an inventory list of IT elements.
The threat model should be constructed in coordination with the organization being tested whenever possible, and even in a complete black-box situation where the tester does not have any prior information on the organization, the tester should create a threat model based on the attacker’s view in combination with OSINT related to the target organization.</p>
<p>The model should be clearly documented, and be delivered as part of the final report as the findings in the report will reference the threat model in order to create a more accurate relevance and risk score that is specific to the organization (rather than a generic technical one).</p>
<h3 id="high-level-threat-modeling-process">High level threat modeling process</h3>
<h1 id="gather-relevant-documentation">Gather relevant documentation</h1>
<h1 id="identify-and-categorize-primary-and-secondary-assets">Identify and categorize primary and secondary assets</h1>
<h1 id="identify-and-categorize-threats-and-threat-communities">Identify and categorize threats and threat communities</h1>
<h1 id="map-threat-communities-against-primary-and-secondary-assets">Map threat communities against primary and secondary assets</h1>
<h3 id="example">Example</h3>
<p>In the light of a PTES assessment the internally hosted CRM application may be in scope. The customer information stored in the back-end database is an easily identifiable primary asset as it is directly linked to the application in scope. However, by reviewing the technical design of the database server, it can also be identified that the HR database stored on the same back-end database server is a secondary asset. An attacker can use the CRM application as a stepping stone to obtain employee information. In a basic threat modeling exercise, certain threat communities may be identified as not relevant when mapped to the CRM application, but by identifying the secondary assets the threat landscape suddenly changes.</p>
<h3 id="high-level-modeling-tools">High level modeling tools</h3>
<p>There are a variety of tools available to identify targets and map attack vectors.  These normally focus on the business assets (what systems to target) and business processes (how to attack them.)  Depending on the engagement, the penetration testing team may perform these exercises with no input from the customer; or they may spend a lot of time with customer stakeholders identifying targets of interest.  Tools with a business asset focus usually require a quantitative input to describe how important each potential target is to test.  The inputs may also be qualitative, such as a description by the customer’s CIO that a system is mission-critical.
Tools focused on business processes, information flows and technical architecture are used to identify potential attack vectors and choose which are mostly likely to succed or most likely to be used by a certain class of adversary.</p>
<h2 id="business-asset-analysis">Business Asset Analysis</h2>
<p>During the business asset analysis part of the threat modeling exercise an asset-centric view is taken on all assets, and business processes they support them, included in the scope. By analyzing the gathered documentation and interviewing relevant personnel within the organization, the pentester is able to identify the assets that are most likely to be targeted by an attacker, what their value is and what the impact of their (partial) loss would be.</p>
<h3 id="organizational-data">Organizational Data</h3>
<h4 id="policies-plans-and-procedures">Policies, Plans, and Procedures</h4>
<p>Internal policies, plans, and procedures define how the organization does business. These documents are of particular interest as they can help identify key roles within an organization and critical business processes that keep a company running.</p>
<h4 id="product-information-eg-trade-secrets-rd-data">Product Information (e.g. trade secrets, R&amp;D data)</h4>
<p>Product related information includes any patents, trade secrets, future plans, source code, supporting systems that directly affect the product market value, algorithms, and any other information that the organization regards as a key factor to the business success of such product.</p>
<h4 id="marketing-information-plans-roadmaps-etc">Marketing Information (plans, roadmaps, etc.)</h4>
<p>Marketing plans for promotions, launches, product changes, positioning, partnerships, 3<sup>rd</sup> party providers, business plans related to activities inside or outside the organization.
Additionally, PR related data such as details of partners, reporters, consulting firm, and any correspondence with such entities is also considered a highly sought after target.</p>
<h4 id="financial-information-eg-bank-credit-equity-accounts">Financial Information (e.g. bank, credit, equity accounts)</h4>
<p>Financial information is often some of the most guarded information an organization possesses. This information can include bank account information, credit card account information and/or credit card numbers, and investment accounts, among others.</p>
<h4 id="technical-information">Technical Information</h4>
<p>Technical information about the organization, and the organization’s operations, is of unique interest to the penetration tester. Such information is often not the expected deliverable of a penetration test, however, it facilitates the testing process by feeding valuable information to other areas; infrastructure design information may provide valuable data to the Intelligence Gathering process.
* Infrastructure Design Information
Infrastructure design related information pertains to all the core technologies and facilities used to run the organization. Building blueprints, technical wiring and connectivity diagrams, computing equipment/networking designs, and application level data processing are all considered infrastructure design information.
* System Configuration Information
System configuration information includes configuration baseline documentation, configuration checklists and hardening procedures, group policy information, operating system images, software inventories, etc. This information could aid the discovery of vulnerabilities (such as through the knowledge of configuration errors or outdated software installations).
* User Account Credentials
User account credentials help facilitate access to the information system, at a non-privileged level, as long as a means to authenticate exists (e.g. VPN, web portal, etc.).
* Privileged User Account Credentials
Privileged user account credentials help facilitate access to the information system, at an elevated level of access, as long as a means to authenticate exists (e.g. VPN, web portal, etc.). Obtaining privileged user account credentials often leads to compromise of the information system being tested.</p>
<h4 id="employee-data">Employee Data</h4>
<p>Here employee data is being analyzed as any data that can have a DIRECT affect on the organization is obtained or compromised by an attacker. Organizations that have to adhere to some compliance which places fines on the loss or exposure of such data are obvious candidates for such a direct loss effect. Also, organizations who’s employees may be considered critical assets may also be subjected to such scrutiny (specific government bodies, specialized trade secret related employees/departments, etc…).
The following list provides examples to information realms of personal data that may be considered business assets for the threat modeling.
* National Identification Numbers (SSNs, etc.)
* Personally Identifiable Information (PII)
* Protected Health Information (PHI)
* Financial Information (e.g. bank, credit accounts)</p>
<h4 id="customer-data">Customer Data</h4>
<p>Much like employee data, customer data is considered a business asset in the threat modeling process when such information will incur a direct/indirect loss to the organization. On top of regulatory/compliance need (based on fines), an additional factor comes into play here when such data can be used to conduct fraud, where the organization may be held liable or sued for the losses related to the fraud (based on losing the customer information that enabled the fraud to take place).
The following list provides examples of such information realms that may hold relevant customer data and should be considered business assets for the sake of the threat modeling
* National Identification Numbers (SSN’s, etc.)
* Personally Identifiable Information (PII)
* Protected Health Information (PHI)
* Financial Accounts (e.g. bank, credit, equity accounts)
* Supplier Data
Information related to suppliers that is considered critical to the organization (such as critical component manufacturers, agreements with suppliers that may be part of a trade secret, cost analysis of supplied components), as well as any data that may be used to affect the business operations of the organization through its suppliers is considered a business asset.
* Partner Data
* “Cloud” Service Account Information</p>
<h3 id="human-assets">Human Assets</h3>
<p>When identifying human assets in an organization, we have to remember that the context is having such assets part of a greater effort to compromise the organization. As such, human assets that are identified as business assets are those that could be leveraged to divulge information, manipulated to make decisions or actions that would adversely affect the organization or enable an attacker to further compromise it.
Human assets are not necessarily the highest up within the corporate hierarchy, but are more often key personnel that are related to previously identified business assets, or are in positions to enable access to such assets. This list can also include employees that normally would not be associated with access to restricted company assets, but may be in a position to grant physical access to a company that facilitates a breach of security or procedure.
The following list provides some examples of such assets, and should be adapted to the organization being tested.
* Executive Management
* Executive Assistants
* Middle Management
* Administrative Assistants
* Technical/Team Leads
* Engineers
* Technicians
* Human Resources</p>
<h2 id="business-process-analysis">Business Process Analysis</h2>
<p>A business isn't a business if it doesn't make money. The way this happens is by having either raw goods or knowledge run through various processes to enhance them and create added value. This generates revenue. Business processes and the assets (people, technology, money) supporting them form value chains. By mapping these processes, identifying the critical vs. non-critical processes and eventually finding flaws in them we are able to understand how the business works, what makes them money and eventually how specific threat communities can make them lose money.</p>
<p>In the business process analysis we differentiate between critical business processes, and non-critical processes. For each category the analysis is the same, and takes into account the same elements. The main difference is in the weighting that the threat from a critical business process is assigned with as opposed to a non-critical one.
Nevertheless, it's imperative to remember that an aggregation of a few non-critical business processes can be combined into a scenario that essentially forms a critical flaw within an element/process. Such threat scenarios should also be identified within this phase and mapped out for later use in the penetration test.</p>
<h3 id="technical-infrastructure-supporting-process">Technical infrastructure supporting process</h3>
<p>As business processes are usually supported by IT infrastructure (such as computer networks, processing power, PCs for entering information and managing the business process, etc...), all those elements must be identified and mapped. Such mapping should be clear enough to be used later on in the process when translating the threat model to the vulnerability mapping and exploitation.</p>
<h3 id="information-assets-supporting-process">Information assets supporting process</h3>
<p>Contrary to technical infrastructure, information assets are existing knowledge bases in the organization that are used as either a reference, or as support material (decision making, legal, marketing, etc...). Such assets are usually identified in the business process already, and should be mapped alongside the technical infrastructure, as well as any additional technical infrastructure that supports the information assets themselves.</p>
<h3 id="human-assets-supporting-process">Human assets supporting process</h3>
<p>Identification of the HR that are involved in the business process should be made in conjunction with the process analysis itself (whether documented or not), and every person that has any kind of involvement (even if it does not relate to a specific information asset or a technical infrastructure element) should be documented and mapped in the process. Such HR assets are usually part of an approval sub-process, a verification sub-process, or even a reference (such as legal advice). These kinds of assets (especially ones that have no relation to information assets or technical infrastructure) would be later mapped to attack vectors that are more social than technical in nature.</p>
<h3 id="3rd-party-integration-andor-usage-ofby-process">3<sup>rd</sup> party integration and/or usage of/by process</h3>
<p>Similar to human assets supporting the process, any 3<sup>rd</sup> party that has any involvement with the business process should be mapped as well. This category can be tricky to map out, as it could contain both human assets, as well as information/technical ones (such as a SaaS provider).</p>
<h2 id="threat-agentscommunity-analysis">Threat Agents/Community Analysis</h2>
<p>When defining the relevant threat communities and agents, a clear identification of the threat should be provided in terms of location (internal / external to the organization), the specific community within the location, and any additional relevant information that would assist in establishing a capabilities/motivation profile for the specific agent/community.
Where possible, specific agents should be identified. Otherwise, a more general community should be outlined, along-with any supporting material and intelligence.
Some examples of threat agent/community classifications are:
{| class#"wikitable"
|-
! Internal
! External
|-
| Employees
| Business Partners
|-
| Management (executive, middle)
| Competitors
|-
| Administrators (network, system, server)
| Contractors
|-
| Developers
| Suppliers
|-
| Engineers
| Nation States
|-
| Technicians
| Organized Crime
|-
| Contractors (with their external users)
| Hacktivists
|-
| General user community
| Script Kiddies (recreational/random hacking)
|-
| Remote Support
|
|}</p>
<h3 id="employees">Employees</h3>
<p>Persons working directly for the company under a part-time or full-time contract. In general they are not regarded as posing a severe threat as most of them are relying on the company
to make a living and, assuming they are treated well, are inclined to protect the company rather than to hurt it.  Oftentimes involved in data loss incidents or accidental compromise. In
rare cases they may be motivated by outsiders to assist in intrusions or they may engage in malicious acts on their own (e.g. rogue traders). While the skill level may vary, it is usually low
to medium.</p>
<h3 id="management-executive-middle">Management (Executive, middle)</h3>
<p>Employees working directly for the company as described above.  Given their position and function within the company they oftentimes have access to privileged information and may</p>
<h2 id="threat-capability-analysis">Threat Capability Analysis</h2>
<p>Once a threat community has been identified, the capabilities of said community must also be analyzed in order to build an accurate threat model that reflects the actual probability of such a community/agent to successfully act upon the organization and compromise it.
This analysis requires both a technical analysis as well as an opportunity analysis (where applicable).</p>
<h3 id="analysis-of-tools-in-use">Analysis of tools in use</h3>
<p>Any tools that are known to be available to the threat community/agent are to be included here. Additionally, tools that may be freely available should be analyzed for the required skill level needed to be able to utilize them to their potential, and mapped in the threat capability.</p>
<h3 id="availability-to-relevant-exploitspayloads">Availability to relevant exploits/payloads</h3>
<p>The threat community/agent should be analyzed in terms of its capability to either obtain or develop exploits for the environment relevant to the organization. Additionally, accessibility to such exploits/payloads through 3<sup>rd</sup> parties, business partners, or underground communities should also be to taken into account in this analysis.</p>
<h3 id="communication-mechanisms">Communication mechanisms</h3>
<p>An analysis of communication mechanisms available to the threat agent/community should be made to evaluate the complexity of attacks against an organization. These communication mechanisms range from simple and openly available technologies such as encryption, through to specialist tools and services such as bulletproof hosting, use of drop-sites, and the use of known or unknown botnets to perform attacks or mask source information.
For example, as part of testing we test to see what the overall attack surface for an organization is from the outside.  However, there is another whole component that is often times missed.  What types of threats can exist post exploitation?  This falls under the context of detecting exfiltration channels.  Coincidentally, penetration testers are uniquely situated to test an organizations capability to detect command and control channels of today's modern malware.
When this is in scope, we recommend the tester create a series of malware specimens that increase the level of obfuscation used to hide C2.   The goal is to create malware that is easily detected, then increase the obfuscation to the point where detection no longer occurs.</p>
<h3 id="accessibility">Accessibility</h3>
<p>The final element in the threat actor capability analysis is their accessibility to the organization and/or the specific assets in question. Completing the profile depicted above while factoring in accessibility analysis would enable the penetration test to create clear scenarios that are relevant to the organization’s risk.</p>
<h2 id="motivation-modeling">Motivation Modeling</h2>
<p>The possible motivation of threat agents/communities should be noted for further analysis. Motivations of attackers are constantly changing, as can be seen by the increase in hacktivism branded attacks by groups such as Anonymous and Antisec. There will be subtle differences in unique motivations based on each organization and/or vertical market, some common motivations include :
* Profit (direct or indirect)
* Hacktivism
* Direct grudge
* Fun / Reputation
* Further access to partner/connected systems</p>
<h2 id="finding-relevant-news-of-comparable-organizations-being-compromised">Finding relevant news of comparable Organizations being compromised</h2>
<p>In order to provide a complete threat model, a comparison to other organizations within the same industry vertical should be provided. This comparison should include any relevant incidents or news related to such organizations and the challenges they face. Such a comparison is used to validate the threat model and offer a baseline for the organization to compare itself to (taking into account that this publicly available information only represents a portion of the actual threats and incidents the compared organization actually face).</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2019 - 2020 darkcode0x00</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
